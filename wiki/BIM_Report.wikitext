<languages/>
<translate>

{{Docnav
|[[Arch_Schedule|Schedule]]
|[[BIM_Preflight|Preflight]]
|[[BIM_Workbench|BIM]]
|IconL=Arch_Schedule.svg
|IconR=BIM_Preflight.png
|IconC=Workbench_BIM.svg
}}

{{VeryImportantMessage|THIS COMMAND IS EXPERIMENTAL AND NOT PART OF FREECAD. It is a work in progress PR (https://github.com/FreeCAD/FreeCAD/pull/24078) that needs to be reviewed and tested. This is a placeholder to host documentation for testers.}}

{{GuiCommand
|Name=BIM Report
|MenuLocation=Manage â†’ Report
|Workbenches=[[BIM_Workbench|BIM]]
|SeeAlso=
}}

==Description==

The '''BIM Report''' is a tool for generating schedules and data reports from a FreeCAD model. It uses a SQL-like query language to select, filter, and aggregate data, offering a declarative alternative to other scheduling tools. Ultimately, it enables users to create and automatically populate a [[Spreadsheet_Workbench|spreadsheet]] with data gathered from the model.

You might choose the BIM Report tool when you need to perform:
* '''Complex Filtering:''' Select objects based on a combination of properties, including nested data (e.g., an object's placement coordinates).
* '''Data Aggregation:''' Calculate totals, counts, minimums, or maximums across many objects (e.g., find the total area of all "Space" objects).
* '''Hierarchical Queries:''' Select objects based on their relationship to other objects (e.g., find all windows hosted in walls on a specific floor).

==Usage==

# Open or create a FreeCAD document which contains some objects.
# Press the {{Button|[[Image:BIM_Report.svg|16px]] [[BIM_Report|Report]]}} button.
# The new Report will open its Task Panel automatically. Create one or more statements for the report. You can optionally use the provided statement editor to see a preview of executing those statements.
# Press {{Button|OK}} to save the report and refresh the associated spreadsheet with the query results.

=== User Interface ===

The BIM Report system consists of three main components: the '''Report''' Object in the Tree view, the Target '''Spreadsheet''' for the results, and the '''Task Panel''' where you configure the report.

When you create a new report, you will see two new objects in the '''Tree view''': the Report object, which stores all your settings, and its associated ReportResult spreadsheet.

Double-clicking the {{PropertyData|Report}} object opens the '''Task Panel''', which is the primary workspace for editing your report. The panel is divided into two main areas: the ''Report Statements Overview'' and the ''Statement Editor''.

[[File:BIM_Report_Task_Panel_Overview.png|thumb|The BIM Report Task Panel, showing the Statements Overview section at the top.]]

==== Report Statements Overview ====

This section is always visible at the top of the Task Panel and gives you a summary of all the queries (or "statements") that make up your report.

The main feature is a '''table''' listing each statement. From here, you can see and directly edit the '''Description''', and toggle key options for each query:
* '''Pipe:''' Enables pipeline mode for that statement, using the output of the previous one as its input.
* '''Header:''' Uses the statement's description as a merged section header in the spreadsheet.
* '''Cols:''' Includes the column names (e.g., {{incode|Label}}, {{incode|Area}}) as a header row for that statement's results.

Below the table are buttons to {{Button|[[Image:List-add.svg|16px]] Add}}, {{Button|[[Image:List-remove.svg|16px]] Remove}}, {{Button|[[Image:Edit-copy.svg|16px]] Duplicate}}, or {{Button|[[Image:Edit-edit.svg|16px]] Edit}} the selected statement.

Finally, the '''Report Templates''' dropdown menu allows you to load complete, pre-configured reports, such as a "Room and Area Schedule".

==== Statement Editor ====

This section appears at the bottom of the Task Panel when you select a statement and click {{Button|[[Image:Edit-edit.svg|16px]] Edit Selected}}. This is where you write and configure an individual SQL query.

[[File:BIM_Report_Statement_Editor.png|thumb|The Statement Editor, showing the SQL editor, preview pane, and display options.]]

* The '''SQL Query Editor''' is a text box with syntax highlighting. Autocompletion for SQL keywords and property names from your model is automatically enabled.
* Below the editor, a '''Live Validation''' status label gives you immediate feedback, indicating if your syntax is valid and showing a live count of matching objects.
* The {{Button|[[Image:Std_ToggleVisibility.svg|16px]] Show Preview}} button will run the current query on-demand and display the full data results in a temporary table, allowing you to test your query without closing the editor.
* The {{Button|[[Image:Help-browser.svg|16px]] Help}} button opens a dialog with a "cheatsheet" of all supported SQL clauses and functions.
* The '''Display Options''' group contains checkboxes for controlling the final formatting in the spreadsheet, such as adding an empty row after the results or printing them in bold.
* The '''Query Presets''' dropdown allows you to load and save individual, commonly used SQL queries.

==Workflow==

TBD

{{Docnav
|[[Arch_Schedule|Schedule]]
|[[BIM_Preflight|Preflight]]
|[[BIM_Workbench|BIM]]
|IconL=Arch_Schedule.svg
|IconR=BIM_Preflight.png
|IconC=Workbench_BIM.svg
}}

</translate>
{{BIM_Tools_navi{{#translation:}}}}
{{Userdocnavi{{#translation:}}}}