<languages/>

{{Docnav
|[[Draft_Label|Label]]
|[[Draft_Move|Move]]
|[[Draft_Workbench|Draft]]
|IconL=Draft_Label.svg 
|IconR=Draft_Move.svg 
|IconC=Workbench_Draft.svg
}}

{{GuiCommand
|Name=Draft AnnotationStyleEditor
|MenuLocation=Annotation → Annotation styles...<br>Manage → Annotation styles...
|Workbenches=[[Draft_Workbench|Draft]], [[BIM_Workbench|BIM]]
|SeeAlso=[[Draft_Text|Draft Text]], [[Draft_Label|Draft Label]], [[Draft_Dimension|Draft Dimension]]
|Version=0.19
}}

==Description==

The [[Image:Draft_AnnotationStyleEditor.svg|24px]] '''Draft AnnotationStyleEditor''' command allows you to define styles that affect the visual properties of annotation-like objects, such as those create by the [[Draft_Text|Draft Text]], [[Draft_Dimension|Draft Dimension]] and [[Draft_Label|Draft Label]] commands.

[[File:Draft_AnnotationStyleEditor_Dialog.png]]
{{Caption|The Annotation Styles Editor dialog box (version 1.1 layout)}}

== Usage ==

# There are several ways to invoke the command:
#* [[Draft_Workbench|Draft]]: Press the {{Button|[[Image:Draft_AnnotationStyleEditor.svg|16px]] [[Draft_AnnotationStyleEditor|Annotation styles...]]}} button.
#* Draft: Select the {{MenuCommand|Annotation → [[Image:Draft_AnnotationStyleEditor.svg|16px]] Annotation styles...}} option from the menu.
#* [[BIM_Workbench|BIM]]: Select the {{MenuCommand|Manage → [[Image:Draft_AnnotationStyleEditor.svg|16px]] Annotation styles...}} option from the menu.
# The {{MenuCommand|Annotation Styles Editor}} dialog box opens.
# Select a style from the {{MenuCommand|Style name}} dropdown list, or choose {{Value|Add new...}} to define a new style.
# Optionally adjust the properties of the style.
# Optionally press the {{Button|[[File:Accessories-text-editor.svg|16px]] Rename}} button to rename the style.
# Optionally press the {{Button|[[File:Edit_Cancel.svg|16px]] Delete}} button to delete the style.
# Optionally press the {{Button|[[File:Std_Import.svg|16px]]}} button to import all styles from a {{FileName|.json}} file. This will overwrite existing styles with the same name.
# Optionally press the {{Button|[[File:Std_Export.svg|16px]]}} button to export all styles to a {{FileName|.json}} file.
# Press the {{Button|OK}} button to close the dialog box and finish the command.

== Apply ==

To apply an annotation style change the {{PropertyView|Annotation Style}} property of annotation objects. This property can be found on the {{MenuCommand|View}} tab of the [[Property_editor|Property editor]].

[[File:Draft_AnnotationStyleEditor_Apply.png]]
{{Caption|Selecting an annotation style}}

== Scripting ==

See also: [https://freecad.github.io/SourceDoc/ Autogenerated API documentation] and [[FreeCAD Scripting Basics|FreeCAD Scripting Basics]].

The annotation styles are saved as serialized dictionaries in the {{incode|Meta}} attribute of the document. This attribute is inspected by the annotation style editor when it is opened.

{{Code|code=
>>> print(App.ActiveDocument.Meta["Draft_Style_Text red"])
{"ArrowSize": 2.0, "ArrowType": 0, "Decimals": 2, "DimOvershoot": 4.0, "ExtLines": 0.0, "ExtOvershoot": 4.0, "FontName": "DejaVu Sans", "FontSize": 10.0, "LineColor": 255, "LineSpacing": 1.0, "LineWidth": 2, "ScaleMultiplier": 1.0, "ShowLine": true, "ShowUnit": false, "TextColor": 4278190335, "TextSpacing": 3.0, "UnitOverride": ""}
}}

Each style that appears in the editor is internally saved with the style name prefixed by {{incode|Draft_Style_}}; this will prevent name clashes with other keys that may be saved in {{incode|Meta}}, which can hold arbitrary information.

You may define any new style by adding the necessary information to a key that starts with {{incode|Draft_Style_}}. The corresponding value of this key must be a dictionary serialized using {{incode|json}}.

{{Code|code=
import json

meta = App.ActiveDocument.Meta
props = {"ArrowSize": 7.0, "LineWidth": 6}
meta["Draft_Style_Thick_lines"] = json.dumps(props)
App.ActiveDocument.Meta = meta
}}

The properties not entered will be filled automatically when this style is selected in the style editor and the {{Button|OK}} button is pressed.

In a similar way, any serialized dictionary can be unpacked for edition.

{{Code|code=
import json

meta = App.ActiveDocument.Meta
new_dict = json.loads(meta["Draft_Style_Thick_lines"])
}}

The properties must have the following types:

Strings:

{{Code|code=
props = {
    "FontName": "DejaVu Sans",
    "UnitOverride": ""
}
}}

Floats (must be supplied with a decimal point):

{{Code|code=
props = {
    "ArrowSize": 2.0,
    "DimOvershoot": 4.0,
    "ExtLines": 0.0,
    "ExtOvershoot": 4.0
    "FontSize": 10.0,
    "LineSpacing": 1.0,
    "ScaleMultiplier": 1.0,
    "TextSpacing": 3.0
}
}}

Integers:

{{Code|code=
props = {
    "ArrowType": 0,
    "Decimals": 2,
    "LineColor": 255,
    "LineWidth": 2,
    "TextColor": 4278190335
}
}}

The {{Incode|TextColor}} and {{Incode|LineColor}} correspond to a 32-bit integer, from which the individual RGBA values can be extracted. The {{Incode|ArrowType}} is an enumerator.

Booleans:

{{Code|code=
props = {
    "ShowLine": true
    "ShowUnit": false,
}
}}


{{Docnav
|[[Draft_Label|Label]]
|[[Draft_Move|Move]]
|[[Draft_Workbench|Draft]]
|IconL=Draft_Label.svg 
|IconR=Draft_Move.svg 
|IconC=Workbench_Draft.svg
}}

{{Draft Tools navi{{#translation:}}}}
{{Userdocnavi{{#translation:}}}}