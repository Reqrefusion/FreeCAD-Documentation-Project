<languages/>

[[Image:FreecadRobustMCPBridge.svg|thumb|128px|Robust MCP Bridge Workbench icon]]

{{TOCright}}

==Description==

The '''Robust MCP Bridge Workbench''' is the server-side connection point that bridges to the [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server], which enables external applications to control FreeCAD through the [https://modelcontextprotocol.io/ Model Context Protocol (MCP)]. The workbench runs inside FreeCAD and exposes XML-RPC and JSON-RPC interfaces that external MCP clients can connect to.

This workbench is designed to work with the [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server] (available on PyPI), which allows AI assistants like [https://claude.ai Claude] to interact with FreeCAD through natural language. The full documentation and source code can be found at [https://github.com/spkane/freecad-robust-mcp-and-more github/spkane/freecad-robust-mcp-and-more], where you will find the MCP Server, Bridge and some FreeCAD Macros used for various things, not necessarily related to AI or the MCP work.

'''Key Features:'''
* Toolbar controls for starting/stopping the MCP bridge.
* Status indicator showing connection state (green=running, red=stopped).
* XML-RPC server on configurable port (default: 9875).
* JSON-RPC socket server on configurable port (default: 9876).
* Headless mode support for automation and CI/CD pipelines.
* Thread-safe queue system ensuring safe FreeCAD operations.
* Configurable auto-start on FreeCAD launch.

==Installation==

===Via Addon Manager (recommended)===

# Open FreeCAD
# Go to {{MenuCommand|Tools → Addon Manager}}
# Search for "Robust MCP Bridge"
# Click {{Button|Install}}
# Restart FreeCAD

===Manual installation===

Download the latest release from [https://github.com/spkane/freecad-robust-mcp-and-more/releases GitHub Releases] and extract to your FreeCAD Mod directory:

* '''Linux''': {{FileName|~/.local/share/FreeCAD/Mod/FreecadRobustMCPBridge/}}
* '''macOS''': {{FileName|~/Library/Application Support/FreeCAD/Mod/FreecadRobustMCPBridge/}}
* '''Windows''': {{FileName|%APPDATA%/FreeCAD/Mod/FreecadRobustMCPBridge/}}

==Usage==

===GUI mode===

[[Image:Addon_RobustMCPBridge_toolbar.png|Robust MCP Bridge workbench toolbar]]

# Switch to the '''Robust MCP Bridge''' workbench using the workbench selector
# Click {{Button|Start Bridge}} in the toolbar
# The status indicator turns green when running
# External MCP clients can now connect to localhost:9875 (XML-RPC) or localhost:9876 (Socket)

To stop the bridge, click {{Button|Stop Bridge}} in the toolbar.

[[Image:Addon_RobustMCPBridge_statusbar.png|Robust MCP Bridge workbench statusbar]]

===Headless mode===

For automation and CI/CD pipelines, the bridge can run without the GUI:

'''Linux:'''

{{Code|code=
freecadcmd ~/.local/share/FreeCAD/Mod/FreecadRobustMCPBridge/freecad_mcp_bridge/blocking_bridge.py
}}

'''macOS:'''

{{Code|code=
/Applications/FreeCAD.app/Contents/Resources/bin/freecadcmd \
    ~/Library/Application\ Support/FreeCAD/Mod/FreecadRobustMCPBridge/freecad_mcp_bridge/blocking_bridge.py
}}

The bridge will start and keep FreeCAD running until you press Ctrl+C.

==Configuration==

Access preferences via {{MenuCommand|Edit → Preferences → Robust MCP Bridge}} or {{MenuCommand|Robust MCP Bridge → MCP Bridge Preferences...}}

{| class="wikitable"
! Setting !! Description !! Default
|-
| Auto-start bridge || Start bridge automatically when FreeCAD launches || Disabled
|-
| Show status indicator || Display connection status in FreeCAD's status bar || Enabled
|-
| XML-RPC Port || Port for XML-RPC connections || 9875
|-
| Socket Port || Port for JSON-RPC socket connections || 9876
|}

[[Image:Addon RobustMCPBridge preferences.png|800px|Robust MCP Bridge workbench preference pane]]

==Features by mode==

{| class="wikitable"
! Feature !! GUI Mode !! Headless Mode
|-
| Object creation || Yes || Yes
|-
| Boolean operations || Yes || Yes
|-
| Export (STEP, STL, 3MF) || Yes || Yes
|-
| Macro execution || Yes || Yes
|-
| Document management || Yes || Yes
|-
| Screenshots || Yes || No
|-
| Object colors/visibility || Yes || No
|-
| Camera/view control || Yes || No
|}

==Connecting MCP clients==

This workbench provides the server that MCP clients connect to. To use with AI assistants like Claude, you need an MCP client such as the [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server]:

{{Code|code=
pip install freecad-robust-mcp
}}

Or using uv:

{{Code|code=
uv tool install freecad-robust-mcp
}}

See the [https://github.com/spkane/freecad-robust-mcp-and-more GitHub repository] for full documentation on configuring MCP clients.

==Troubleshooting==

===Bridge won't start===

# Check the FreeCAD Python console ({{MenuCommand|View → Panels → Python console}}) for error messages.
# Ensure no other process is using ports 9875/9876.
# Try restarting FreeCAD.

===Connection refused===

# Verify the bridge is running (green status indicator in toolbar).
# Check that ports match between the workbench preferences and your MCP client configuration.
# If connecting from Docker, use {{incode|host.docker.internal}} instead of {{incode|localhost}}.

===Headless mode won't start===

# Ensure you're using {{incode|freecadcmd}} (not {{incode|freecad}}).
# Verify the script path is correct for your installation.
# Test FreeCAD first: {{incode|freecadcmd -c "print('test')"}}.

==Links==

* [https://github.com/spkane/freecad-robust-mcp-and-more/releases Latest Release]
* [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server on PyPI] - The MCP Server that connects to this bridge.
* [https://spkane.github.io/freecad-robust-mcp-and-more/ Full Documentation] - Complete guides, API reference, and tutorials.
* [https://github.com/spkane/freecad-robust-mcp-and-more GitHub Repository] - Source code and issue tracker.
* [https://modelcontextprotocol.io/ Model Context Protocol] - The protocol specification.


[[Category:Addons{{#translation:}}]]
[[Category:External_Workbenches{{#translation:}}]]