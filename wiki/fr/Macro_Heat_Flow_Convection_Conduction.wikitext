<languages/>

{{Macro/fr
|Name=Macro Flux thermique Convection Conduction
|Description=Cette macro calcule le flux thermique dans une direction due à la convection et (ou) à la conduction, lorsque le phénomène est en état stationnaire. Elle calcule également les températures entre les couches des matériaux.
|Author=Garlic
|Download=[https://www.freecadweb.org/wiki/images/2/2c/Text-x-python.png Text-x-python.png]
|Links=[https://git.disroot.org/CrowdDiscussesAlternatives/ScriptsForFreeCAD/src/branch/master/Thermal/HeatFlowConvectionConduction_documentation.pdf Documentation sur le flux thermique, la convection et la conduction]
|Date=14/09/2025
|Version=0.0.2
|FCVersion=Toutes
}}

==Description==

Il s'agit d'un algorithme qui calcule le flux thermique dû à la conduction et/ou à la convection dans une seule direction (par exemple, un mur composé de plusieurs couches de matériaux tels que du plâtre, des briques et de l'isolant, ou une fenêtre à double vitrage avec une cavité remplie d'air, etc.). Le phénomène doit être en état stationnaire (c'est-à-dire non variable dans le temps).

Les données doivent être saisies dans un tableur dans [https://freecad.org FreeCAD] et les résultats sont écrits dans le même tableur, quelques lignes en dessous de la dernière ligne écrite. Ces données d'entrée doivent inclure (dans un ordre spécifique) les propriétés thermiques des matériaux des couches dans lesquelles le flux thermique se produit, l'épaisseur de chaque couche, la surface, la température du premier et du dernier point dans la direction du flux thermique, le type de phénomène dans chaque couche (par exemple [https://fr.wikipedia.org/wiki/Conduction_thermique conduction], ou [https://fr.wikipedia.org/wiki/Convection convection] forcée, ou convection libre sur une surface horizontale, verticale, inclinée ou dans une cavité fermée). Les résultats sont le débit thermique (en watts), la précision relative des calculs (l'algorithme utilise des équations de flux thermique et résout le problème par itérations, en essayant de converger) et les températures calculées des deux surfaces sur chaque couche.

==Installation==

Notez que vous ne devez effectuer les étapes suivantes qu'une seule fois :
# Dans le menu de FreeCAD, allez dans {{MenuCommand|Macro → Macros...}}.
# Recherchez le chemin d'accès indiqué dans le champ '''"Emplacement des macros de l'utilisateur :"'''
# Ouvrez ce dossier à l'aide de l'explorateur de fichiers (ou de toute autre application de gestion de fichiers).
# Téléchargez les fichiers '''HeatFlowConvectionConduction.py''', '''Thermal.py''' et '''SpreadsheetDataReadWrite.py''' depuis https://git.disroot.org/CrowdDiscussesAlternatives/ScriptsForFreeCAD/src/branch/master/Thermal et collez-les dans ce dossier.
# {{Button|Fermer}} la boîte de dialogue [[Std_DlgMacroExecute/fr|Exécuter la macro]].

[[How_to_install_macros/fr|Ici]], vous trouverez plus d'informations sur la manière d'installer manuellement des macros.

<span id="Usage"></span>
==Utilisation==

Les exemples suivants montrent comment utiliser ce script.

<span id="Example_1"></span>
=== Exemple 1===

Dans cet exemple, le débit thermique qui traverse une fenêtre à double vitrage est calculé. On sait que la température ambiante à l'intérieur de la pièce est de 25 °C et que la température ambiante à l'extérieur de la fenêtre est de 10 °C. La fenêtre mesure 0.57 m de haut et 0.43 m de large (soit une surface de 0.2451 m<sup>2</sup>). L'épaisseur de chaque vitre est de 4 mm (soit 0.004 m) et l'espace entre les deux vitres est de 16 mm.

Pour utiliser l'algorithme, ouvrez d'abord l'application FreeCAD. Ensuite, sélectionnez le [[Spreadsheet_Workbench/fr|atelier Spreadsheet]], créez un nouveau [[Image:Std_New.svg|16px]] [[Std_New/fr|document]] et, après cela, créez une nouvelle [[File:Spreadsheet_CreateSheet.svg|16px]] [[Spreadsheet_CreateSheet/fr|feuille de calcul]].

<span id="Input_data"></span>
===Données d'entrée===

L'algorithme recherche la première colonne du tableur afin de trouver le premier nombre. Lorsqu'il le trouve, il suppose qu'il s'agit de l'identifiant de la première couche. Il recherche ensuite l'identifiant de la deuxième couche. Si cinq lignes consécutives ne contiennent pas de nombre dans la première colonne, il suppose qu'il n'y a pas d'autres couches. Les lignes situées entre les données des couches peuvent être utilisées pour écrire les unités, les commentaires, etc. Les propriétés de chaque couche doivent être écrites dans un ordre spécifique.

Pour cet exemple, les données du tableur peuvent être écrites comme illustré dans l'image ci-dessous.

[[File:HeatFlowConvectionConduction_Macro_Example1_InputData.png]]

La ligne 4 contient les données de la couche dont l'identifiant est 1. Il s'agit de la couche dans laquelle se produit la convection entre l'air ambiant à l'extérieur de la fenêtre et la surface extérieure du vitrage extérieur de la fenêtre. '''Les unités des données sont exprimées en [https://fr.wikipedia.org/wiki/Syst%C3%A8me_international_d%27unit%C3%A9s S.I.]''' (système métrique).

Temp. 1 est la température ambiante extérieure, en kelvins (qui est connue : 10 °C + 273,15 = 283,15 K).

Temp. 2 est la température de la surface extérieure du verre extérieur et est estimée approximativement à 286,15 K. Il s'agit d'une valeur initiale permettant au solveur de démarrer la première itération. Cette température sera calculée et présentée dans les résultats. Afin d'estimer une valeur initiale, nous avons utilisé l'équation suivante : (25 - 10) / 5 = 3, où 25 °C est la température intérieure, 10 °C est la température extérieure et 5 est le nombre de couches. Nous avons donc ajouté 3 à 283,15 K.

0,2451 m<sup>2</sup> est la superficie de la fenêtre.

2 est le nombre qui spécifie la catégorie ''« convection libre sur une surface inclinée ou verticale »'' (en tant que mécanisme de transfert thermique dans cette couche).

101325 Pa correspond à la pression atmosphérique au niveau de la mer.

0,7 (70 % / 100) correspond à l'humidité relative de l'air ambiant extérieur.

0,57 m est la longueur caractéristique (pour une convection libre sur un plan vertical, la longueur caractéristique correspond à la hauteur du plan).

0 degré est l'angle entre le plan et la verticale.

'''Notez que pour que l'algorithme puisse comprendre les données, celles-ci doivent être écrites dans l'ordre ci-dessus''' (sans cellules vides entre elles), lorsque le mécanisme de transfert thermique est une convection libre sur un plan vertical.

La ligne 7 contient les données relatives à la couche sur laquelle la conduction se produit sur le verre extérieur de la fenêtre. 2 est l'identifiant de cette couche.

Temp. 1 est la température de la surface extérieure du verre extérieur et est estimée approximativement à 286,15 K (elle doit avoir la même valeur que la temp. 2 de la couche précédente, puisqu'elle se réfère à la même surface).

Temp. 2 est la température de la surface interne du verre extérieur (c'est-à-dire la surface en contact avec l'air emprisonné entre les deux verres) et est estimée approximativement à 289,15 K (la température précédente plus 3 K). Cette température sera calculée par le solveur.

0,2451 m<sup>2</sup> est la superficie de la fenêtre.

<div lang="en" dir="ltr" class="mw-content-ltr">
1 is the number that specifies the category of ''“conduction”'' (as a mechanism of heat transfer in this layer).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.96 W / (m &times; K) is the thermal conductivity of the glass [https://www.engineeringtoolbox.com/thermal-conductivity-d_429.html]. There are various tables on the internet that have the thermal properties of the most common materials. You can also use the [[Material Workbench]] to view the properties of a [[Std SetMaterial|material]].
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.004m is the thickness of the glass.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The above order is the one that the data must be written on the spreadsheet, when concerning conduction.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Row 10 has the data of the layer of the air that is trapped between the two glasses. 3 is the id of this layer.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
289.15K is the roughly estimated temperature of the inner surface of the outer glass.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
292.15K is the roughly estimated temperature of the opposite surface that encloses the air (i.e. the surface of the other glass that is in contact with the trapped air). This temperature will also be calculated by the solver.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.2451m<sup>2</sup> is the area of the window.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
4 is the number that specifies the category of ''“free convection in an enclosure”'' (as a mechanism of heat transfer in this layer). Please note that the set of equations in the algorithm (for this case) is only suitable for small gaps, similar to the gap in a double glazed window (i.e. less than 0.05m) [https://iopscience.iop.org/article/10.1088/1757-899X/939/1/012049/pdf].
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
101325Pa is the atmospheric pressure at sea level.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.2 (20% / 100) is the relative humidity of the enclosed air.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.016m is the characteristic length (for a free convection in an enclosure, the characteristic length is the thickness of the air gap, i.e. the distance between the two glasses).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Row 13 has the data of the layer with id 4, which concerns the conduction (category 1) that occurs at the second glass of the window.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Row 16 has the data of the layer with id 5, which concerns the free convection (category 2) that occurs at the surface of the second glass of the window that is in contact with the ambient air of the room. Note that the Temp. 2 of this layer is 298.15K which is 25°C (a given value in this example).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Please note that the used equations are valid for a range of values concerning the input data (the comments in the script [https://git.disroot.org/CrowdDiscussesAlternatives/ScriptsForFreeCAD/src/branch/master/Thermal/Thermal.py Thermal.py] specify these ranges). '''If these ranges are exceeded, then warnings (or errors) are printed in the [[Python Console]] of the FreeCAD.'''
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
====Executing the script====
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
In order for the algorithm to run, you need to open the [[Python Console]] on FreeCAD, and execute the code below (i.e. copy-paste each line of the code below separately and press each time {{Button|Enter}}).
</div>

{{Code|lang=python|code=
import HeatFlowConvectionConduction
heatFlowObj = HeatFlowConvectionConduction.HeatFlowConvectionConduction()
heatFlowObj.calcHeatFlowConvectionConduction()
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
Please note that once you open FreeCAD, you need to copy-paste the first two lines of this code only once (the first line imports the script and the second line creates an object). Then, every time you want to execute the algorithm of the script (in order to read the data of the spreadsheet, run the solver, and present the results), just copy-paste the third line of the code above and then press {{Button|Enter}}.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The results are written in the same spreadsheet, three rows below the last written row (please have in mind that the algorithm checks only if the first ten columns in seven subsequent rows are empty, and if true, it considers that it has found “the last written row”).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
====Results====
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
[[File:HeatFlowConvectionConduction Macro Example1 Results.png]]
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The heat flow rate is 2.62W. We firstly wrote the lower temperature, thus the minus symbol in the picture above indicates that the flow is in the opposite direction (i.e. from the higher temperature to the lower).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The relative accuracy is 0.76% (the solver of the algorithm terminates if the relative accuracy is less than 5%, or the number of iterations are more than ten - you can change these limits by altering their values in the {{incode|simulate_thermal_flow}} function inside the script).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The temperatures of each layer are calculated. The rest of the input data are also printed again for each layer, for clarity.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Example 2===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
A wind with speed 10m/sec, humidity 40%, and temperature 10°C flows in parallel with the width of a wall, which has 5m width &times; 3m height, and which its surface has a temperature of 11°C.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
In order to calculate the heat flow rate, we need to write the data on the spreadsheet, in the correct order.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
1 is the id of the layer.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
283.15K is the temperature of the air (the temperature of the wall could also have been written firstly).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
284.15K is the temperature of the surface of the wall.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
15m<sup>2</sup> is the area of the surface.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
5 specifies the category ''“forced convection parallel to a flat surface”''.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
101325Pa is the atmospheric pressure at sea level.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.4 is the relative humidity divided by 100.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
5m is the characteristic length (for forced convection, it is the dimension of the surface that is parallel to the flow).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
10m/sec is the speed of flow.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The results show that the heat flow rate is 367.18W.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Example 3===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The surface of a terrace has an area of 50m<sup>2</sup> (10m length &times; 5m width) and a temperature of 11°C. The outdoor ambient temperature is 10°C and the humidity is 50%.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
In order to calculate the heat flow rate, we need to enter these data in a correct order.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
1 is the id of the layer.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
283.15K is the temperature of the ambient air (i.e. the temperature of the fluid outside the [https://en.wikipedia.org/wiki/Thermal_boundary_layer_thickness_and_shape thermal boundary layer], in Kelvins).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
284.15K is the temperature of the surface of the terrace.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
50m<sup>2</sup> is the area of the surface.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
3 specifies the category ''“free convection on a horizontal surface”''.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
101325Pa is the atmospheric pressure at sea level.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.5 is the relative humidity divided by 100.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
1.67m is the characteristic length (for free convection on a horizontal surface it is the area of the surface divided by the perimeter: 50 / (10 + 5 + 10 + 5)). '''Please note that in order for the data to be read correctly, you should write in the cell of the spreadsheet 1.67 (and not = 50 / (10 + 5 + 10 + 5)).'''
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
1 is the direction of the surface. Since the air is on the top of the surface, this entry must be 1. If the air was at the bottom of the surface (e.g. in the case of a ceiling) then you should write -1.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
2 is the last written data in the row, and it specifies that temp. 1 is the temperature of the air and temp. 2 is the temperature of the surface. If you had written firstly the temperature of the surface and secondly the temperature of the air, then this last entry should be 1.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The results show that the heat flow rate is 92.55W
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Simulated cases of heat transfer===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The above examples cover the five cases (categories) that the algorithm in the script can calculate heat flow:
* Category 1: Conduction.
* Category 2: Free convection on an inclined or a vertical surface.
* Category 3: Free convection on a horizontal surface.
* Category 4: Free convection in an enclosure (for small gaps, similar to the gap in a double glazed window).
* Category 5: Forced convection parallel to a flat surface.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Scripts==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
You can download the files HeatFlowConvectionConduction.py, Thermal.py and
SpreadsheetDataReadWrite.py from:
</div>

https://git.disroot.org/CrowdDiscussesAlternatives/ScriptsForFreeCAD/src/branch/master/Thermal

<div lang="en" dir="ltr" class="mw-content-ltr">
==Links==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The forum discussion: [https://forum.freecad.org/viewtopic.php?t=99795 Presenting HeatFlowConvectionConduction macro]
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The documentation of this script in pdf format: [https://git.disroot.org/CrowdDiscussesAlternatives/ScriptsForFreeCAD/src/branch/master/Thermal/HeatFlowConvectionConduction_documentation.pdf Heat Flow Convection Conduction Documentation]
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==References==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# [https://www.engineeringtoolbox.com/thermal-conductivity-d_429.html Thermal Conductivity of Common Materials - Solids, Liquids and Gases]
# Heat transfer through a double-glazed window by convection, V А Маiоrоv. Citation V A Maiorov 2020 IOP Conf. Ser.: Mater. Sci. Eng. 939 012049, DOI 10.1088/1757-899X/939/1/012049. https://iopscience.iop.org/article/10.1088/1757-899X/939/1/012049/pdf
# Heat Transfer Handbook, by Adrian Bejan and Allan D. Kraus
</div>