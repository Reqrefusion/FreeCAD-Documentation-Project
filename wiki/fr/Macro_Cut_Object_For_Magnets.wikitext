<languages/>

{{Macro/fr
|Nom=Macro Cut Object for Magnets
|Nom/fr=Macro Cut Object for Magnets
|Icône=Macro_Cut_Object_For_Magnets.png
|Description=Découpe un objet suivant un plan et ajoute des trous alignés pour aimants avec détection de collision de surface. Crée deux pièces avec des trous parfaitement alignés pour y insérer des aimants qui permettent aux pièces de s'emboîter.
|Auteur=Sean P. Kane
|Version=0.6.1
|Date=2026-01-12
|FCVersion=0.19+
|Téléchargement=[https://wiki.freecad.org/images/thumb/e/e3/Macro_Cut_Object_For_Magnets.png/48px-Macro_Cut_Object_For_Magnets.png Icône de la barre d'outils]
|Voir aussi=[[Part_Slice/fr|Part Séparer en composés]], [[PartDesign_Hole/fr|PartDesign Perçage]]
}}

==Description==

Cette macro découpe un objet 3D selon un plan spécifié et ajoute automatiquement des trous magnétiques alignés aux deux pièces obtenues. Les trous sont positionnés à l'aide d'une détection de collision intelligente afin de garantir qu'ils ne traversent pas les parois extérieures de l'objet.

Cela est particulièrement utile pour :
* Créer des impressions en plusieurs parties qui s'assemblent à l'aide d'aimants intégrés.
* Diviser des objets volumineux pour les adapter à des plateaux d'imprimantes 3D plus petits tout en conservant leur alignement.
* Ajouter des mécanismes de fermeture magnétiques à des boîtiers et des étuis.

'''Principales fonctions :'''
* Découpe suivant des plans prédéfinis (XY, XZ, YZ) ou des plans de référence du modèle.
* Placement automatique des trous avec une répartition uniforme le long du bord de coupe.
* La détection des collisions de surface empêche les trous de traverser les parois.
* Diamètre, profondeur et nombre de trous configurables.
* Paramètres de dégagement préféré et minimum des bords.
* Repositionnement intelligent des trous lorsque le placement initial ne satisfait pas aux contrôles de sécurité.
* Crée des objets PartDesign::Body avec des fonctions de trou paramétriques.
* Prend en charge la recoupe d'objets déjà coupés (conserve les trous existants).
* Sépare automatiquement les deux parties pour faciliter la visualisation.

<span id="Usage"></span>
==Utilisation==

# Ouvrez un document contenant l'objet que vous souhaitez découper.
# Vous pouvez sélectionner l'objet et/ou un plan de référence avant d'exécuter la macro.
# Exécutez la macro à partir de '''Macro → Macros → CutObjectForMagnets → Lancer'''.
# Dans la boîte de dialogue :
#* Sélectionnez le corps à découper dans le menu déroulant.
#* Choisissez le type de plan de découpe (Préréglé ou Plan du modèle).
#* Pour les plans prédéfinis, définissez le décalage par rapport à l'origine.
#* Configurez les paramètres des trous pour aimants :
#** '''Diameter''' : diamètre du trou (doit correspondre à la taille de votre aimant).
#** '''Depth''' : profondeur du trou à partir de la surface de découpe.
#** '''Number of Holes''' : nombre total de trous à créer.
#** '''Edge Clearance (Preferred)''' : distance idéale entre l'arrête du trou et la surface de l'objet.
#** '''Edge Clearance (Minimum)''' : dégagement minimum acceptable.
# Cliquez sur « Execute Cut ».

[[File:MacroCutObjectForMagnetsDialog.png|400px|center]]

<span id="Example"></span>
==Exemple==

Cette image montre un vase dans sa forme originale, puis après avoir été découpé plusieurs fois à l'aide de la macro. Des aimants peuvent ensuite être insérés dans l'objet, qui peut alors être réassemblé. Cet exemple visait à créer un vase « cassable » pour une représentation théâtrale, mais il existe de nombreuses autres utilisations potentielles.

[[File:CutObjectForMagnetsExample.png|400px|center]]

<span id="How_It_Works"></span>
==Fonctionnement==

'''Processus de découpe :'''
# Crée une grande boîte demi-espace alignée avec le plan de découpe.
# Utilise des opérations booléennes pour diviser l'objet en deux parties.
# Crée des conteneurs PartDesign::Body pour chaque moitié.

'''Algorithme de placement des trous :'''
# Calcule les positions des trous répartis uniformément le long du périmètre de la face coupée.
# Pour chaque position, valide les DEUX pièces (et pas seulement une).
# Utilise d'abord le dégagement préféré, puis revient au minimum si nécessaire.
# Vérifie l'espacement entre les trous (minimum 2 fois le diamètre).
# Repositionne les trous qui ne satisfont pas aux contrôles de sécurité à l'aide de plusieurs stratégies :
#* Réduction du dégagement à la même position.
#* Augmentation de l'encastrement par rapport au bord.
#* Positions alternatives le long du périmètre.

'''Fonctions de sécurité :'''
* Crée des cylindres de test pour vérifier si les trous risquent de traverser les murs.
* Vérifie chaque trou par rapport aux parties supérieure et inférieure.
* Ignore les trous qui ne peuvent pas être placés en toute sécurité.
* Signale les trous repositionnés et ignorés dans la console.

<span id="Parameters"></span>
== Paramètres ==

{| class="wikitable"
! Paramètre !! Description !! Valeur par défaut
|-
| Plane Type || « Plan prédéfini » (XY/XZ/YZ) ou « Plan du modèle » (plan de référence) || Plan prédéfini
|-
| Offset || Distance par rapport à l'origine pour les plans prédéfinis || 0 mm
|-
| Diameter || Diamètre du trou pour l'aimant || 3 mm
|-
| Depth || Profondeur du trou par rapport à la surface de coupe || 3 mm
|-
| Number of Holes || Nombre total de trous à créer || 6
|-
| Edge Clearance (Preferred) || Distance idéale entre le bord du trou et la surface de l'objet || 2 mm
|-
| Edge Clearance (Minimum) || Dégagement minimum acceptable (utilisé lors du repositionnement) || 0.5 mm
|}

<span id="Requirements"></span>
== Conditions ==

* FreeCAD 0.19 ou version ultérieure.
* Un objet avec une forme solide (corps Part ou PartDesign).
* Pour le mode modèle réduit d'avion : un plan de référence ou un objet avec des faces planes.

==Installation==

# Téléchargez le fichier de la macro : [https://raw.githubusercontent.com/spkane/freecad-robust-mcp-and-more/refs/heads/main/macros/Cut_Object_for_Magnets/CutObjectForMagnets.FCMacro CutObjectForMagnets.FCMacro].
# Copiez le fichier dans votre répertoire des macros de FreeCAD :
#* '''macOS''' : {{FileName|~/Library/Application Support/FreeCAD/Macro/}}
#* '''Linux''' : {{FileName|~/.local/share/FreeCAD/Macro/}}
#* '''Windows''' : {{FileName|%APPDATA%/FreeCAD/Macro/}}
# Vous pouvez également télécharger l'icône de la barre d'outils et la placer dans le même répertoire.

<span id="Tips"></span>
== Astuces ==

* '''Magnet sizing''' : mesurez soigneusement vos aimants. Les dimensions courantes sont 3 mm, 5 mm et 6 mm de diamètre.
* '''Add tolerance''' : pensez à ajouter 0,1 à 0,2 mm au diamètre pour faciliter l'insertion des aimants.
* '''Depth planning''' : réglez la profondeur du trou légèrement plus profonde que la hauteur de l'aimant pour garantir un ajustement affleurant ou encastré.
* '''Edge clearance''' : pour les objets à parois minces, réduisez le dégagement souhaité, mais conservez un dégagement minimum suffisamment important pour éviter de percer la paroi.
* '''Re-cutting''' : la macro détecte les trous d'aimants existants et les préserve lors de la découpe de pièces déjà découpées.

<span id="Source_Code"></span>
== Code source ==

Le code source complet est hébergé sur GitHub :
* [https://github.com/spkane/freecad-robust-mcp-and-more/blob/main/macros/Cut_Object_for_Magnets/CutObjectForMagnets.FCMacro CutObjectForMagnets.FCMacro sur GitHub]

==Script==

Icône de la barre d'outils [[Image:Macro_Cut_Object_For_Magnets.png]]

'''Macro_Cut_Object_For_Magnets.FCMacro'''

{{CodeDownload|https://raw.githubusercontent.com/spkane/freecad-robust-mcp-and-more/refs/heads/main/macros/Cut_Object_for_Magnets/CutObjectForMagnets.FCMacro|CutObjectForMagnets.FCMacro}}

<div lang="en" dir="ltr" class="mw-content-ltr">
==Links==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
* [https://spkane.github.io/freecad-robust-mcp-and-more/ Full Documentation] - Complete guides and tutorials.
* [https://github.com/spkane/freecad-robust-mcp-and-more GitHub Repository] - Source code and issue tracker.
* [[Part_Slice|Part Slice]] - FreeCAD's built-in slice tool.
* [[PartDesign_Hole|PartDesign Hole]] - Parametric hole feature documentation.
* [[PartDesign_Body|PartDesign Body]] - Body container documentation.
</div>