<languages/>

{{Macro/fr
|Nom=Macro Cut Object for Magnets
|Nom/fr=Macro Cut Object for Magnets
|Icône=Macro_Cut_Object_For_Magnets.png
|Description=Découpe un objet suivant un plan et ajoute des trous alignés pour aimants avec détection de collision de surface. Crée deux pièces avec des trous parfaitement alignés pour y insérer des aimants qui permettent aux pièces de s'emboîter.
|Auteur=Sean P. Kane
|Version=0.6.1
|Date=2026-01-12
|FCVersion=0.19+
|Téléchargement=[https://wiki.freecad.org/images/thumb/e/e3/Macro_Cut_Object_For_Magnets.png/48px-Macro_Cut_Object_For_Magnets.png Icône de la barre d'outils]
|Voir aussi=[[Part_Slice/fr|Part Séparer en composés]], [[PartDesign_Hole/fr|PartDesign Perçage]]
}}

==Description==

<div lang="en" dir="ltr" class="mw-content-ltr">
This macro cuts a 3D object along a specified plane and automatically adds aligned magnet holes to both resulting pieces. The holes are positioned with intelligent collision detection to ensure they don't break through the outer walls of the object.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
This is particularly useful for:
* Creating multi-part prints that snap together with embedded magnets.
* Splitting large objects for smaller 3D printer beds while maintaining alignment.
* Adding magnetic closure mechanisms to enclosures and cases.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''Key Features:'''
* Cut along preset planes (XY, XZ, YZ) or model datum planes.
* Automatic hole placement with even distribution along the cut edge.
* Surface collision detection prevents holes from breaking through walls.
* Configurable hole diameter, depth, and count.
* Preferred and minimum edge clearance settings.
* Smart repositioning of holes when initial placement fails safety checks.
* Creates PartDesign::Body objects with parametric Hole features.
* Supports re-cutting already-cut objects (preserves existing holes).
* Automatically separates the two parts for easy viewing.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Usage==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Open a document with the object you want to cut.
# Optionally select the object and/or a datum plane before running the macro.
# Run the macro from '''Macro → Macros → CutObjectForMagnets → Execute'''.
# In the dialog:
#* Select the body to cut from the dropdown.
#* Choose the cut plane type (Preset or Model Plane).
#* For preset planes, set the offset from origin.
#* Configure magnet hole parameters:
#** '''Diameter''': Hole diameter (should match your magnet size).
#** '''Depth''': Hole depth from cut surface.
#** '''Number of Holes''': Total holes to create.
#** '''Edge Clearance (Preferred)''': Ideal distance from hole edge to object surface.
#** '''Edge Clearance (Minimum)''': Minimum acceptable clearance.
# Click "Execute Cut".
</div>

[[File:MacroCutObjectForMagnetsDialog.png|400px|center]]

<div lang="en" dir="ltr" class="mw-content-ltr">
==Example==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
This image shows a vase object in its original form, and after being cut multiple times with the macro. Magnets can then be inserted to object, and the object can be re-assembled. This example was to create a "breakable" vase for a theatrical stage performance, but there are many other potential uses as well.
</div>

[[File:CutObjectForMagnetsExample.png|400px|center]]

<div lang="en" dir="ltr" class="mw-content-ltr">
==How It Works==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''Cutting Process:'''
# Creates a large half-space box aligned with the cutting plane.
# Uses boolean operations to split the object into two parts.
# Creates PartDesign::Body containers for each half.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''Hole Placement Algorithm:'''
# Calculates hole positions evenly distributed along the cut face perimeter.
# For each position, validates against BOTH parts (not just one).
# Uses preferred clearance first, falls back to minimum if needed.
# Checks for hole-to-hole spacing (minimum 2x diameter).
# Repositions holes that fail safety checks using multiple strategies:
#* Reduced clearance at same position.
#* Increased inset from edge.
#* Alternative positions along the perimeter.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''Safety Features:'''
* Creates test cylinders to check if holes would break through walls.
* Validates each hole against both the top and bottom parts.
* Skips holes that cannot be safely placed.
* Reports repositioned and skipped holes in the console.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Parameters==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
{| class="wikitable"
! Parameter !! Description !! Default
|-
| Plane Type || "Preset Plane" (XY/XZ/YZ) or "Model Plane" (datum plane) || Preset Plane
|-
| Offset || Distance from origin for preset planes || 0 mm
|-
| Diameter || Magnet hole diameter || 3 mm
|-
| Depth || Hole depth from cut surface || 3 mm
|-
| Number of Holes || Total holes to create || 6
|-
| Edge Clearance (Preferred) || Ideal distance from hole edge to object surface || 2 mm
|-
| Edge Clearance (Minimum) || Minimum acceptable clearance (used during repositioning) || 0.5 mm
|}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Requirements==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
* FreeCAD 0.19 or later.
* An object with a solid shape (Part or PartDesign body).
* For model plane mode: a datum plane or object with planar faces.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Installation==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Download the macro file: [https://raw.githubusercontent.com/spkane/freecad-robust-mcp-and-more/refs/heads/main/macros/Cut_Object_for_Magnets/CutObjectForMagnets.FCMacro CutObjectForMagnets.FCMacro].
# Copy the file to your FreeCAD macro directory:
#* '''macOS''': {{FileName|~/Library/Application Support/FreeCAD/Macro/}}
#* '''Linux''': {{FileName|~/.local/share/FreeCAD/Macro/}}
#* '''Windows''': {{FileName|%APPDATA%/FreeCAD/Macro/}}
# Optionally, download the toolbar icon and place it in the same directory.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Tips==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
* '''Magnet sizing''': Measure your magnets carefully. Common sizes are 3mm, 5mm, and 6mm diameter.
* '''Add tolerance''': Consider adding 0.1-0.2mm to the diameter for easier magnet insertion.
* '''Depth planning''': Set hole depth slightly deeper than magnet height to ensure flush or recessed fit.
* '''Edge clearance''': For thin-walled objects, reduce the preferred clearance but keep minimum clearance high enough to prevent wall breakthrough.
* '''Re-cutting''': The macro detects existing magnet holes and preserves them when cutting already-cut parts.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Source Code==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The full source code is hosted on GitHub:
* [https://github.com/spkane/freecad-robust-mcp-and-more/blob/main/macros/Cut_Object_for_Magnets/CutObjectForMagnets.FCMacro CutObjectForMagnets.FCMacro on GitHub]
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Script==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
ToolBar Icon [[Image:Macro_Cut_Object_For_Magnets.png]]
</div>

'''Macro_Cut_Object_For_Magnets.FCMacro'''

{{CodeDownload|https://raw.githubusercontent.com/spkane/freecad-robust-mcp-and-more/refs/heads/main/macros/Cut_Object_for_Magnets/CutObjectForMagnets.FCMacro|CutObjectForMagnets.FCMacro}}

<div lang="en" dir="ltr" class="mw-content-ltr">
==Links==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
* [https://spkane.github.io/freecad-robust-mcp-and-more/ Full Documentation] - Complete guides and tutorials.
* [https://github.com/spkane/freecad-robust-mcp-and-more GitHub Repository] - Source code and issue tracker.
* [[Part_Slice|Part Slice]] - FreeCAD's built-in slice tool.
* [[PartDesign_Hole|PartDesign Hole]] - Parametric hole feature documentation.
* [[PartDesign_Body|PartDesign Body]] - Body container documentation.
</div>