<languages/>

{{TutorialInfo/fr
|Topic=Cables Create Custom Connector
|Topic/fr=Tutoriel Cables Créer un connecteur personnalisé
|Level=Intermédiaire
|Time=N/A
|Author=[[User:SargoDevel|SargoDevel]]
|FCVersion=1.0 ou au dessus
|SeeAlso=[[Cables_Workbench/fr|Atelier Cables]]
}}

== Introduction ==

L'outil [[Image:Cables_CableConnector.svg|24px]] [[Cables_CableConnector/fr|Cable Connecteur]] de l'[[Cables_Workbench/fr|atelier Cables]] dispose de plusieurs modèles de connecteurs prêts à l'emploi dans une bibliothèque intégrée. En plus de la bibliothèque, tout le monde peut créer des connecteurs personnalisés à partir des modèles [https://fr.wikipedia.org/wiki/Standard_pour_l%27%C3%A9change_de_donn%C3%A9es_de_produit STEP] existants proposés par les fabricants.

Le connecteur personnalisé doit être créé dans un dossier dédié à l'utilisateur. La bibliothèque intégrée de l'atelier Cables doit être considérée comme une référence en lecture seule. Tout fichier supplémentaire créé dans la bibliothèque intégrée sera supprimé lors des mises à jour ultérieures de l'atelier.

Ce tutoriel présente une méthode pour créer manuellement un connecteur personnalisé contenant des [[Cables_CableTerminal/fr|terminaisons]] et des [[Cables_SuppLines/fr|SuppLines]].

Le connecteur créé sera disponible dans la liste des '''Préréglages''' dans le panneau des tâches lors de la création [[Cables_CableConnector/fr#Utilisation|Cable Connecteur]]. Il n'est pas nécessaire de redémarrer FreeCAD.

REMARQUE : ce tutoriel décrit uniquement la création d'un type de connecteur appelé [[Cables_CableConnector/fr#Type_de_préréglage_fixé|Type de préréglage fixé]].

<span id="Preparing_folders"></span>
== Préparation des répertoires ==

Avant de créer le connecteur, il est nécessaire de préparer deux dossiers de bibliothèque personnalisés et certains fichiers.

Assurez-vous que les dossiers ci-dessous existent. Si ce n'est pas le cas, créez-les.

{{Code|lang=bash|code=
$FREECAD_USER_DIR/Cables/
$FREECAD_USER_DIR/Cables/lib/
}}

{{incode|$FREECAD_USER_DIR}} peut être obtenu à partir de la [[Python_console/fr|console Python]] :

{{Code|code=
FreeCAD.getUserAppDataDir()
}}

<span id="Preparing_files"></span>
== Préparation des fichiers ==

<div class="mw-collapsible mw-collapsed toccolours">

<span id="Main_presets_file"></span>
=== Fichier principal des préréglages ===

<div class="mw-collapsible-content">

Pour les objets [[Cables_CableConnector/fr|Cable Connector]], le '''fichier de préréglages principal''' est nommé {{FileName|connectorpresets.csv}}. Téléchargez le fichier [https://github.com/sargo-devel/Cables/blob/master/freecad/cables/resources/presets/connectorpresets.csv connectorpresets.csv] à partir du code source de l'atelier Câbles et placez-le dans le dossier {{Incode|$FREECAD_USER_DIR/Cables/}} créé à l'étape précédente.

Modifiez le fichier {{FileName|connectorpresets.csv}} à l'aide de votre éditeur de texte préféré. Je recommande l'éditeur [https://kate-editor.org Kate editor], qui intègre une fonctionnalité pratique de coloration des fichiers CSV modifiés.

Dans le fichier {{FileName|connectorpresets.csv}}, supprimez toutes les lignes qui NE COMMENCENT PAS par le signe « # » (les lignes vides peuvent être laissées telles quelles). Cela permet d'éviter les doublons avec les connecteurs qui existent déjà dans la bibliothèque intégrée.

IMPORTANT : le fichier {{FileName|connectorpresets.csv}} ne doit être créé qu'une seule fois. Ce fichier peut contenir les définitions de base de tous les connecteurs personnalisés. Chaque connecteur est défini par une seule ligne dans ce fichier. Si un nouveau connecteur est ajouté à l'avenir, il vous suffira d'ajouter une nouvelle ligne à ce fichier. D'autres fichiers sont nécessaires dans le sous-dossier « lib/ », mais cela sera expliqué dans les étapes suivantes.

</div> <!-- End of collapsible element for Main presets file section. Do not remove! -->
</div> <!-- End of collapsible element for Main presets file section. Do not remove! -->

<div class="mw-collapsible mw-collapsed toccolours">

<span id="STEP_file"></span>
===Fichier STEP===

<div class="mw-collapsible-content">

Le type de connecteur [[Cables_CableConnector/fr#Type_de_préréglage_fixé|Type de préréglage fixé]] n'est pas paramétrique et nécessite un modèle externe chargé à partir d'un fichier STEP à chaque fois qu'un nouveau connecteur est créé.

À titre d'exemple, le [https://www.traceparts.com/pl/product/molex-microfit-30-plug-housing-dual-row-2-circuits-ul-94v2-panel-mount-ears-glowwire-capable-black? CatalogPath=TRACEPARTS%3ATP10016001005006&Product=90-04042024-042829&PartNumber=430200210 Micro-Fit 3.0 Plug for 2 circuits with Panel Mount Ears] sera utilisé dans ce tutoriel. Téléchargez-le au format STEP AP242.

'''TRÈS IMPORTANT''': certains fichiers STEP risquent de ne pas se charger correctement dans le connecteur. Le fichier [[Cables_CableConnector/fr#Fichier_STEP|Cable Connecteur Fichier STEP]] explique comment résoudre ce problème.

Après le téléchargement, renommez le fichier {{FileName|Micro-Fit3_DualRow-PME-2.step}} (le nom peut être quelconque, mais il doit décrire le modèle de connecteur aussi précisément que possible). Placez le fichier dans le dossier {{Incode|$FREECAD_USER_DIR/Cables/lib/}}.

REMARQUE : le nom du connecteur ayant été défini, il doit être utilisé de manière cohérente dans toutes les étapes ci-dessous, en particulier dans les fichiers CSV. Par exemple, les champs '''Name''' et '''Connector Class''' du fichier {{FileName|connectorpresets.csv}} sont utilisés par le logiciel pour rechercher un nom de connecteur valide (si '''Name''' = ''DualRow-PME-2'', '''Connector Class''' = ''Micro-Fit3'' et le fichier de description CSV doit être nommé '''Connector Class'''_'''Name'''.csv, ce qui donne {{FileName|Micro-Fit3_DualRow-PME-2.csv}} pour cet exemple).

</div> <!-- End of collapsible element for STEP file section. Do not remove! -->
</div> <!-- End of collapsible element for STEP file section. Do not remove! -->

<div class="mw-collapsible mw-collapsed toccolours">

<span id="CSV_description_file_for_STEP_file"></span>
=== Fichier CSV de description pour fichier STEP ===

<div class="mw-collapsible-content">

Chaque modèle STEP utilisé pour construire un [[Cables_CableConnector/fr|connecteur de câble]] doit avoir son propre fichier de description CSV. Ce fichier contient des informations supplémentaires sur l'emplacement du modèle, les [[Cables_CableTerminal/fr|terminaisons de câble]] et les [[Cables_SuppLines/fr|SuppLines]] connectées au modèle. Dans ce tutoriel, le fichier de description CSV portera le nom {{FileName|Micro-Fit3_DualRow-PME-2.csv}}.

Téléchargez le fichier [https://github.com/sargo-devel/Cables/blob/master/freecad/cables/resources/presets/lib/Connector_Dummy.csv Connector_Dummy.csv] à partir du code source de l''''atelier Câbles''' et placez-le dans le dossier {{Incode|$FREECAD_USER_DIR/Cables/lib/}}. Renommez-le {{FileName|Micro-Fit3_DualRow-PME-2.csv}}.

Modifiez le fichier {{FileName|Micro-Fit3_DualRow-PME-2.csv}} à l'aide d'un éditeur de texte. Dans le fichier {{FileName|Micro-Fit3_DualRow-PME-2.csv}}, supprimez toutes les lignes qui NE COMMENCENT PAS par le signe « # » (les lignes vides peuvent être laissées telles quelles). Les nouvelles lignes nécessaires seront créées dans les étapes suivantes.

</div> <!-- End of collapsible element for CSV description... section. Do not remove! -->
</div> <!-- End of collapsible element for CSV description... section. Do not remove! -->

<div class="mw-collapsible mw-collapsed toccolours">

<span id="Filling_files_with_basic_data"></span>
== Remplir les fichiers avec des données de base ==

<div class="mw-collapsible-content">

Modifiez à nouveau le fichier {{FileName|connectorpresets.csv}}. Créez une nouvelle ligne sous les lignes suivantes :

{{Code|lang=bash|code=
# Fixed Preset Type
# Name,Fixed,Connector Class,StepFileName,NrOfTerminals,NrOfSuppLines
}}

et ajoutez un texte comme celui ci-dessous :

{{Code|lang=text|code=
DualRow-PME-2,Fixed,Micro-Fit3,Micro-Fit3_DualRow-PME-2.step,2,1
}}

Il contient les informations indiquant que ce connecteur aura 2 [[Cables_CableTerminal/fr|terminaisons]]s et 1 croix [[Cables_SuppLines/fr|SuppLines]]. Pour en savoir plus sur les règles relatives à cette ligne, consultez [[Cables_CableConnector/fr#Plus_de_détails_sur_le_type_de_préréglage_fixé_dans_le_fichier_connectorpresets.csv|Cable Connecteur Plus de détails sur le type de préréglage fixé dans le fichier connectorpresets.csv]].

Modifiez ensuite le fichier {{FileName|Micro-Fit3_DualRow-PME-2.csv}}. Créez une nouvelle ligne sous les lignes suivantes :

{{Code|lang=bash|code=
# Connector Element Type
# Name,ExtShape,Class,Offset X,Offset Y,Offset Z,Rotation Yaw(Z),Rotation Pitch(Y), Rotation Roll(X)
}}

et ajoutez le texte :

{{Code|lang=text|code=
DualRow-PME-2,ExtShape,Micro-Fit3,0.0,0.0,0.0,0.0,0.0,0.0
}}

puis sous les lignes :

{{Code|lang=bash|code=
# Terminal Element Type
# Name,Terminal,Class,Offset X,Offset Y,Offset Z,Rotation Yaw(Z),Rotation Pitch(Y), Rotation Roll(X),NrOfConnections,Length,Spacing
}}

ajoutez 2 lignes :

{{Code|lang=text|code=
Pin001,Terminal,Terminal,-10.0,0.0,0.0,0.0,0.0,0.0,1,10.0,1.0
Pin002,Terminal,Terminal,10.0,0.0,0.0,0.0,0.0,0.0,1,10.0,1.0
}}

et enfin sous les lignes :

{{Code|lang=bash|code=
# SupportLines Element Type
# Name,SupportLines,Class,Offset X,Offset Y,Offset Z,Rotation Yaw(Z),Rotation Pitch(Y), Rotation Roll(X)
}}

ajoutez 1 ligne :

{{Code|lang=text|code=
SuppLines001,SupportLines,SupportLines,0,0,30.0,0,0,0
}}

Les lignes ajoutées ci-dessus définissent les positions de départ du corps du connecteur, des 2 bornes et de la croix supplines. Les étapes suivantes permettront de déterminer les positions finales de tous les éléments.

</div> <!-- End of collapsible element for Filling files... section. Do not remove! -->
</div> <!-- End of collapsible element for Filling files... section. Do not remove! -->

<span id="Adjusting_element_positions"></span>
== Réglage de la position des éléments ==

Si les étapes précédentes ont été correctement effectuées, il devrait maintenant être possible de créer le connecteur à partir du préréglage '''Micro-Fit3_DualRow-PME-2'''. Créez un nouveau document dans FreeCAD et créez le connecteur conformément à [[Cables_CableConnector/fr#tilisation|Cable Connecteur Utilisation]]. Sélectionnez le préréglage '''Micro-Fit3_DualRow-PME-2''' dans le panneau des tâches et confirmez avec {{Button|OK}}. Le résultat devrait ressembler à l'image ci-dessous.

[[File:Cables_Creating_Own_Connector_Img1.png]]

{{Caption|Connecteur '''Micro-Fit3_DualRow-PME-2''' avec les données de placement par défaut}}

Dans les étapes suivantes, les emplacements du corps du connecteur, des terminaisons de câble et des SuppLines seront ajustés.
<div class="mw-collapsible mw-collapsed toccolours">

<span id="Adjusting_position_of_connector_body"></span>
=== Réglage de la position du corps du connecteur ===

<div class="mw-collapsible-content">

Le placement de la forme STEP importée peut être différent de celui attendu. Supposons dans cet exemple que la fiche doit être placée verticalement, avec les câbles sortant vers le haut, et que le bas doit toucher le point (0,0,0).

Oublions un instant les CableTerminals et les SuppLines, sélectionnons le connecteur dans l'[[Tree_View/fr|arborescence]] et déplaçons-le et faisons-le pivoter à l'aide de l'outil [[Std_TransformManip/fr|Std Transformer]].

Son emplacement peut désormais être vérifié dans l'[[Property_View/fr|éditeur de propriétés]] ou dans la [[Python_Console/fr|console Python]]. Les détails sur la manière de procéder sont présentés dans [[Placement/fr|Placement]]. Choisissez l'affichage de l'angle de lacet, de tangage et de roulis dans le panneau de tâches Placement. Cela permettra de mieux présenter les résultats de rotation. Les valeurs précises peuvent être saisies manuellement.

Le résultat du placement devrait être le suivant : {{Incode|Placement [Pos{{:=}}(0,0,8.445), Yaw-Pitch-Roll{{:=}}(0,0,-90)]}}

Modifiez à nouveau le fichier {{FileName|Micro-Fit3_DualRow-PME-2.csv}} et modifiez la ligne :

{{Code|lang=text|code=
DualRow-PME-2,ExtShape,Micro-Fit3,0.0,0.0,0.0,0.0,0.0,0.0
}}

en :

{{Code|lang=text|code=
DualRow-PME-2,ExtShape,Micro-Fit3,0.0,0.0,8.445,0.0,0.0,-90.0
}}

et enregistrez le fichier {{FileName|Micro-Fit3_DualRow-PME-2.csv}}.

Supprimez tous les objets du document FreeCAD actuel et recréez le connecteur en choisissant le préréglage '''Micro-Fit3_DualRow-PME-2'''. Son emplacement actuel devrait correspondre à celui qui vient d'être défini. Notez que l'emplacement du connecteur affiché dans l'[[Property_View/fr|éditeur de propriétés]] ou dans la [[Python_Console/fr|console Python]] est désormais {{Incode|Placement [Pos{{:=}}(0,0,0), Yaw-Pitch-Roll{{:=}}(0,0,0)]}}. Ceci est correct car le placement de la forme du connecteur a été défini lors de sa création sur la base des données du fichier {{FileName|Micro-Fit3_DualRow-PME-2.csv}}.

Le résultat final devrait ressembler à l'image ci-dessous.

[[File:Cables_Creating_Own_Connector_Img2.png]]

{{Caption|Connecteur '''Micro-Fit3_DualRow-PME-2''' placé verticalement.}}
</div> <!-- End of collapsible element for Adjusting position of connector body section. Do not remove! -->
</div> <!-- End of collapsible element for Adjusting position of connector body. section. Do not remove! -->
<div class="mw-collapsible mw-collapsed toccolours">

<span id="Adjusting_position_of_CableTerminals"></span>
=== Réglage de la position des terminaisons de câbles ===

<div class="mw-collapsible-content">

Développez '''CableConnector''' dans l'[[Tree_View/fr|arborescence]]. Il devrait contenir deux sous-objets terminaux : '''CableConnector_Term001''' et '''CableConnector_Term002'''. Les deux doivent être ajustés pour s'adapter au connecteur.

Effacez la valeur de la propriété '''Attachment Support''' des deux terminaisons dans l'[[Property_View/fr|éditeur de propriétés]]. Cela est nécessaire pour permettre le déplacement des terminaisons.

Sélectionnez la première borne dans l'[[Tree_View/fr|arborescence]] et modifiez sa '''longueur''' à 6 mm dans l'[[Property_View/fr|éditeur de propriétés]]. À l'aide de l'outil [[Std_TransformManip/fr|Std Transformer]], placez-la verticalement à l'intérieur du connecteur en vous assurant que Vertex1 de la terminaison est orienté vers le haut (ceci est important pour la fixation ultérieure du câble). Le numéro du sommet s'affiche dans la ligne d'état inférieure de FreeCAD lorsque vous passez le curseur sur le sommet dans la [[3D_View/fr|vue 3D]]. Répétez toutes ces étapes pour la deuxième terminaison.

En utilisant les mêmes méthodes que dans l'étape précédente, vérifiez si l'emplacement des bornes correspond aux valeurs indiquées ci-dessous :

'''CableConnector_Term001''': {{Incode|Placement [Pos{{:=}}(0,1.5,12.0), Yaw-Pitch-Roll{{:=}}(0,0,90)]}}

'''CableConnector_Term001''': {{Incode|Placement [Pos{{:=}}(0,-1.5,12.0), Yaw-Pitch-Roll{{:=}}(0,0,90)]}}

Retapez ces valeurs dans le fichier {{FileName|Micro-Fit3_DualRow-PME-2.csv}} en remplaçant les lignes :

{{Code|lang=text|code=
Pin001,Terminal,Terminal,-10.0,0.0,0.0,0.0,0.0,0.0,1,10.0,1.0
Pin002,Terminal,Terminal,10.0,0.0,0.0,0.0,0.0,0.0,1,10.0,1.0
}}

avec ces lignes :

{{Code|lang=text|code=
Pin001,Terminal,Terminal,0.0,1.5,12.0,0.0,0.0,90.0,1,6.0,1.0
Pin002,Terminal,Terminal,0.0,-1.5,12.0,0.0,0.0,90.0,1,6.0,1.0
}}

Supprimez tous les objets du document FreeCAD actuel et recréez le connecteur en choisissant le préréglage '''Micro-Fit3_DualRow-PME-2'''. Son emplacement actuel doit correspondre à celui qui vient d'être défini et doit être similaire à l'image ci-dessous.

[[File:Cables_Creating_Own_Connector_Img3.png]]

{{Caption|Connecteur '''Micro-Fit3_DualRow-PME-2''' avec des terminaisons correctement alignées. Il est transparent pour une meilleure visibilité des terminaisons.}}

</div> <!-- End of collapsible element for Adjusting position of CableTerminals section. Do not remove! -->
</div> <!-- End of collapsible element for Adjusting position of CableTerminals section. Do not remove! -->

<div class="mw-collapsible mw-collapsed toccolours">

<span id="Adjusting_position_of_SuppLines"></span>
=== Réglage de la position des SuppLines ===

<div class="mw-collapsible-content">

L'unique objet SuppLines ('''CableConnector_SuppLines001'''dans cet exemple) a la forme d'une croix avec une taille prédéfinie fixe. Cet objet peut être utilisé comme point de fixation pour un câble relié au connecteur. C'est à l'utilisateur de décider de l'utiliser ou non.

Le placement par défaut de la croix SuppLines dans ce tutoriel est trop haut. Modifions son placement à l'aide des méthodes décrites dans les étapes précédentes.

Le placement final des SuppLines peut ressembler à ceci :<br/>
'''CableConnector_SuppLines001''': {{Incode|Placement [Pos{{:=}}(0,0,25), Yaw-Pitch-Roll{{:=}}(0,0,0)]}}

Retapez ces valeurs dans le fichier {{FileName|Micro-Fit3_DualRow-PME-2.csv}} en remplaçant les lignes :

{{Code|lang=text|code=
SuppLines001,SupportLines,SupportLines,0,0,30.0,0,0,0
}}

avec ces lignes :

{{Code|lang=text|code=
SuppLines001,SupportLines,SupportLines,0,0,25.0,0,0,0
}}

Supprimez à nouveau tous les objets du document FreeCAD actuel et créez le connecteur en choisissant le préréglage '''Micro-Fit3_DualRow-PME-2'''. Le résultat devrait présenter tous les ajustements finaux des objets créés.

La définition du préréglage du connecteur '''Micro-Fit3_DualRow-PME-2''' est désormais prête à être utilisée dans les projets.

</div> <!-- End of collapsible element for Adjusting position of SuppLines section. Do not remove! -->
</div> <!-- End of collapsible element for Adjusting position of SuppLines section. Do not remove! -->

{{Userdocnavi{{#translation:}}}}