<languages/>

{{TutorialInfo/fr
|Topic=Cables Create Custom Connector
|Topic/fr=Tutoriel Cables Créer un connecteur personnalisé
|Level=Intermédiaire
|Time=N/A
|Author=[[User:SargoDevel|SargoDevel]]
|FCVersion=1.0 ou au dessus
|SeeAlso=[[Cables_Workbench/fr|Atelier Cables]]
}}

== Introduction ==

L'outil [[Image:Cables_CableConnector.svg|24px]] [[Cables_CableConnector/fr|Cable Connecteur]] de l'[[Cables_Workbench/fr|atelier Cables]] dispose de plusieurs modèles de connecteurs prêts à l'emploi dans une bibliothèque intégrée. En plus de la bibliothèque, tout le monde peut créer des connecteurs personnalisés à partir des modèles [https://fr.wikipedia.org/wiki/Standard_pour_l%27%C3%A9change_de_donn%C3%A9es_de_produit STEP] existants proposés par les fabricants.

Le connecteur personnalisé doit être créé dans un dossier dédié à l'utilisateur. La bibliothèque intégrée de l'atelier Cables doit être considérée comme une référence en lecture seule. Tout fichier supplémentaire créé dans la bibliothèque intégrée sera supprimé lors des mises à jour ultérieures de l'atelier.

Ce tutoriel présente une méthode pour créer manuellement un connecteur personnalisé contenant des [[Cables_CableTerminal/fr|terminaisons]] et des [[Cables_SuppLines/fr|SuppLines]].

Le connecteur créé sera disponible dans la liste des '''Préréglages''' dans le panneau des tâches lors de la création [[Cables_CableConnector/fr#Utilisation|Cable Connecteur]]. Il n'est pas nécessaire de redémarrer FreeCAD.

REMARQUE : ce tutoriel décrit uniquement la création d'un type de connecteur appelé [[Cables_CableConnector/fr#Type_de_préréglage_fixé|Type de préréglage fixé]].

<span id="Preparing_folders"></span>
== Préparation des répertoires ==

Avant de créer le connecteur, il est nécessaire de préparer deux dossiers de bibliothèque personnalisés et certains fichiers.

Assurez-vous que les dossiers ci-dessous existent. Si ce n'est pas le cas, créez-les.

{{Code|lang=bash|code=
$FREECAD_USER_DIR/Cables/
$FREECAD_USER_DIR/Cables/lib/
}}

{{incode|$FREECAD_USER_DIR}} peut être obtenu à partir de la [[Python_console/fr|console Python]] :

{{Code|code=
FreeCAD.getUserAppDataDir()
}}

<span id="Preparing_files"></span>
== Préparation des fichiers ==

<div class="mw-collapsible mw-collapsed toccolours">

<span id="Main_presets_file"></span>
=== Fichier principal des préréglages ===

<div class="mw-collapsible-content">

Pour les objets [[Cables_CableConnector/fr|Cable Connector]], le '''fichier de préréglages principal''' est nommé {{FileName|connectorpresets.csv}}. Téléchargez le fichier [https://github.com/sargo-devel/Cables/blob/master/freecad/cables/resources/presets/connectorpresets.csv connectorpresets.csv] à partir du code source de l'atelier Câbles et placez-le dans le dossier {{Incode|$FREECAD_USER_DIR/Cables/}} créé à l'étape précédente.

Modifiez le fichier {{FileName|connectorpresets.csv}} à l'aide de votre éditeur de texte préféré. Je recommande l'éditeur [https://kate-editor.org Kate editor], qui intègre une fonctionnalité pratique de coloration des fichiers CSV modifiés.

Dans le fichier {{FileName|connectorpresets.csv}}, supprimez toutes les lignes qui NE COMMENCENT PAS par le signe « # » (les lignes vides peuvent être laissées telles quelles). Cela permet d'éviter les doublons avec les connecteurs qui existent déjà dans la bibliothèque intégrée.

IMPORTANT : le fichier {{FileName|connectorpresets.csv}} ne doit être créé qu'une seule fois. Ce fichier peut contenir les définitions de base de tous les connecteurs personnalisés. Chaque connecteur est défini par une seule ligne dans ce fichier. Si un nouveau connecteur est ajouté à l'avenir, il vous suffira d'ajouter une nouvelle ligne à ce fichier. D'autres fichiers sont nécessaires dans le sous-dossier « lib/ », mais cela sera expliqué dans les étapes suivantes.

</div> <!-- End of collapsible element for Main presets file section. Do not remove! -->
</div> <!-- End of collapsible element for Main presets file section. Do not remove! -->

<div class="mw-collapsible mw-collapsed toccolours">

<span id="STEP_file"></span>
===Fichier STEP===

<div class="mw-collapsible-content">

Le type de connecteur [[Cables_CableConnector/fr#Type_de_préréglage_fixé|Type de préréglage fixé]] n'est pas paramétrique et nécessite un modèle externe chargé à partir d'un fichier STEP à chaque fois qu'un nouveau connecteur est créé.

À titre d'exemple, le [https://www.traceparts.com/pl/product/molex-microfit-30-plug-housing-dual-row-2-circuits-ul-94v2-panel-mount-ears-glowwire-capable-black? CatalogPath=TRACEPARTS%3ATP10016001005006&Product=90-04042024-042829&PartNumber=430200210 Micro-Fit 3.0 Plug for 2 circuits with Panel Mount Ears] sera utilisé dans ce tutoriel. Téléchargez-le au format STEP AP242.

'''TRÈS IMPORTANT''': certains fichiers STEP risquent de ne pas se charger correctement dans le connecteur. Le fichier [[Cables_CableConnector/fr#Fichier_STEP|Cable Connecteur Fichier STEP]] explique comment résoudre ce problème.

Après le téléchargement, renommez le fichier {{FileName|Micro-Fit3_DualRow-PME-2.step}} (le nom peut être quelconque, mais il doit décrire le modèle de connecteur aussi précisément que possible). Placez le fichier dans le dossier {{Incode|$FREECAD_USER_DIR/Cables/lib/}}.

REMARQUE : le nom du connecteur ayant été défini, il doit être utilisé de manière cohérente dans toutes les étapes ci-dessous, en particulier dans les fichiers CSV. Par exemple, les champs '''Name''' et '''Connector Class''' du fichier {{FileName|connectorpresets.csv}} sont utilisés par le logiciel pour rechercher un nom de connecteur valide (si '''Name''' = ''DualRow-PME-2'', '''Connector Class''' = ''Micro-Fit3'' et le fichier de description CSV doit être nommé '''Connector Class'''_'''Name'''.csv, ce qui donne {{FileName|Micro-Fit3_DualRow-PME-2.csv}} pour cet exemple).

</div> <!-- End of collapsible element for STEP file section. Do not remove! -->
</div> <!-- End of collapsible element for STEP file section. Do not remove! -->

<div class="mw-collapsible mw-collapsed toccolours">

<span id="CSV_description_file_for_STEP_file"></span>
=== Fichier CSV de description pour fichier STEP ===

<div class="mw-collapsible-content">

Chaque modèle STEP utilisé pour construire un [[Cables_CableConnector/fr|connecteur de câble]] doit avoir son propre fichier de description CSV. Ce fichier contient des informations supplémentaires sur l'emplacement du modèle, les [[Cables_CableTerminal/fr|terminaisons de câble]] et les [[Cables_SuppLines/fr|SuppLines]] connectées au modèle. Dans ce tutoriel, le fichier de description CSV portera le nom {{FileName|Micro-Fit3_DualRow-PME-2.csv}}.

Téléchargez le fichier [https://github.com/sargo-devel/Cables/blob/master/freecad/cables/resources/presets/lib/Connector_Dummy.csv Connector_Dummy.csv] à partir du code source de l''''atelier Câbles''' et placez-le dans le dossier {{Incode|$FREECAD_USER_DIR/Cables/lib/}}. Renommez-le {{FileName|Micro-Fit3_DualRow-PME-2.csv}}.

Modifiez le fichier {{FileName|Micro-Fit3_DualRow-PME-2.csv}} à l'aide d'un éditeur de texte. Dans le fichier {{FileName|Micro-Fit3_DualRow-PME-2.csv}}, supprimez toutes les lignes qui NE COMMENCENT PAS par le signe « # » (les lignes vides peuvent être laissées telles quelles). Les nouvelles lignes nécessaires seront créées dans les étapes suivantes.

</div> <!-- End of collapsible element for CSV description... section. Do not remove! -->
</div> <!-- End of collapsible element for CSV description... section. Do not remove! -->

<div class="mw-collapsible mw-collapsed toccolours">

<span id="Filling_files_with_basic_data"></span>
== Remplir les fichiers avec des données de base ==

<div class="mw-collapsible-content">

Modifiez à nouveau le fichier {{FileName|connectorpresets.csv}}. Créez une nouvelle ligne sous les lignes suivantes :

{{Code|lang=bash|code=
# Fixed Preset Type
# Name,Fixed,Connector Class,StepFileName,NrOfTerminals,NrOfSuppLines
}}

et ajoutez un texte comme celui ci-dessous :

{{Code|lang=text|code=
DualRow-PME-2,Fixed,Micro-Fit3,Micro-Fit3_DualRow-PME-2.step,2,1
}}

Il contient les informations indiquant que ce connecteur aura 2 [[Cables_CableTerminal/fr|terminaisons]]s et 1 croix [[Cables_SuppLines/fr|SuppLines]]. Pour en savoir plus sur les règles relatives à cette ligne, consultez [[Cables_CableConnector/fr#Plus_de_détails_sur_le_type_de_préréglage_fixé_dans_le_fichier_connectorpresets.csv|Cable Connecteur Plus de détails sur le type de préréglage fixé dans le fichier connectorpresets.csv]].

Modifiez ensuite le fichier {{FileName|Micro-Fit3_DualRow-PME-2.csv}}. Créez une nouvelle ligne sous les lignes suivantes :

{{Code|lang=bash|code=
# Connector Element Type
# Name,ExtShape,Class,Offset X,Offset Y,Offset Z,Rotation Yaw(Z),Rotation Pitch(Y), Rotation Roll(X)
}}

et ajoutez le texte :

{{Code|lang=text|code=
DualRow-PME-2,ExtShape,Micro-Fit3,0.0,0.0,0.0,0.0,0.0,0.0
}}

puis sous les lignes :

{{Code|lang=bash|code=
# Terminal Element Type
# Name,Terminal,Class,Offset X,Offset Y,Offset Z,Rotation Yaw(Z),Rotation Pitch(Y), Rotation Roll(X),NrOfConnections,Length,Spacing
}}

ajoutez 2 lignes :

{{Code|lang=text|code=
Pin001,Terminal,Terminal,-10.0,0.0,0.0,0.0,0.0,0.0,1,10.0,1.0
Pin002,Terminal,Terminal,10.0,0.0,0.0,0.0,0.0,0.0,1,10.0,1.0
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
and finally below the lines:
</div>

{{Code|lang=bash|code=
# SupportLines Element Type
# Name,SupportLines,Class,Offset X,Offset Y,Offset Z,Rotation Yaw(Z),Rotation Pitch(Y), Rotation Roll(X)
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
add 1 line:
</div>

{{Code|lang=text|code=
SuppLines001,SupportLines,SupportLines,0,0,30.0,0,0,0
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
The lines added above define the starting positions of connector body, 2 terminals and 1 supplines cross. In the next steps the final positions of all elements will be established.
</div>

</div> <!-- End of collapsible element for Filling files... section. Do not remove! -->
</div> <!-- End of collapsible element for Filling files... section. Do not remove! -->

<span id="Adjusting_element_positions"></span>
== Réglage de la position des éléments ==

<div lang="en" dir="ltr" class="mw-content-ltr">
If previous steps have been performed properly, it should be now possible to create the connector from '''Micro-Fit3_DualRow-PME-2''' preset. Create a new document in FreeCAD and create the connector according to [[Cables_CableConnector#Usage|Cable Connector Usage]]. Select the '''Micro-Fit3_DualRow-PME-2''' preset in the task panel and confirm with {{Button|OK}}. The result should look like on the image below.
</div>

[[File:Cables_Creating_Own_Connector_Img1.png]]

<div lang="en" dir="ltr" class="mw-content-ltr">
{{Caption|'''Micro-Fit3_DualRow-PME-2''' connector with default placement data.}}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
In next steps placements of connector body, CableTerminals and SuppLines will be adjusted.
</div>
<div class="mw-collapsible mw-collapsed toccolours">

<span id="Adjusting_position_of_connector_body"></span>
=== Réglage de la position du corps du connecteur ===

<div class="mw-collapsible-content">

<div lang="en" dir="ltr" class="mw-content-ltr">
The placement of imported STEP shape can be different then expected. Let's assume in this example that the plug should stand vertically, with the cables exiting upwards, and the bottom should touch the (0,0,0) point.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Let's forget about CableTerminals and SuppLines for a moment, select the connector in the [[Tree_View|Tree View]] and move it and rotate with [[Std_TransformManip|TransformManip]] tool.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Its placement can be checked now in the [[Property_View|Property View]] or in [[Python_Console|Python Console]]. Details on how to do this are presented in [[Placement|Placement]]. Choose the view of Yaw, Pitch and Roll in the Placement task panel. It will better present rotation results. The precise values can be entered manually.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The placement result should be like this: {{Incode|Placement [Pos{{:=}}(0,0,8.445), Yaw-Pitch-Roll{{:=}}(0,0,-90)]}}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Edit the {{FileName|Micro-Fit3_DualRow-PME-2.csv}} file again and modify the line:
</div>

{{Code|lang=text|code=
DualRow-PME-2,ExtShape,Micro-Fit3,0.0,0.0,0.0,0.0,0.0,0.0
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
to:
</div>

{{Code|lang=text|code=
DualRow-PME-2,ExtShape,Micro-Fit3,0.0,0.0,8.445,0.0,0.0,-90.0
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
and save the {{FileName|Micro-Fit3_DualRow-PME-2.csv}} file.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Delete all objects in current FreeCAD document and create the connector again choosing '''Micro-Fit3_DualRow-PME-2''' preset. Its current placement should match what was just set. Note that the connector placement shown in the [[Property_View|Property View]] or in [[Python_Console|Python Console]] is now {{Incode|Placement [Pos{{:=}}(0,0,0), Yaw-Pitch-Roll{{:=}}(0,0,0)]}}. This is correct because the connector shape placement has been set upon creation based on data in {{FileName|Micro-Fit3_DualRow-PME-2.csv}} file.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The final effect should be like on the image below.
</div>

[[File:Cables_Creating_Own_Connector_Img2.png]]

<div lang="en" dir="ltr" class="mw-content-ltr">
{{Caption|'''Micro-Fit3_DualRow-PME-2''' connector placed vertically.}}
</div>
</div> <!-- End of collapsible element for Adjusting position of connector body section. Do not remove! -->
</div> <!-- End of collapsible element for Adjusting position of connector body. section. Do not remove! -->
<div class="mw-collapsible mw-collapsed toccolours">

<span id="Adjusting_position_of_CableTerminals"></span>
=== Réglage de la position des terminaisons de câbles ===

<div class="mw-collapsible-content">

<div lang="en" dir="ltr" class="mw-content-ltr">
Expand '''CableConnector''' in the [[Tree_View|Tree View]]. It should contain two terminal subobjects: '''CableConnector_Term001''' and '''CableConnector_Term002'''. Both have to be adjusted to fit into connector.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Clear the '''Attachment Support''' property value of both terminals in the [[Property_View|Property View]]. This is necessary to enable unattached movement of terminals.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Select the first terminal in the [[Tree_View|Tree View]] and change its '''Length''' to 6mm in the [[Property_View|Property View]]. Then using [[Std_TransformManip|TransformManip]] tool place it vertically inside connector making sure that Vertex1 of the terminal is facing up (this is important later during cable attachment). The vertex number is shown in bottom status line of FreeCAD while hovering cursor over the vertex in the [[3D_View|3D View]]. Repeat all moves for the second terminal.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Using the same methods as in previous step check if the placement of terminals match the values given below:
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''CableConnector_Term001''': {{Incode|Placement [Pos{{:=}}(0,1.5,12.0), Yaw-Pitch-Roll{{:=}}(0,0,90)]}}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''CableConnector_Term001''': {{Incode|Placement [Pos{{:=}}(0,-1.5,12.0), Yaw-Pitch-Roll{{:=}}(0,0,90)]}}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Retype these values into the {{FileName|Micro-Fit3_DualRow-PME-2.csv}} file by replacing the lines:
</div>

{{Code|lang=text|code=
Pin001,Terminal,Terminal,-10.0,0.0,0.0,0.0,0.0,0.0,1,10.0,1.0
Pin002,Terminal,Terminal,10.0,0.0,0.0,0.0,0.0,0.0,1,10.0,1.0
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
with these lines:
</div>

{{Code|lang=text|code=
Pin001,Terminal,Terminal,0.0,1.5,12.0,0.0,0.0,90.0,1,6.0,1.0
Pin002,Terminal,Terminal,0.0,-1.5,12.0,0.0,0.0,90.0,1,6.0,1.0
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
Delete all objects in current FreeCAD document and create the connector again choosing '''Micro-Fit3_DualRow-PME-2''' preset. Its current placement should match what was just set and should be similar to the image below.
</div>

[[File:Cables_Creating_Own_Connector_Img3.png]]

<div lang="en" dir="ltr" class="mw-content-ltr">
{{Caption|'''Micro-Fit3_DualRow-PME-2''' connector with terminals properly aligned. It is transparent for better visibility of terminals.}}
</div>

</div> <!-- End of collapsible element for Adjusting position of CableTerminals section. Do not remove! -->
</div> <!-- End of collapsible element for Adjusting position of CableTerminals section. Do not remove! -->

<div class="mw-collapsible mw-collapsed toccolours">

<span id="Adjusting_position_of_SuppLines"></span>
=== Réglage de la position des SuppLines ===

<div class="mw-collapsible-content">

<div lang="en" dir="ltr" class="mw-content-ltr">
The single SuppLines object ('''CableConnector_SuppLines001''' in this example) has the shape of a cross with a fixed predefined size. This object can be used as a fixing point for a cable attached to the connector. It is up to the user to use it or not.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The default placement of SuppLines cross in this tutorial is too high. Let's change its placement using methods described in previous steps.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The final placement of SuppLines may look like this:
'''CableConnector_SuppLines001''': {{Incode|Placement [Pos{{:=}}(0,0,25), Yaw-Pitch-Roll{{:=}}(0,0,0)]}}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Retype the above values into the {{FileName|Micro-Fit3_DualRow-PME-2.csv}} file by replacing the line:
</div>

{{Code|lang=text|code=
SuppLines001,SupportLines,SupportLines,0,0,30.0,0,0,0
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
with this line:
</div>

{{Code|lang=text|code=
SuppLines001,SupportLines,SupportLines,0,0,25.0,0,0,0
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
Once again delete all objects in current FreeCAD document and create the connector choosing '''Micro-Fit3_DualRow-PME-2''' preset. The result should present all final adjustments of created objects.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The connector '''Micro-Fit3_DualRow-PME-2''' preset definition is now ready to use in projects.
</div>

</div> <!-- End of collapsible element for Adjusting position of SuppLines section. Do not remove! -->
</div> <!-- End of collapsible element for Adjusting position of SuppLines section. Do not remove! -->

{{Userdocnavi{{#translation:}}}}