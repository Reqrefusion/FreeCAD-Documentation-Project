<languages/>

<span id="About"></span>
== A propos ==

{{TOCright}}
Doxygen est un outil populaire pour générer de la documentation à partir de sources C ++ annotées. Il prend également en charge d'autres langages de programmation populaires tels que C#, PHP, Java et Python. Visitez le [http://www.doxygen.nl/ site Web Doxygen] pour en savoir plus sur le système et consultez le [http://www.doxygen.nl/manual/index.html Manuel Doxygen] pour plus d'informations.

<span id="Doxygen_and_FreeCAD"></span>
== Doxygen et FreeCAD ==

Ce document fournit une brève introduction à Doxygen, en particulier comment il est utilisé dans FreeCAD pour documenter ses sources. Consultez la page [[source documentation/fr|Documentation du code source]] pour obtenir des instructions sur la construction de la documentation FreeCAD, également hébergée en ligne sur le site Web [https://www.freecadweb.org/api/ FreeCAD API].

[[File:FreeCAD_doxygen_workflow.svg|800px]]

{{Caption|Flux général de travail pour produire une documentation du code source avec Doxygen.}}

<span id="Doxygen_with_C++_code"></span>
== Doxygen avec du code C++ ==

La section [http://www.doxygen.nl/manual/starting.html Mise en route (étape 3)] du manuel Doxygen mentionne les méthodes de base pour documenter les sources.

Pour les membres, les classes et les espaces de noms, deux options sont disponibles:
# Placez un "bloc de documentation" spécial (un paragraphe commenté) avant la déclaration ou la définition de la fonction, du membre, de la classe ou de l'espace de noms. Pour les fichiers, classes et membres espaces de nom (variables), il est également autorisé de placer la documentation directement après le membre. Voir la section [http://www.doxygen.nl/manual/docblocks.html#specialblock Blocs de commentaires spéciaux] dans le manuel pour en savoir plus sur ces blocs.
# Placez un bloc de documentation spécial ailleurs (un autre fichier ou un autre emplacement dans le même fichier) et insérez une "commande structurelle" dans le bloc de documentation. Une commande structurelle lie un bloc de documentation à une certaine entité pouvant être documentée (une fonction, un membre, une variable, une classe, un espace de noms ou un fichier). Voir la section [http://www.doxygen.nl/manual/docblocks.html#structuralcommands Documentation à d'autres endroits] dans le manuel pour en savoir plus sur les commandes structurelles.

Remarque:
* L'avantage de la première option est qu'il n'est pas nécessaire de répéter le nom de l'entité (fonction, membre, variable, classe ou espace de nom) car Doxygen analysera le code et extraira les informations pertinentes.
* Les fichiers ne peuvent être documentés qu'en utilisant la deuxième option car il n'y a aucun moyen de mettre un bloc de documentation avant un fichier. Bien sûr, les membres de fichiers (fonctions, variables, typedefs, définit) n'ont pas besoin d'une commande structurelle explicite. il suffit de mettre un bloc de documentation avant ou après eux fonctionnera très bien.

<span id="First_style:_documentation_block_before_the_code"></span>
=== Premier style: bloc de documentation avant le code ===

Généralement, vous souhaiterez documenter le code dans le fichier d'en-tête, juste avant la déclaration de classe ou le prototype de fonction. Ceci permet de garder la déclaration et la documentation proches les unes des autres, il est donc facile de mettre à jour la dernière si le premier change.

Le bloc spécial de documentation commence comme un commentaire de type C {{incode|/*}} mais comporte un astérisque supplémentaire soit {{incode|/**}}. Le bloc se termine par un {{incode|*/}} correspondant. Une alternative consiste à utiliser des commentaires de style C ++ {{incode|//}} avec une barre oblique supplémentaire soit {{incode|///}}.
{{Code|code=
/**
 * Returns the name of the workbench object.
 */
std::string name() const;

/**
 * Set the name to the workbench object.
 */
void setName(const std::string&);

/// remove the added TaskWatcher
void removeTaskWatcher(void);
}}

<span id="Second_style:_documentation_block_elsewhere"></span>
=== Deuxième style: bloc de documentation ailleurs ===

Sinon, la documentation peut être placée dans un autre fichier (ou dans le même fichier en haut ou en bas, ou ailleurs) à l'écart de la déclaration de classe ou du prototype de fonction. Dans ce cas, vous aurez des informations dupliquées, une fois dans le fichier source réel et une fois dans le fichier de documentation.

Premier fichier, {{incode|source.h}}:
{{Code|code=
std::string name() const;
void setName(const std::string&);
}}

Deuxième fichier, {{incode|source.h.dox}}:
{{Code|code=
/** \file source.h
 *  \brief The documentation of source.h
 *   
 *   The details of this file go here.
 */

/** \fn std::string name() const;
 *  \brief Returns the name of the workbench object.
 */
/** \fn void setName(const std::string&);
 *  \brief Set the name to the workbench object.
 */
}}

Dans ce cas, la commande structurelle {{incode|\file}} est utilisée pour indiquer le fichier source documenté. Une commande structurelle {{incode|\fn}} indique que le code suivant est une fonction et que la commande {{incode|\brief}} est utilisée pour décrire brièvement cette fonction.

Cette façon de documenter un fichier source est utile si vous souhaitez simplement ajouter de la documentation à votre projet sans ajouter de code réel. Lorsque vous placez un bloc de commentaires dans un fichier portant l’une des extensions suivantes {{incode|.dox}}, {{incode|.txt}}, ou {{incode|.doc}} alors Doxygen analysera les commentaires et construira la documentation appropriée mais masquera ce fichier auxiliaire de la liste des fichiers.

Le projet FreeCAD ajoute plusieurs fichiers se terminant par {{incode|.dox}} dans de nombreux répertoires afin de fournir une description ou des exemples du code correspondant. Il est important que ces fichiers soient correctement classés dans un groupe ou un espace de noms pour lequel Doxygen fournit des commandes auxiliaires telles que {{incode|\defgroup}}, {{incode|\ingroup}} et {{incode|\namespace}}.

<div class="mw-collapsible mw-collapsed toccolours">
Exemple {{incode|src/Base/core-base.dox}}. Ce fichier dans l'arborescence des sources de FreeCAD donne une brève explication de l'espace de noms {{incode|Base}}.

<div class="mw-collapsible-content">
{{Code|code=
/** \defgroup BASE Base
 *  \ingroup CORE
    \brief Basic structures used by other FreeCAD components
    
    The Base module includes most of the basic functions of FreeCAD, such as:
    - Console services: printing different kinds of messages to the FreeCAD report view or the terminal
    - Python interpreter: handles the execution of Python code in FreeCAD
    - Parameter handling: Management, saving and restoring of user preferences settings
    - Units: Management and conversion of different units

*/

/*! \namespace Base
    \ingroup BASE
    \brief Basic structures used by other FreeCAD components

    The Base module includes most of the basic functions of FreeCAD, such as:
    - Console services: printing different kinds of messages to the FreeCAD report view or the terminal
    - Python interpreter: handles the execution of Python code in FreeCAD
    - Parameter handling: Management, saving and restoring of user preferences settings
    - Units: Management and conversion of different units
*/
}}
</div>
</div>

Un autre exemple est le fichier {{incode|src/Gui/Command.cpp}}. Avant les détails d'implémentation des méthodes {{incode|Gui::Command}}, il existe un bloc de documentation qui explique certains détails de la structure de commande de FreeCAD. Il comporte diverses commandes {{incode|\section}} pour structurer la documentation. Il comprend même un exemple de code inclus dans une paire de mots-clés {{incode|\code}} et {{incode|\endcode}}. Lorsque le fichier est traité par Doxygen, cet exemple de code sera spécialement formaté pour se démarquer. Le mot clé {{incode|\ref}} est utilisé à plusieurs endroits pour créer des liens vers des sections, sous-sections, pages ou ancres nommées dans la documentation. De même, les commandes {{incode|\see}} ou {{incode|\sa}} affichent le libellé "See also" et fournissent un lien vers d'autres classes, fonctions, méthodes, variables, fichiers ou URL.
<div class="mw-collapsible mw-collapsed toccolours">
Exemple {{incode|src/Gui/Command.cpp}}

<div class="mw-collapsible-content">
{{Code|code=
/** \defgroup commands Command Framework
    \ingroup GUI
    \brief Structure for registering commands to the FreeCAD system
 * \section Overview
 * In GUI applications many commands can be invoked via a menu item, a toolbar button or an accelerator key. The answer of Qt to master this
 * challenge is the class \a QAction. A QAction object can be added to a popup menu or a toolbar and keep the state of the menu item and
 * the toolbar button synchronized.
 *
 * For example, if the user clicks the menu item of a toggle action then the toolbar button gets also pressed
 * and vice versa. For more details refer to your Qt documentation.
 *
 * \section Drawbacks
 * Since QAction inherits QObject and emits the \a triggered() signal or \a toggled() signal for toggle actions it is very convenient to connect
 * these signals e.g. with slots of your MainWindow class. But this means that for every action an appropriate slot of MainWindow is necessary
 * and leads to an inflated MainWindow class. Furthermore, it's simply impossible to provide plugins that may also need special slots -- without
 * changing the MainWindow class.
 *
 * \section wayout Way out
 * To solve these problems we have introduced the command framework to decouple QAction and MainWindow. The base classes of the framework are
 * \a Gui::CommandBase and \a Gui::Action that represent the link between Qt's QAction world and the FreeCAD's command world. 
 *
 * The Action class holds a pointer to QAction and CommandBase and acts as a mediator and -- to save memory -- that gets created 
 * (@ref Gui::CommandBase::createAction()) not before it is added (@ref Gui::Command::addTo()) to a menu or toolbar.
 *
 * Now, the implementation of the slots of MainWindow can be done in the method \a activated() of subclasses of Command instead.
 *
 * For example, the implementation of the "Open file" command can be done as follows.
 * \code
 * class OpenCommand : public Command
 * {
 * public:
 *   OpenCommand() : Command("Std_Open")
 *   {
 *     // set up menu text, status tip, ...
 *     sMenuText     = "&Open";
 *     sToolTipText  = "Open a file";
 *     sWhatsThis    = "Open a file";
 *     sStatusTip    = "Open a file";
 *     sPixmap       = "Open"; // name of a registered pixmap
 *     sAccel        = "Shift+P"; // or "P" or "P, L" or "Ctrl+X, Ctrl+C" for a sequence
 *   }
 * protected:
 *   void activated(int)
 *   {
 *     QString filter ... // make a filter of all supported file formats
 *     QStringList FileList = QFileDialog::getOpenFileNames( filter,QString::null, getMainWindow() );
 *     for ( QStringList::Iterator it = FileList.begin(); it != FileList.end(); ++it ) {
 *       getGuiApplication()->open((*it).latin1());
 *     }
 *   }
 * };
 * \endcode
 * An instance of \a OpenCommand must be created and added to the \ref Gui::CommandManager to make the class known to FreeCAD.
 * To see how menus and toolbars can be built go to the @ref workbench.
 *
 * @see Gui::Command, Gui::CommandManager
 */
}}
</div>
</div>

<span id="Example_from_the_VTK_project"></span>
=== Exemple du projet VTK ===

Ceci est un exemple tiré de [https://vtk.org/ VTK], une bibliothèque de visualisation 3D utilisée pour présenter des données scientifiques, telles que des résultats d'éléments finis et des informations de nuage de points.

Une classe pour stocker une collection de coordonnées est définie dans un fichier d'en-tête C++. La partie supérieure du fichier est commentée et quelques mots-clés sont utilisés, tels que {{incode|@class}}, {{incode|@brief}} et {{incode|@sa}} pour indiquer les parties importantes. Dans la classe, avant les prototypes de méthode de classe, un bloc de texte commenté explique le rôle de la fonction et ses arguments.
* Code source de [https://github.com/Kitware/VTK/blob/master/Common/Core/vtkArrayCoordinates.h vtkArrayCoordinates.h].
* Doxygen a produit de la documentation pour la classe [http://www.vtk.org/doc/nightly/html/classvtkArrayCoordinates.html vtkArrayCoordinates].

<span id="Compiling_the_documentation"></span>
== Compiler la documentation ==

[[File:FreeCAD_doxygen_workflow.svg|800px]]

{{Caption|Flux général de travail pour produire une documentation du code source avec Doxygen.}}

Pour générer la documentation du code source, il existe deux étapes de base:
# Créez un fichier de configuration pour contrôler la façon dont Doxygen traitera les fichiers source.
# Exécutez {{incode|doxygen}} sur cette configuration.

<div class="mw-collapsible mw-collapsed toccolours">
Le processus est décrit ci-dessous.

<div class="mw-collapsible-content">
* Assurez-vous que les programmes {{incode|doxygen}} et {{incode|doxywizard}} sont installés sur votre système. Il est également recommandé de disposer du programme {{incode|dot}} de [https://www.graphviz.org/ Graphviz] afin de générer des diagrammes avec les relations entre les classes et les espaces de noms. Sur les systèmes Linux, ces programmes peuvent être installés à partir de votre gestionnaire de paquets.

{{Code|code=
sudo apt install doxygen doxygen-gui graphviz
}}
Assurez-vous d'être dans le même dossier que vos fichiers sources ou dans le répertoire toplevel de votre arborescence des sources si vous avez plusieurs fichiers sources dans différents sous-répertoires.
{{Code|code=
cd toplevel-source
}}

* Exécutez {{incode|doxygen -g DoxyDoc.cfg}} pour créer un fichier de configuration nommé {{incode|DoxyDoc.cfg}}. Si vous omettez ce nom, la valeur par défaut sera {{incode|Doxyfile}} sans extension.
* Il s’agit d’un gros fichier texte contenant de nombreuses variables avec leurs valeurs. Dans le manuel Doxygen, ces variables sont appelées "tags". Le fichier de configuration et toutes les balises sont décrits en détail dans la section [http://www.doxygen.nl/manual/config.html Configuration] du manuel. Vous pouvez ouvrir le fichier avec n’importe quel éditeur de texte et éditer la valeur de chaque balise selon vos besoins. Dans le même fichier, vous pouvez lire des commentaires expliquant chacune des balises et leurs valeurs par défaut.
{{Code|code=
DOXYFILE_ENCODING      = UTF-8
PROJECT_NAME           = "My Project"
PROJECT_NUMBER         =
PROJECT_BRIEF          =
PROJECT_LOGO           =
OUTPUT_DIRECTORY       =
CREATE_SUBDIRS         = NO
ALLOW_UNICODE_NAMES    = NO
BRIEF_MEMBER_DESC      = YES
REPEAT_BRIEF           = YES
...
}}

* Au lieu d'utiliser un éditeur de texte, vous pouvez lancer {{incode|doxywizard}} pour modifier plusieurs tags en même temps. Avec cette interface, vous pouvez définir de nombreuses propriétés telles que les informations de projet, le type de sortie (HTML et LaTeX), l’utilisation de Graphviz pour créer des diagrammes, les messages d’avertissement à afficher, les modèles de fichiers (extensions) à documenter ou à exclure, les filtres de saisie, les en-têtes facultatifs. et des bas de page pour les pages générées HTML, des options pour les sorties LaTeX, RTF, XML ou Docbook, et de nombreuses autres options.
{{Code|code=
doxywizard DoxyDoc.cfg
}}

* Une autre option consiste à créer le fichier de configuration à partir de rien et à ajouter uniquement les balises souhaitées avec un éditeur de texte.
* Une fois la configuration enregistrée, vous pouvez exécuter Doxygen sur ce fichier de configuration.
{{Code|code=
doxygen DoxyDoc.cfg
}}

* La documentation générée sera créée dans un dossier nommé {{incode|toplevel-source/html}}. Il se composera de nombreuses pages HTML, d’images PNG pour les graphiques, de feuilles de style en cascade ({{incode|.css}}), de fichiers Javascript ({{incode|.js}}) et éventuellement de nombreux sous-répertoires contenant plus de fichiers, selon la taille de votre code. Le point d’entrée dans la documentation est {{incode|index.html}} que vous pouvez ouvrir avec un navigateur Web.
{{Code|code=
xdg-open toplevel-source/html/index.html
}}
</div>
</div>

Si vous écrivez de nouvelles classes, fonctions ou un tout nouveau atelier, il est recommandé d'exécuter périodiquement {{incode|doxygen}} pour vérifier que la documentation bloque, [[#Support de Markdown|Markdown]] et [[#Balisage Doxygen|commandes spéciales]] sont lus correctement et toutes les fonctions publiques sont entièrement documentées. Veuillez également lire les [https://github.com/FreeCAD/FreeCAD/blob/master/src/Doc/doctips.dox conseils de documentation] situés dans le code source.

Lorsque vous générez la documentation complète de FreeCAD, vous n’exécutez pas directement {{incode|doxygen}}. Au lieu de cela, le projet utilise {{incode|cmake}} pour configurer l'environnement de construction, puis {{incode|make}} déclenche la compilation des sources FreeCAD et de la documentation Doxygen; ceci est expliqué dans la page [[source documentation/fr|Documentation du code source]].

<span id="Doxygen_markup"></span>
== Balisage Doxygen ==

Toutes les commandes Doxygen [http://www.doxygen.nl/manual/commands.html documentation des commandes] commencent par une barre oblique inversée {{incode|\}} ou un symbole at {{incode|@}}, selon vos préférences. Normalement, la barre oblique inversée {{incode|\}} est utilisée mais il arrive que {{incode|@}} soit utilisée pour améliorer la lisibilité.

Les commandes peuvent avoir un ou plusieurs arguments. Dans le manuel Doxygen, les arguments sont décrits comme suit.
* Si des accolades {{incode|<sharp>}} sont utilisées, l'argument est un mot unique.
* Si vous utilisez des accolades {{incode|(round)}}, l'argument s'étend jusqu'à la fin de la ligne sur laquelle la commande a été trouvée.
* Si des accolades <code>{curly}</code>  sont utilisées, l'argument s'étend jusqu'au paragraphe suivant. Les paragraphes sont délimités par une ligne vide ou par un indicateur de section.
* Si des crochets {{incode|[square]}} sont utilisés, l'argument est facultatif.

<div class="mw-collapsible mw-collapsed toccolours">
Certains des mots-clés les plus couramment utilisés dans la documentation FreeCAD sont présentés ici.
<div class="mw-collapsible-content">
* <code>\defgroup <name> (group title) </code>, voir [http://www.doxygen.nl/manual/commands.html#cmddefgroup \defgroup], et [http://www.doxygen.nl/manual/grouping.html Grouping].
* <code>\ingroup (<groupname> [<groupname> <groupname>])</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdingroup \ingroup], et [http://www.doxygen.nl/manual/grouping.html Grouping].
* <code>\addtogroup <name> [(title)]</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdaddtogroup \addtogroup], et [http://www.doxygen.nl/manual/grouping.html Grouping].
* <code>\author { list of authors }</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdauthor \author]; indique l'auteur de ce morceau de code.
* <code>\brief { brief description }</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdbrief \brief]; décrit brièvement la fonction.
* <code>\file [<name>]</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdfile \file]; documente un fichier source ou en-tête.
* <code>\page <name> (title)</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdpage \page]; place les informations dans une page distincte, sans lien direct avec une classe, un fichier ou un membre spécifique.
* <code>\package <name></code>, voir [http://www.doxygen.nl/manual/commands.html#cmdpackage \package]; indique la documentation d'un package Java (mais également utilisée avec Python).
* <code>\fn (function declaration)</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdfn \fn]; documente une fonction.
* <code>\var (variable declaration)</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdvar \var]; documente une variable; il est équivalent à {{incode|\fn}}, {{incode|\propriété}} et {{incode|\typedef}}.
* <code>\section <section-name> (section title)</code>, see [http://www.doxygen.nl/manual/commands.html#cmdsection \section]; commence une section.
* <code>\subsection <subsection-name> (subsection title)</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdsubsection \subsection]; commence une sous-section.
* <code>\namespace <name></code>, voir [http://www.doxygen.nl/manual/commands.html#cmdnamespace \namespace]; indique des informations pour un espace de noms.
* <code>\cond [(section-label)]</code>, and <code>\endcond</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdcond \cond]; définit un bloc à documenter ou à omettre conditionnellement.
* <code>\a <word></code>, voir [http://www.doxygen.nl/manual/commands.html#cmda \a]; affiche l'argument en italique pour mettre l'accent.
* <code>\param [(dir)] <parameter-name> { parameter description }</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdparam \param]; indique le paramètre d'une fonction.
* <code>\return { description of the return value }</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdreturn \return]; spécifie la valeur de retour.
* <code>\sa { references }</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdsa \sa]; écrit "See also".
* <code>\note { text }</code>, voir [http://www.doxygen.nl/manual/commands.html#cmdnote \note]; ajoute un paragraphe à utiliser comme note.
</div>
</div>

<span id="Markdown_support"></span>
== Support de Markdown==

Depuis Doxygen 1.8, la syntaxe de Markdown est reconnue dans les blocs de documentation. Markdown est un langage de formatage minimaliste inspiré du courrier électronique en texte brut qui, semblable à la syntaxe wiki, se veut simple et lisible sans nécessiter un code compliqué comme celui que l'on trouve dans les commandes HTML, LaTeX ou Doxygen. Markdown a gagné en popularité avec les logiciels libres, en particulier sur les plates-formes en ligne telles que Github, car il permet de créer de la documentation sans utiliser de code compliqué. Consultez la section [http://www.doxygen.nl/manual/markdown.html Markdown support] du manuel Doxygen pour en savoir plus. Visitez le [https://daringfireball.net/projects/markdown/ site Web de Markdown] pour en savoir plus sur l'origine et la philosophie de Markdown.

Doxygen prend en charge un ensemble standard d'instructions de Markdown, ainsi que certaines extensions telles que [https://github.github.com/github-flavored-markdown/ Github Markdown].
<div class="mw-collapsible mw-collapsed toccolours">
Quelques exemples de formatage Markdown sont présentés ci-après.

<div class="mw-collapsible-content">
Ce qui suit est standard Markdown.
{{Code|code=
Voici le texte pour un paragraphe.

Nous continuons avec plus de texte dans un autre paragraphe.

Ceci est un en-tête de niveau 1
========================

Ceci est un en-tête de niveau 2
------------------------

# Ceci est un en-tête de niveau 1

### Ceci est un en-tête de niveau 3 #######

> Il s'agit d'une citation en bloc
> s'étendant sur plusieurs lignes

- Item 1

  Plus de texte pour cet item.

- Item 2
   * élément de liste imbriqué.
   * un autre élément imbriqué.
- Item 3

1. Premier item.
2. Deuxième item.

*astérisques simples: accentuation*

 _underscores simples_

 **double astérisque: forte accentuation**

 __underscores doubles__

Ceci est un paragraphe normal

    Ceci est un bloc de code

Nous continuons avec un paragraphe normal à nouveau.

Utilisation de la fonction `printf()`. En ligne `code`.

[Le lien texte](http://example.net/)

![Texte de légende](/path/to/img.jpg)

<http://www.example.com>
}}

Ce qui suit sont des extensions de Markdown.
<pre>
[TOC]

Premier en-tête | Deuxième en-tête
------------- | -------------
Cellule de contenu | Cellule de contenu
Cellule de contenu | Cellule de contenu 

<nowiki>~~~~~~~~~~~~~</nowiki>{.py}
# A class
class Dummy:
    pass
<nowiki>~~~~~~~~~~~~~</nowiki>

<nowiki>~~~~~~~~~~~~~</nowiki>{.c}
int func(int a, int b) { return a*b; }
<nowiki>~~~~~~~~~~~~~</nowiki>

```
int func(int a, int b) { return a*b; }
```
</pre>
</div>
</div>

<span id="Parsing_of_documentation_blocks"></span>
== Analyse des blocs de documentation ==

Le texte contenu dans un bloc de documentation spécial est analysé avant d’être écrit dans les fichiers de sortie HTML et LaTeX. Pendant l'analyse, les étapes suivantes ont lieu:
* Le formatage de Markdown est remplacé par l'HTML correspondant ou des commandes spéciales.
* Les commandes spéciales à l'intérieur de la documentation sont exécutées. Voir la section [http://www.doxygen.nl/manual/commands.html Special Commands] dans le manuel pour une explication de chaque commande.
* Si une ligne commence par un espace suivi d'un ou de plusieurs astérisques ({{incode|*}}) puis éventuellement plus d'espaces, tous les espaces et astérisques sont supprimés.
* Toutes les lignes vierges résultantes sont traitées comme des séparateurs de paragraphe.
* Des liens sont automatiquement créés pour les mots correspondant aux classes ou fonctions documentées. Si le mot est précédé d'un symbole de pourcentage {{incode|%}}, ce symbole est supprimé et aucun lien n'est créé pour le mot.
* Les liens sont créés lorsque certains motifs se trouvent dans le texte. Voir la section [http://www.doxygen.nl/manual/autolink.html Automatic link generation] dans le manuel pour plus d'informations.
* Les balises HTML figurant dans la documentation sont interprétées et converties en équivalents LaTeX pour la sortie LaTeX. Voir la section [http://www.doxygen.nl/manual/htmlcmds.html HTML Commands] du manuel pour une explication de chaque balise HTML prise en charge.

<span id="Doxygen_with_Python_code"></span>
== Doxygen avec du code Python ==

Doxygen fonctionne mieux pour les langages de type statique tel que le C++. Cependant, il peut également créer une [http://www.doxygen.nl/manual/docblocks.html#pythonblocks documentation for Python files].

Il existe deux manières d'écrire des blocs de documentation pour Python:
# A la Python, en utilisant "docstrings", c’est-à-dire un bloc de texte entouré de <code><nowiki>'''triple quotes'''</nowiki></code> immédiatement après la définition de la classe ou de la fonction.
# La manière Doxygen, en mettant les commentaires avant la définition de la classe ou de la fonction; dans ce cas, les caractères de double hachage {{incode|##}} sont utilisés pour démarrer le bloc de documentation, puis un seul caractère de hachage peut être utilisé dans les lignes suivantes.

Remarque:
* La première option est préférable pour se conformer à [https://www.python.org/dev/peps/pep-0008/#documentation-strings PEP8], [https://www.python.org/dev/peps/pep-0257/ PEP257] et la plupart des directives de style pour l'écriture de Python (voir [https://realpython.com/python-pep8/ 1], [https://realpython.com/documenting-python-code/ 2]). Il est recommandé d'utiliser ce style si vous souhaitez produire des sources documentées à l'aide de [https://www.sphinx-doc.org/en/master/ Sphinx] qui est un outil très courant pour documenter le code Python. Si vous utilisez ce style, Doxygen pourra extraire les commentaires textuellement mais les commandes spéciales Doxygen commençant par {{incode|\}} ou {{incode|@}} ne fonctionneront pas.
* La deuxième option n'est pas dans le style Python traditionnel mais vous permet d'utiliser les commandes spéciales de Doxygen telles que {{incode|\param}} et {{incode|\var}}.

<span id="First_style:_Pythonic_documentation"></span>
=== Premier style: documentation de Python ===

Dans l'exemple suivant, une docstring est au début pour expliquer le contenu général de ce module (fichier). Ensuite, les docstrings apparaissent dans les définitions de méthode, de classe et de méthode. De cette façon, Doxygen extraira les commentaires et les présentera tels quels, sans modification.

{{Code|code=
'''@package pyexample_a
Documentation for this module.
More details.
'''


def func():
    '''Documentation for a function.
    More details.
    '''
    pass


class PyClass:
    '''Documentation for a class.
    More details.
    '''

    def __init__(self):
        '''The constructor.'''
        self._memVar = 0

    def PyMethod(self):
        '''Documentation for a method.'''
        pass
}}

<span id="Second_style:_documentation_block_before_the_code"></span>
=== Deuxième style: bloc de documentation avant le code ===

Dans l'exemple suivant, les blocs de documentation commencent par un double signe de hachage {{incode|##}}. On apparaît au début pour expliquer le contenu général de ce module (fichier). Ensuite, il y a des blocs avant les définitions de méthode, de classe et de méthode de classe, et un bloc après une variable de classe. De cette manière, Doxygen extraira la documentation, reconnaîtra les commandes spéciales {{incode|@package}}, {{incode|@param}} et {{incode|@var}} et formatera le texte en conséquence.
{{Code|code=
## @package pyexample_b
#  Documentation for this module.
#
#  More details.


## Documentation for a function.
#
#  More details.
def func():
    pass


## Documentation for a class.
#
#  More details.
class PyClass:

    ## The constructor.
    def __init__(self):
        self._memVar = 0

    ## Documentation for a method.
    #  @param self The object pointer.
    def PyMethod(self):
        pass

    ## A class variable.
    classVar = 0
    ## @var _memVar
    #  a member variable
}}

<span id="Compiling_the_documentation"></span>
== Compiler la documentation ==

La compilation de la documentation se déroule de la même manière que [[#Compiler la documentation|pour des sources C++]]. Si les deux fichiers Python, {{incode|pyexample_a.py}} et {{incode|pyexample_b.py}}, avec un style de commentaire distinct se trouvent dans le même répertoire, ils seront tous deux traités.
{{Code|code=
cd toplevel-source/
doxygen -g
doxygen Doxyfile
xdg-open ./html/index.html
}}

La documentation doit afficher des informations similaires à celles qui suivent et créer des liens appropriés vers les modules et les classes individuels.
{{Code|code=
Class List
Here are the classes, structs, unions and interfaces with brief descriptions:

N  pyexample_a
   C  PyClass

N  pyexample_b	Documentation for this module
   C  PyClass	Documentation for a class
}}

<span id="Converting_the_Pythonic_style_to_Doxygen_style"></span>
=== Convertir du style à la Python en style à la Doxygen===

Dans l'exemple précédent, le fichier Python commenté dans un [[#Deuxième style: bloc de documentation avant le code|style à la Doxygen]] affiche des informations plus détaillées et un formatage pour ses classes, fonctions et variables. La raison en est que ce style permet à Doxygen d'extraire les commandes spéciales commençant par {{incode|\}} ou {{incode|@}}, contrairement au [[#Premier style: documentation de Python|style à la Python]]. Par conséquent, il serait souhaitable de convertir le style Pythonic en style Doxygen avant de compiler la documentation. Ceci est possible avec un programme auxiliaire Python appelé [https://github.com/Feneric/doxypypy doxypypy]. Ce programme est inspiré d’un programme plus ancien appelé [https://github.com/Feneric/doxypy doxypy], qui prendrait le <code><nowiki>'''docstrings'''</nowiki></code> de Pythonic et les convertir en blocs de commentaires Doxygen commençant par un double hachage {{incode|##}}. Doxypypy va plus loin que cela en analysant les docstrings et en extrayant des éléments d’intérêt tels que des variables et des arguments, voire des doctests (exemple de code dans les docstrings).

Doxypypy peut être installé en utilisant {{incode|pip}}, le programme d'installation du paquet Python.
{{Code|code=
pip3 install --user doxypypy
}}

Si la commande {{incode|pip}} est utilisée sans l'option {{incode|--user}}, des privilèges de super-utilisateur (root) seront nécessaires pour installer le package, mais ce n'est pas nécessaire dans la plupart des cas. Utilisez les autorisations root uniquement si vous êtes certain que le package ne se trouvera pas en conflit avec les packages fournis par votre distribution.

Si le package a été installé en tant qu'utilisateur, il peut résider dans votre répertoire personnel, par exemple dans {{incode|$HOME/.local/bin}}. Si ce répertoire ne se trouve pas dans {{incode|PATH}} de votre système, le programme ne sera pas trouvé. Par conséquent, ajoutez le répertoire à la variable {{incode|PATH}}, soit dans votre fichier {{incode|$HOME/.bashrc}}, soit dans votre fichier {{incode|$HOME/.profile}}.
{{Code|code=
export PATH="$HOME/.local/bin:$PATH"
}}

Vous pouvez également créer un lien symbolique vers le programme {{incode|doxypypy}} en le plaçant dans un répertoire déjà inclus dans {{incode|PATH}}.
{{Code|code=
mkdir -p $HOME/bin
ln -s $HOME/.local/bin/doxypypy $HOME/bin/doxypypy
}}

Une fois que le programme {{incode|doxypypy}} est installé et accessible depuis le terminal, un fichier Python contenant des docstrings Pythonic peut être reformaté en style Doxygen avec les instructions suivantes. Le programme sort le code reformaté sur la sortie standard, redirige donc cette sortie vers un nouveau fichier.
{{Code|code=
doxypypy -a -c pyexample_pythonic.py > pyexample_doxygen.py
}}

<div class="mw-collapsible mw-collapsed toccolours">
{{incode|pyexample_pythonic.py}}

<div class="mw-collapsible-content">
{{Code|code=
'''@package pyexample_pythonic
Documentation for this module.
More details go here.
'''


def myfunction(arg1, arg2, kwarg='whatever.'):
    '''
    Does nothing more than demonstrate syntax.

    This is an example of how a Pythonic human-readable docstring can
    get parsed by doxypypy and marked up with Doxygen commands as a
    regular input filter to Doxygen.

    Args:
        arg1:   A positional argument.
        arg2:   Another positional argument.

    Kwargs:
        kwarg:  A keyword argument.

    Returns:
        A string holding the result.

    Raises:
        ZeroDivisionError, AssertionError, & ValueError.

    Examples:
        >>> myfunction(2, 3)
        '5 - 0, whatever.'
        >>> myfunction(5, 0, 'oops.')
        Traceback (most recent call last):
            ...
        ZeroDivisionError: integer division or modulo by zero
        >>> myfunction(4, 1, 'got it.')
        '5 - 4, got it.'
        >>> myfunction(23.5, 23, 'oh well.')
        Traceback (most recent call last):
            ...
        AssertionError
        >>> myfunction(5, 50, 'too big.')
        Traceback (most recent call last):
            ...
        ValueError
    '''
    assert isinstance(arg1, int)
    if arg2 > 23:
        raise ValueError
    return '{0} - {1}, {2}'.format(arg1 + arg2, arg1 / arg2, kwarg)
}}
</div>
</div>

<div class="mw-collapsible mw-collapsed toccolours">
{{incode|pyexample_pythonic.py}}

<div class="mw-collapsible-content">
{{Code|code=
##@package pyexample_pythonic
#Documentation for this module.
#More details go here.
#


## @brief     Does nothing more than demonstrate syntax.
#
#    This is an example of how a Pythonic human-readable docstring can
#    get parsed by doxypypy and marked up with Doxygen commands as a
#    regular input filter to Doxygen.
#
#
# @param		arg1	A positional argument.
# @param		arg2	Another positional argument.
#
#
# @param		kwarg	A keyword argument.
#
# @return
#        A string holding the result.
#
#
# @exception		ZeroDivisionError
# @exception		AssertionError
# @exception		ValueError.
#
# @b Examples
# @code
#        >>> myfunction(2, 3)
#        '5 - 0, whatever.'
#        >>> myfunction(5, 0, 'oops.')
#        Traceback (most recent call last):
#            ...
#        ZeroDivisionError: integer division or modulo by zero
#        >>> myfunction(4, 1, 'got it.')
#        '5 - 4, got it.'
#        >>> myfunction(23.5, 23, 'oh well.')
#        Traceback (most recent call last):
#            ...
#        AssertionError
#        >>> myfunction(5, 50, 'too big.')
#        Traceback (most recent call last):
#            ...
#        ValueError
# @endcode
#

def myfunction(arg1, arg2, kwarg='whatever.'):
    assert isinstance(arg1, int)
    if arg2 > 23:
        raise ValueError
    return '{0} - {1}, {2}'.format(arg1 + arg2, arg1 / arg2, kwarg)
}}
</div>
</div>

Le fichier d'origine contient un commentaire en haut <code><nowiki>'''@package pyexample_pythonic</nowiki></code> qui indique le module ou l'espace de noms décrit par le fichier. Ce mot clé {{incode|@package}} n'est pas interprété lors de l'utilisation de guillemets triples dans le bloc de commentaires.

Dans le nouveau fichier, le style de commentaire est modifié pour que la ligne devienne {{incode|##@package pyexample_pythonic}} qui sera à présent interprétée par Doxygen. Cependant, pour être interprété correctement, l'argument doit être modifié manuellement pour correspondre au nouveau nom du module (fichier). Après cela, la ligne doit être {{incode|##@package pyexample_doxygen}}.

<div class="mw-collapsible mw-collapsed toccolours">
{{incode|pyexample_doxygen.py}} (le haut est édité manuellement, le reste reste le même)

<div class="mw-collapsible-content">
{{Code|code=
##@package pyexample_doxygen
#Documentation for this module.
#More details go here.
#
}}
</div>
</div>

Pour compiler, créez la configuration et exécutez {{incode|doxygen}} dans le répertoire de niveau supérieur contenant les fichiers.
{{Code|code=
cd toplevel-source/
doxygen -g
doxygen Doxyfile
xdg-open ./html/index.html
}}

La documentation doit afficher des informations similaires à celles qui suivent et créer des liens appropriés vers les modules et les classes individuels.
{{Code|code=
Namespace List
Here is a list of all documented namespaces with brief descriptions:

 N  pyexample_doxygen	Documentation for this module
 N  pyexample_pythonic	
}}

<span id="Converting_the_comment_style_on_the_fly"></span>
=== Convertir le style commentaire à la volée ===

Dans l'exemple précédent, la conversion des blocs de documentation a été effectuée manuellement avec un seul fichier source. Idéalement, nous souhaitons que cette conversion se fasse automatiquement, à la volée, avec un nombre quelconque de fichiers Python. Pour ce faire, la configuration Doxygen doit être modifiée en conséquence.

Pour commencer, n’utilisez pas directement le programme {{incode|doxypypy}}. Créez à la place le fichier de configuration avec {{incode|doxygen -g}} puis éditez le {{incode|Doxyfile}} créé et modifiez la balise suivante.
{{Code|code=
FILTER_PATTERNS        = *.py=doxypypy_filter
}}

Cela signifie que les fichiers correspondant au modèle, tous les fichiers dont l'extension se termine par {{incode|.py}}, passent par le programme {{incode|doxypypy_filter}}. Chaque fois que Doxygen rencontre un tel fichier dans l'arborescence source, le nom du fichier est transmis en tant que premier argument à ce programme.
{{Code|code=
doxypypy_filter example.py
}}

Le programme {{incode|doxypypy_filter}} n'existe pas par défaut. Il doit être créé en tant que script shell pour exécuter {{incode|doxypypy}} avec les options appropriées et pour prendre un fichier comme premier argument.
{{Code|code=
#!/bin/sh
doxypypy -a -c "$1"
}}

Après avoir enregistré ce script shell, assurez-vous qu'il dispose des autorisations nécessaires et qu'il se trouve dans un répertoire contenu dans votre {{incode|PATH}} de votre système.
{{Code|code=
chmod a+x doxypypy_filter
mv doxypypy_filter $HOME/bin
}}

Sur les systèmes Windows, un fichier batch peut être utilisé de la même manière.
{{Code|code=
doxypypy -a -c %1
}}

Une fois cette configuration effectuée, vous pouvez exécuter la commande {{incode|doxygen Doxyfile}} pour générer la documentation normalement. Tous les fichiers Python utilisant <code><nowiki>'''triple quotes'''</nowiki></code Pythonic seront reformatés à la volée pour utiliser des commentaires de style {{incode|##Doxygen}} puis être traité par Doxygen, qui sera désormais en mesure d'interpréter les [[#Balisage Doxygen|commandes speciales]]  et la [[#Support de Markdown|syntaxe de Mardown]]. Le code source d'origine ne sera pas modifié et aucun fichier temporaire portant un nom différent ne doit être créé, comme dans le [[#Convertir du style à la Python en style à la Doxygen|paragraphe précédent]]. Par conséquent, si une instruction {{incode|@package example}} est trouvée, elle n'a pas besoin d'être modifiée manuellement.

Notez que les fichiers Python existants qui utilisent déjà le style {{incode|##double hash}} pour leurs blocs de commentaires ne seront pas affectés par le filtre {{incode|doxypypy}} et seront traités normalement par Doxygen.

[[File:FreeCAD_doxygen_workflow.svg|800px]]

{{Caption|Processus général permettant de produire une documentation de code source avec Doxygen lorsque les fichiers Python sont filtrés pour transformer les blocs de commentaires.}}

<span id="Python_code_quality_check"></span>
=== Contrôle de la qualité du code Python ===

Pour utiliser la conversion automatique des blocs de documentation, il est important que les sources Python d'origine soient correctement écrites conformément aux instructions de Python présentées dans [https://www.python.org/dev/peps/pep-0008/#documentation-strings PEP8] et [https://www.python.org/dev/peps/pep-0257/ PEP257]. Un code mal écrit provoquera l’échec de {{incode|doxypypy}} lors du traitement du fichier, empêchant ainsi Doxygen de formater correctement la documentation.

<div class="mw-collapsible mw-collapsed toccolours">
Les styles de commentaire suivants ne permettent pas l'analyse des docstrings par {{incode|doxypypy}}. Ils doivent donc être évités.

<div class="mw-collapsible-content">
{{Code|code=
'''@package Bad
'''

def first_f(one, two):

    "Bad comment 1"

    result = one + two
    result_m = one * two
    return result, result_m

def second_f(one, two):
    "Bad comment 2"
    result = one + two
    result_m = one * two
    return result, result_m

def third_f(one, two):
    'Bad comment 3'
    result = one + two
    result_m = one * two
    return result, result_m

def fourth_f(one, two):
    #Bad comment 4
    result = one + two
    result_m = one * two
    return result, result_m
}}
</div>
</div>

Utilisez toujours des guillemets triples pour les docstrings et assurez-vous qu'ils suivent immédiatement la déclaration de la classe ou de la fonction.

C'est également une bonne idée de vérifier la qualité de votre code Python avec un outil tel que [http://flake8.pycqa.org/en/latest/ flake8] ([https://gitlab.com/pycqa/flake8 Gitlab ]). Flake8 combine principalement trois outils, [https://github.com/PyCQA/pyflakes Pyflakes], [https://github.com/PyCQA/pycodestyle Pycodestyle] (anciennement pep8) et le [https://github.com/PyCQA/mccabe McCabe complexity checker (Vérificateur de complexité McCabe)] afin d'appliquer le style Pythonic approprié.

{{Code|code=
pip install --user flake8
flake8 example.py
}}

Pour vérifier tous les fichiers dans une arborescence source, utilisez {{incode|find}}.
{{Code|code=
find toplevel-source/ -name '*.py' -exec flake8 {} '+'
}}

Si le projet l'exige, certaines vérifications de code jugées trop strictes peuvent être ignorées. Les codes d'erreur peuvent être consultés dans la [https://pycodestyle.readthedocs.io/en/latest/intro.html#error-codes documentation Pycodestyle].
{{Code|code=
find toplevel-source/ -name '*.py' -exec flake8 --ignore=E266,E402,E722,W503 --max-line-length=100 {} '+'
}}

De la même façon, un programme qui vérifie principalement que les commentaires sont conformes à [https://www.python.org/dev/peps/pep-0257/ PEP257] est [https://github.com/PyCQA/pydocstyle Pydocstyle]. Les codes d'erreur peuvent être consultés dans la [http://www.pydocstyle.org/fr/4.0.0/error_codes.html documentation Pydocstyle].
{{Code|code=
pip install --user pydocstyle
pydocstyle example.py
}}

Utilisez-le également avec {{incode|find}} pour effectuer des vérifications de docstring sur tous les fichiers source.
{{Code|code=
find toplevel-source/ -name '*.py' -exec pydocstyle {} '+'
}}

<span id="Source_documentation_with_Sphinx"></span>
== Documentation source avec Sphinx ==

[https://www.sphinx-doc.org/en/master/ Sphinx] est le système le plus populaire pour documenter le code source Python. Cependant, étant donné que les fonctions principales et les ateliers de FreeCAD sont écrits en C++, il a été jugé que Doxygen est un meilleur outil de documentation pour ce projet.

Bien que Sphinx puisse analyser nativement les docstrings Python, cela demande un peu plus de travail d'analyser les sources C++. Le projet [https://breathe.readthedocs.io/en/latest/ Breathe] ([https://github.com/michaeljones/breathe Github]) est une tentative de combler le fossé entre Sphinx et Doxygen, afin de Intégrez la documentation de code source Python et C++ dans le même système. Premièrement, Doxygen doit être configuré pour générer un fichier XML. la sortie XML est alors lue par Breathe et convertie en entrée appropriée pour Sphinx.

Consultez le [https://breathe.readthedocs.io/en/latest/quickstart.html Guide de démarrage rapide] dans la documentation de Breathe pour en savoir plus sur ce processus.

Voir cette réponse dans [https://stackoverflow.com/a/35377654 Stackoverflow] pour d'autres alternatives permettant de documenter le code C++ et Python ensemble dans le même projet.

<span id="Related"></span>
== En relation ==

* [[Source_documentation/fr|Documentation du code source]]
* [https://www.freecadweb.org/api/ FreeCAD API website]

[[Category:Developer_Documentation{{#translation:}}]]
[[Category:Developer{{#translation:}}]]
[[Category:3rd Party{{#translation:}}]]