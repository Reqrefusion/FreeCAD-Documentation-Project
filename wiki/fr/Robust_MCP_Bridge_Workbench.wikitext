<languages/>

[[Image:FreecadRobustMCPBridge.svg|thumb|128px|Icône de l'atelier Robust MCP Bridge]]

{{TOCright}}

==Description==

L'atelier  '''Robust MCP Bridge''' est le point de connexion côté serveur qui fait le pont avec le [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server], qui permet à des applications externes de contrôler FreeCAD via le [https://modelcontextprotocol.io/ Model Context Protocol (MCP)]. L'atelier s'exécute dans FreeCAD et expose des interfaces XML-RPC et JSON-RPC auxquelles les clients MCP externes peuvent se connecter.

Cet atelier est conçu pour fonctionner avec le [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server] (disponible sur PyPI), qui permet à des assistants IA tels que [https://claude.ai Claude] d'interagir avec FreeCAD via un langage naturel. La documentation complète et le code source sont disponibles sur [https://github.com/spkane/freecad-robust-mcp-and-more github/spkane/freecad-robust-mcp-and-more], où vous trouverez le serveur MCP, Bridge et certaines macros FreeCAD utilisées à diverses fins, pas nécessairement liées à l'IA ou au travail MCP.

'''Principales fonctions :'''
* Barre d'outils pour démarrer/arrêter le pont MCP.
* Indicateur d'état affichant l'état de la connexion (vert = en cours, rouge = arrêté).
* Serveur XML-RPC sur un port configurable (par défaut : 9875).
* Serveur socket JSON-RPC sur port configurable (par défaut : 9876).
* Prise en charge du mode sans affichage pour l'automatisation et les pipelines CI/CD.
* Système de file d'attente thread-safe garantissant la sécurité des opérations FreeCAD.
* Démarrage automatique configurable au lancement de FreeCAD.

==Installation==

<span id="Via_Addon_Manager_(recommended)"></span>
===Via le gestionnaire d'extensions (recommandé)===

# Lancez FreeCAD.
# Allez dans {{MenuCommand|Outils → Gestionnaire d'extensions}}.
# Recherchez « Robust MCP Bridge ».
# Cliquez sur {{Button|Installer}}.
# Redémarrez FreeCAD.

<span id="Manual_installation"></span>
=== Installation manuelle ===

Téléchargez la dernière version depuis les [https://github.com/spkane/freecad-robust-mcp-and-more/releases releases GitHub] et extrayez-la dans votre répertoire FreeCAD Mod :

* '''Linux''': {{FileName|~/.local/share/FreeCAD/Mod/FreecadRobustMCPBridge/}}
* '''macOS''': {{FileName|~/Library/Application Support/FreeCAD/Mod/FreecadRobustMCPBridge/}}
* '''Windows''': {{FileName|%APPDATA%/FreeCAD/Mod/FreecadRobustMCPBridge/}}

<span id="Usage"></span>
==Utilisation==

<span id="GUI_mode"></span>
===Mode interface utilisateur===

[[Image:Addon_RobustMCPBridge_toolbar.png|Barre d'outils de l'atelier Robust MCP Bridge]]

# Passez à l'atelier '''Robust MCP Bridge''' à l'aide du sélecteur d'atelier.
# Cliquez sur {{Button|Start Bridge}} dans la barre d'outils.
# L'indicateur d'état devient vert lorsque l'application est en cours d'exécution.
# Les clients MCP externes peuvent désormais se connecter à localhost:9875 (XML-RPC) ou localhost:9876 (Socket).

Pour arrêter le bridge, cliquez sur {{Button|Stop Bridge}} dans la barre d'outils.

[[Image:Addon_RobustMCPBridge_statusbar.png|Barre d'état de l'atelier Robust MCP Bridge]]

<span id="Headless_mode"></span>
===Mode sans affichage===

Pour l'automatisation et les pipelines CI/CD, le bridge peut fonctionner sans l'interface graphique :

'''Linux :'''

{{Code|code=
freecadcmd ~/.local/share/FreeCAD/Mod/FreecadRobustMCPBridge/freecad_mcp_bridge/blocking_bridge.py
}}

'''macOS :'''

{{Code|code=
/Applications/FreeCAD.app/Contents/Resources/bin/freecadcmd \
    ~/Library/Application\ Support/FreeCAD/Mod/FreecadRobustMCPBridge/freecad_mcp_bridge/blocking_bridge.py
}}

Le bridge démarrera et maintiendra FreeCAD en cours d'exécution jusqu'à ce que vous appuyiez sur Ctrl+C.

<span id="Configuration"></span>
== Configuration ==

<div lang="en" dir="ltr" class="mw-content-ltr">
Access preferences via {{MenuCommand|Edit → Preferences → Robust MCP Bridge}} or {{MenuCommand|Robust MCP Bridge → MCP Bridge Preferences...}}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
{| class="wikitable"
! Setting !! Description !! Default
|-
| Auto-start bridge || Start bridge automatically when FreeCAD launches || Disabled
|-
| Show status indicator || Display connection status in FreeCAD's status bar || Enabled
|-
| XML-RPC Port || Port for XML-RPC connections || 9875
|-
| Socket Port || Port for JSON-RPC socket connections || 9876
|}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
[[Image:Addon RobustMCPBridge preferences.png|800px|Robust MCP Bridge workbench preference pane]]
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Features by mode==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
{| class="wikitable"
! Feature !! GUI Mode !! Headless Mode
|-
| Object creation || Yes || Yes
|-
| Boolean operations || Yes || Yes
|-
| Export (STEP, STL, 3MF) || Yes || Yes
|-
| Macro execution || Yes || Yes
|-
| Document management || Yes || Yes
|-
| Screenshots || Yes || No
|-
| Object colors/visibility || Yes || No
|-
| Camera/view control || Yes || No
|}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Connecting MCP clients==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
This workbench provides the server that MCP clients connect to. To use with AI assistants like Claude, you need an MCP client such as the [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server]:
</div>

{{Code|code=
pip install freecad-robust-mcp
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
Or using uv:
</div>

{{Code|code=
uv tool install freecad-robust-mcp
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
See the [https://github.com/spkane/freecad-robust-mcp-and-more GitHub repository] for full documentation on configuring MCP clients.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Troubleshooting==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Bridge won't start===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Check the FreeCAD Python console ({{MenuCommand|View → Panels → Python console}}) for error messages.
# Ensure no other process is using ports 9875/9876.
# Try restarting FreeCAD.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Connection refused===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Verify the bridge is running (green status indicator in toolbar).
# Check that ports match between the workbench preferences and your MCP client configuration.
# If connecting from Docker, use {{incode|host.docker.internal}} instead of {{incode|localhost}}.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Headless mode won't start===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Ensure you're using {{incode|freecadcmd}} (not {{incode|freecad}}).
# Verify the script path is correct for your installation.
# Test FreeCAD first: {{incode|freecadcmd -c "print('test')"}}.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Links==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
* [https://github.com/spkane/freecad-robust-mcp-and-more/releases Latest Release]
* [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server on PyPI] - The MCP Server that connects to this bridge.
* [https://spkane.github.io/freecad-robust-mcp-and-more/ Full Documentation] - Complete guides, API reference, and tutorials.
* [https://github.com/spkane/freecad-robust-mcp-and-more GitHub Repository] - Source code and issue tracker.
* [https://modelcontextprotocol.io/ Model Context Protocol] - The protocol specification.
</div>


[[Category:Addons{{#translation:}}]]
[[Category:External_Workbenches{{#translation:}}]]