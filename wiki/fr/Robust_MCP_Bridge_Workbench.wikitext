<languages/>

[[Image:FreecadRobustMCPBridge.svg|thumb|128px|Icône de l'atelier Robust MCP Bridge]]

{{TOCright}}

==Description==

L'atelier  '''Robust MCP Bridge''' est le point de connexion côté serveur qui fait le pont avec le [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server], qui permet à des applications externes de contrôler FreeCAD via le [https://modelcontextprotocol.io/ Model Context Protocol (MCP)]. L'atelier s'exécute dans FreeCAD et expose des interfaces XML-RPC et JSON-RPC auxquelles les clients MCP externes peuvent se connecter.

<div lang="en" dir="ltr" class="mw-content-ltr">
This workbench is designed to work with the [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server] (available on PyPI), which allows AI assistants like [https://claude.ai Claude] to interact with FreeCAD through natural language. The full documentation and source code can be found at [https://github.com/spkane/freecad-robust-mcp-and-more github/spkane/freecad-robust-mcp-and-more], where you will find the MCP Server, Bridge and some FreeCAD Macros used for various things, not necessarily related to AI or the MCP work.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''Key Features:'''
* Toolbar controls for starting/stopping the MCP bridge.
* Status indicator showing connection state (green=running, red=stopped).
* XML-RPC server on configurable port (default: 9875).
* JSON-RPC socket server on configurable port (default: 9876).
* Headless mode support for automation and CI/CD pipelines.
* Thread-safe queue system ensuring safe FreeCAD operations.
* Configurable auto-start on FreeCAD launch.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Installation==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Via Addon Manager (recommended)===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Open FreeCAD
# Go to {{MenuCommand|Tools → Addon Manager}}
# Search for "Robust MCP Bridge"
# Click {{Button|Install}}
# Restart FreeCAD
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Manual installation===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Download the latest release from [https://github.com/spkane/freecad-robust-mcp-and-more/releases GitHub Releases] and extract to your FreeCAD Mod directory:
</div>

* '''Linux''': {{FileName|~/.local/share/FreeCAD/Mod/FreecadRobustMCPBridge/}}
* '''macOS''': {{FileName|~/Library/Application Support/FreeCAD/Mod/FreecadRobustMCPBridge/}}
* '''Windows''': {{FileName|%APPDATA%/FreeCAD/Mod/FreecadRobustMCPBridge/}}

<div lang="en" dir="ltr" class="mw-content-ltr">
==Usage==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===GUI mode===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
[[Image:Addon_RobustMCPBridge_toolbar.png|Robust MCP Bridge workbench toolbar]]
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Switch to the '''Robust MCP Bridge''' workbench using the workbench selector
# Click {{Button|Start Bridge}} in the toolbar
# The status indicator turns green when running
# External MCP clients can now connect to localhost:9875 (XML-RPC) or localhost:9876 (Socket)
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
To stop the bridge, click {{Button|Stop Bridge}} in the toolbar.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
[[Image:Addon_RobustMCPBridge_statusbar.png|Robust MCP Bridge workbench statusbar]]
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Headless mode===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
For automation and CI/CD pipelines, the bridge can run without the GUI:
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''Linux:'''
</div>

{{Code|code=
freecadcmd ~/.local/share/FreeCAD/Mod/FreecadRobustMCPBridge/freecad_mcp_bridge/blocking_bridge.py
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
'''macOS:'''
</div>

{{Code|code=
/Applications/FreeCAD.app/Contents/Resources/bin/freecadcmd \
    ~/Library/Application\ Support/FreeCAD/Mod/FreecadRobustMCPBridge/freecad_mcp_bridge/blocking_bridge.py
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
The bridge will start and keep FreeCAD running until you press Ctrl+C.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Configuration==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Access preferences via {{MenuCommand|Edit → Preferences → Robust MCP Bridge}} or {{MenuCommand|Robust MCP Bridge → MCP Bridge Preferences...}}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
{| class="wikitable"
! Setting !! Description !! Default
|-
| Auto-start bridge || Start bridge automatically when FreeCAD launches || Disabled
|-
| Show status indicator || Display connection status in FreeCAD's status bar || Enabled
|-
| XML-RPC Port || Port for XML-RPC connections || 9875
|-
| Socket Port || Port for JSON-RPC socket connections || 9876
|}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
[[Image:Addon RobustMCPBridge preferences.png|800px|Robust MCP Bridge workbench preference pane]]
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Features by mode==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
{| class="wikitable"
! Feature !! GUI Mode !! Headless Mode
|-
| Object creation || Yes || Yes
|-
| Boolean operations || Yes || Yes
|-
| Export (STEP, STL, 3MF) || Yes || Yes
|-
| Macro execution || Yes || Yes
|-
| Document management || Yes || Yes
|-
| Screenshots || Yes || No
|-
| Object colors/visibility || Yes || No
|-
| Camera/view control || Yes || No
|}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Connecting MCP clients==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
This workbench provides the server that MCP clients connect to. To use with AI assistants like Claude, you need an MCP client such as the [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server]:
</div>

{{Code|code=
pip install freecad-robust-mcp
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
Or using uv:
</div>

{{Code|code=
uv tool install freecad-robust-mcp
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
See the [https://github.com/spkane/freecad-robust-mcp-and-more GitHub repository] for full documentation on configuring MCP clients.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Troubleshooting==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Bridge won't start===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Check the FreeCAD Python console ({{MenuCommand|View → Panels → Python console}}) for error messages.
# Ensure no other process is using ports 9875/9876.
# Try restarting FreeCAD.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Connection refused===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Verify the bridge is running (green status indicator in toolbar).
# Check that ports match between the workbench preferences and your MCP client configuration.
# If connecting from Docker, use {{incode|host.docker.internal}} instead of {{incode|localhost}}.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
===Headless mode won't start===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Ensure you're using {{incode|freecadcmd}} (not {{incode|freecad}}).
# Verify the script path is correct for your installation.
# Test FreeCAD first: {{incode|freecadcmd -c "print('test')"}}.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
==Links==
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
* [https://github.com/spkane/freecad-robust-mcp-and-more/releases Latest Release]
* [https://pypi.org/project/freecad-robust-mcp/ Robust MCP Server on PyPI] - The MCP Server that connects to this bridge.
* [https://spkane.github.io/freecad-robust-mcp-and-more/ Full Documentation] - Complete guides, API reference, and tutorials.
* [https://github.com/spkane/freecad-robust-mcp-and-more GitHub Repository] - Source code and issue tracker.
* [https://modelcontextprotocol.io/ Model Context Protocol] - The protocol specification.
</div>


[[Category:Addons{{#translation:}}]]
[[Category:External_Workbenches{{#translation:}}]]