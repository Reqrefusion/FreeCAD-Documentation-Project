<languages/>

{{Docnav/de
|[[FEM_MeshNetgenFromShape/de|Netz aus Form durch Netgen]]
|[[FEM_MeshBoundaryLayer/de|NetzGrenzschicht]]
|[[FEM_Workbench/de|FEM]]
|IconL=FEM_MeshNetgenFromShape.svg
|IconR=Fem-femmesh-boundary-layer.svg
|IconC=Workbench_FEM.svg
}}

{{GuiCommandContainer|
{{GuiCommand/de
|Name=FEM MeshGmshFromShape
|Name/de=FEM NetzGmshAusForm
|MenuLocation=Netz → FEM-Netz aus Form - Gmsh
|Workbenches=[[FEM_Workbench/de|FEM]]
|SeeAlso=[[FEM_tutorial/de|FEM Tutorium]]
}}
{{GuiCommandFemInfo/de
|Solvers=Alle
}}
}}

<span id="Description"></span>
==Beschreibung==

Für eine Finite-Elemente-Analyse muss die Geometrie in ein [[FEM_Mesh/de|FEM-Netz]] diskretisiert werden. Dieser Befehl verwendet die Software [https://en.wikipedia.org/wiki/Gmsh Gmsh] (die auf dem System installiert sein muss) zum Erstellen des Netzes.

Abhängig vom Betriebssystem und dem Installationspaket kann Gmsh in FreeCAD enthalten sein oder auch nicht.  Für weitere Informationen siehe [[FEM_Install/de#FEM Netz Generator|FEM Installation]].

<span id="Usage"></span>
==Anwendung== 

# Die Form auswählen, die analysiert werden soll. Bei der Volumen-FEM muss es sich um einen Festkörper oder Compsolid (zusammengesetzten Festkörper) handeln. Ein Compsolid ist erforderlich, wenn dein Teil aus mehreren Materialien besteht. (Ein Compsolid kann mit dem Befehl [[Part_BooleanFragments/de|BoolescheFragmente]] erstellt werden).
# Es gibt mehrere Möglichkeiten, den Befehl aufzurufen:
#* Die Schaltfläche {{Button|[[Image:FEM_MeshGmshFromShape.svg|16px]] [[FEM_MeshGmshFromShape/de|FEM-Netz aus Form - Gmsh]]}} drücken.
#* Den Menüeintrag {{MenuCommand|Netz → [[Image:FEM_MeshGmshFromShape.svg|16px]] FEM-Netz aus Form - Gmsh}} auswählen.
# Wahlweise minimale und maximale Elementgröße anpassen (Die vorgegebene Einstellung erstellt oft zu grobe Netze). Es kann auch die dimensionale Art (1D, 2D, 3D) eingestellt (wobei die Voreinstellung ''From shape'' meistens passt) sowie die Ordnung des Elements geändert werden.
# Die Schaltfläche {{Button|Anwenden}} anklicken und warten, bis die Erstellung des Netzes abgeschlossen ist. {{Version/de|1.0}}: Wahlweise die Schaltfläche {{Button|Abbrechen}} drücken, um das Vernetzen abzubrechen.
# Die Schaltfläche {{Button|OK}} drücken, um die Aufgabe abschließen. Jetzt sollte sich ein neues FEMMeshGmsh-Objekt im aktiven Analysebehälter befinden. Oder die Schaltfläche  {{Button|Abbrechen}} drücken, um die Änderung oder die Erstellung des Netzobjekts abzubrechen.

Nachdem das Netz erstellt wurde, können seine Eigenschaften im [[Property_editor/de|Eigenschafteneditor]] angepasst werden. Nach dem Ändern einer Eigenschaft, muss der Gmsh-Dialog erneut geöffnet und die Schaltfläche {{Button|Anwenden}} gedrückt werden (der Dialog kann geöffnet bleiben, während weitere Eigenschaften geändert werden).

Die Schaltfläche  {{Button|Gmsh-Version}} erlaubt es, Details zur aktuell benutzten Gmsh-Binary zu überprüfen.

<span id="Properties"></span>
==Eigenschaften==

<div lang="en" dir="ltr" class="mw-content-ltr">
* {{PropertyData|Algorithm2D}}: The algorithm to create 2D meshes. The different algorithms are [https://gmsh.info/doc/texinfo/gmsh.html#Choosing-the-right-unstructured-algorithm explained here]. For Delaunay, see [https://en.wikipedia.org/wiki/Delaunay_triangulation Delaunay triangulation].
* {{PropertyData|Algorithm3D}}: The algorithm to create 3D meshes. The different algorithms are [https://gmsh.info/doc/texinfo/gmsh.html#Choosing-the-right-unstructured-algorithm explained here].
* {{PropertyData|Characteristic Length Max}}: The maximal size of the mesh elements. If set to ''0.0'', the size will be set automatically. This property can also be changed in the Gmsh dialog in the field '''Max element size'''.
* {{PropertyData|Characteristic Length Min}}: The minimal size of the mesh elements. If set to ''0.0'', the size will be set automatically. This property can also be changed in the Gmsh dialog in the field '''Min element size'''.
* {{PropertyData|Coherence Mesh}}:
** true (default); duplicate mesh nodes will be removed
** false
* {{PropertyData|Element Dimension}}: The dimension of the mesh elements. This property can also be changed in the Gmsh dialog in the field '''Mesh element dimension'''.
** From Shape (default); the dimension will be determined from the dimension of the object that is meshed
** 1D
** 2D
** 3D
* {{PropertyData|Element Order}}: The [https://www.comsol.de/support/knowledgebase/1270 mesh element order]. This property can also be changed in the Gmsh dialog in the field '''Mesh order'''. {{Version|0.20}}
** 1st
** 2nd (default)</br>'''Note:''' If you use the solver [[FEM_SolverElmer|Elmer]] you may get this error: ''ERROR:: GetEdgeBasis: Can't handle but linear elements, sorry.'' This means the solver equation cannot handle 2nd order meshes. Use either 1st order meshes then, or check the FreeCAD Wiki page for the solver equation for possible options to handle 2nd order meshes.
* {{PropertyData|Geometry Tolerance}}: The geometrical tolerance for the mesh to match the object edges. The default ''0.0'' means that Gmsh's default of 1e-8 is used.
* {{PropertyData|Groups Of Nodes}}: All nodes and not only the elements will be saved for each physical mesh group. Physical groups are collections of mesh entities (points, curves, surfaces and volumes). They  and are identified by their dimension and by a tag. For example a mesh of the same object region is internally tagged the same. So all surfaces of this region will form one physical group.
* {{PropertyData|High Order Optimize}}: If and how meshes with {{PropertyData|Element Order}} = ''2nd'' are optimized. The optimization is done by a deformation of the element borders.</br>{{Version|0.20}} Gmsh supports different optimization algorithms. '''Elastic''' is an algorithm in which the mesh elements are treated as a collection of deformable viscoelastic solids. 1st order meshes cannot be optimized because their element borders are linear an cannot be deformed.
* {{PropertyData|Mesh Size From Curvature}} {{Version|0.20}}: The number of mesh elements per <math>2\pi</math> times the radius of the curvature. To get a finer mesh at small corners or holes, this value can be increased for better results
[[Image:FEM_Gmsh-MeshSizeFromCurvature.png|450px]]
{{Caption|Effect of  ''Mesh Size From Curvature'''; left: set to 12, right: deactivated}}
* {{PropertyData|Optimize Netgen}}: Whether the mesh will be optimized using  the 3D mesh generator [https://github.com/NGSolve/netgen Netgen] to improve the quality of tetrahedral elements. '''Note:''' since Netgen can only create tetrahedral elements, this option is ignored for meshes whose {{PropertyData|Element Dimension}} is not ''3D''.
* {{PropertyData|Optimize Std}} Optimizes the mesh to improve the quality of tetrahedral elements.
* {{PropertyData|Recombination Algorithm}} {{Version|0.20}}: The algorithm used for {{PropertyData|Recombine 3D All}} and also for {{PropertyData|Recombine All}}. For more info, see section [[#Element_Recombination|Element Recombination]] and for technical details see the [https://www.gmsh.info/doc/texinfo/gmsh.html#t11 Gmsh documentation].
* {{PropertyData|Recombine 3D All}} {{Version|0.20}}: Applies a recombination 3D-algorithm to all volumes. Tetrahedra will be recombined into prisms, hexahedra or pyramids if possible. 
* {{PropertyData|Recombine All}}: Applies a recombination algorithm to all surfaces. Triangles will be recombined into quadrangles when possible. 
* {{PropertyData|Second Order Linear}}: Option if second order nodes (if {{PropertyData|Element Order}} set to ''2nd'') and/or mesh refinement points are created by linear interpolation.
** true;  linear interpolation is used
** false (default); curvilinear interpolation is used
* {{PropertyData|Subdivision Algorithm}} {{Version|1.0}}: allows the creation of quadrilateral and hexahedral elements by subdivision
** None; doesn't use any subdivision algorithm
** All Quadrangles; creates quadrilateral elements by subdivision
** All Hexahedra; creates hexahedral elements by subdivision
** Barycentric; creates triangular elements by barycentric subdivision
</div>

<span id="Notes"></span>
==Hinweise==

<span id="Nonpositive_Jacobians"></span>
===Nichtpositive Jacobi-Matrizen===

Wenn ein Vermaschungs-Fehler über Nichtpositive Jacobi-Matrizen auftritt, können die folgenden Lösungsstrategien angewendet werden:

* Setze {{PropertyData/de|Second Order Linear}} auf ''true'', aber belasse {{PropertyData/de|Element Order}} auf „2nd“.
* Setze {{PropertyData/de|Element Order}} auf ''1st''.
* Eine kleinere Elementgröße verwenden, indem man die {{PropertyData/de|Characteristic Length Max}} reduziert.
* Wenn der Löser ccxtools verwendet wird und die Schaltfläche Ausführen (nicht das Aufgabenfenster) verwendet wird, werden die Knoten der nicht positiven Jacobi-Elemente grün dargestellt.

<span id="Mesh_Growth"></span>
===Netz-Wachstum===

An Kanten und kleinen geometrischen Elementen muss das Netz kleiner sein als in Bereichen ohne Kanten. Daher nimmt die Größe der Netzelemente mit zunehmender Entfernung von den Kanten zu. Die Wachstumsstrategie von Gmsh besteht darin, zwischen Kanten unterschiedlicher Größe zu wachsen. Das Wachstum schlägt also fehl, wenn ein Bereich Kanten gleicher Größe aufweist, wie beispielsweise bei diesem Rohr:

[[Image:FEM_Gmsh-MeshGrowth-failing.png|400px]]
{{Caption|Fehlgeschlagenes Netz-Wachstum, da der zylindrische Bereich von den gleichen Kanten umgeben ist}}

Um ein sinnvolles Netzwachstum zu ermöglichen, muss in diesem Fall dem Bereich eine Kante hinzugefügt werden. Im Beispiel wäre dies ein Kreis in der Mitte des Zylinders. Der Kreis wird als Teil eines Verbunds [[Part_BooleanFragments/de|BoolescheBestandteile]] (um ein CompSolid zu bilden), siehe [https://forum.freecad.org/download/file.php?id=146255 die Projekt-Datei] für das Beispiel.

[[Image:FEM_Gmsh-MeshGrowth-success.png|400px]]
{{Caption|Sinnvolles Netzwachstum aufgrund der zusätzlichen Kante in der Mitte des zylindrischen Bereichs}}

<span id="Element_Recombination"></span>
===Element-Rekombination===

Elemente können auf zwei Arten neu kombiniert werden: auf der Oberfläche von Objekten, sodass Dreiecke nach Möglichkeit zu Vierecken neu kombiniert werden, und im Volumen von Objekten, sodass Tetraeder nach Möglichkeit zu Prismen, Hexaedern oder Pyramiden neu kombiniert werden. Betrachtet man die Geometrie, wird deutlich, dass das Ergebnis der Neukombination stark von der Geometrie des Körpers abhängt und dass die Neukombination eines 3D-Körpers nur an der Oberfläche meist zu seltsamen Ergebnissen führt.

Zur Veranschaulichung sehe man sich das Bild unten an. Ein Quaderkörper wird mit den Standardeinstellungen (Tetraeder, Netz der 2. Ordnung) vernetzt. Dies ist das Teilbild oben links. Das Bild oben rechts zeigt das Ergebnis, wenn zusätzlich die Elemente nur an der Oberfläche des Körpers neu kombiniert werden. Das Ergebnis ist schlecht, da die geänderten Oberflächenelemente nicht zu den unveränderten Volumenelementen passen. Daher ist {{PropertyData/de|Recombine All}} allein in der Regel nur für 2D-Netze sinnvoll. </br>Wenn wir jetzt auch {{PropertyData/de|Recombine 3D All}} verwenden, ist das Ergebnis besser, siehe das untere linke Teilbild. Allerdings zeigt das Ergebnis keinen großen Unterschied zu dem Netz ohne Rekombinationen. Da unser Körper ein Quader ist, ist es daher sinnvoll, einen Rekombinationsalgorithmus zu verwenden, der ebenfalls versucht, Quader zu erzeugen. Dieses Ergebnis ist im unteren rechten Teilbild zu sehen.

Der ''einfache'' Rekombinationsalgorithmus lässt einige Dreiecke im Netz zurück, falls die Rekombination zu schlecht geformten Vierecken führt. Man verwendet in solchen Fällen einen ''Full-Quad''-Rekombinationsalgorithmus, der automatisch ein gröberes Netz erstellt, gefolgt von der Rekombination, Glättung und Unterteilung. Siehe [https://forum.freecad.org/viewtopic.php?f=18&t=20351#p520392 Foren-Thema]

[[Image:FEM_Gmsh-Recombination.png|600px]]
{{Caption|Auswirkung der Rekombination von Netzelementen.<br>
Oben links: Standardnetz.<br>
Oben rechts: Rekombination nur an der Oberfläche unter Verwendung des '''einfachen''' Algorithmus.<br>
Unten links: Rekombination an der Oberfläche und im Volumen unter Verwendung des '''einfachen''' Algorithmus.<br>
Unten rechts: Rekombination an der Oberfläche und im Volumen unter Verwendung des '''einfachen full-quad''' Algorithmus}}


{{Docnav/de
|[[FEM_MeshNetgenFromShape/de|Netz aus Form durch Netgen]]
|[[FEM_MeshBoundaryLayer/de|NetzGrenzschicht]]
|[[FEM_Workbench/de|FEM]]
|IconL=FEM_MeshNetgenFromShape.svg
|IconR=Fem-femmesh-boundary-layer.svg
|IconC=Workbench_FEM.svg
}}

{{FEM_Tools_navi{{#translation:}}}}
{{Userdocnavi{{#translation:}}}}