<languages/>

{{Macro/de
|Name=Baumobjekte ausklappen
|Icon=Macro_ExpandTreeItem.svg
|Description=Dieses Makro erweitert den ausgewählten Baum und alle Unterbäume in der Baumansicht.<br/>Wenn keine Auswahl vorhanden ist, werden alle Bäume erweitert.
|Author=wmayer, UR_
|Version=00.02
|Date=2019-07-25
|FCVersion=Alle
|Download=[https://wiki.freecad.org/images/9/94/Macro_ExpandTreeItem.svg Werkzeugleisten-Symbol]
}}

<span id="Description"></span>
==Beschreibung==

Erweitert den ausgewählten Baum und alle Unterbäume in der Baumansicht.

Wenn der ausgewählte Baum bereits erweitert ist, werden dieser Baum und alle Unterbäume reduziert.

Wenn keine Auswahl getroffen wurde, werden alle Bäume erweitert.

<div lang="en" dir="ltr" class="mw-content-ltr">
[[File:Collapsed00.gif]]
</div>

<span id="Usage"></span>
==Anwendung==

<div lang="en" dir="ltr" class="mw-content-ltr">
Copy the macro in your macro directory, create your tool bar and launch.
</div>

<span id="Script"></span>
==Skript==

Werkzeugleisten-Symbol .PNG [[File:Macro ExpandTreeItem.png]] und die .SVG [[File:Macro ExpandTreeItem.svg]]

'''Macro_ExpandTreeItem.FCMacro'''

{{MacroCode|code=
# -*- coding: utf-8 -*-
#
# Expands selected tree and all sub trees in the tree view.
# if selected tree is already expanded this tree and all sub trees are collapsed True/False
# if there is no selection all trees are expanded
#
__Title__    = "Macro ExpandTreeItem"
__Author__   = "wmayer, UR_"
__Version__  = "00.02"
__Date__     = "2019-07-25"

import PySide
from PySide import QtGui ,QtCore
from PySide.QtGui import *
from PySide.QtCore import *

def toggleAll(tree, item, collapse):
    if collapse == False:
        tree.expandItem(item)
    elif collapse == True:  
        tree.collapseItem(item)

    for i in range(item.childCount()):
        toggleAll(tree, item.child(i), collapse)

mw = Gui.getMainWindow()
trees = mw.findChildren(QtGui.QTreeWidget)

for tree in trees:
    items = tree.selectedItems()

    try:
        if items == []:
            #tree.selectAll()                          # select all object
            for obj in FreeCAD.ActiveDocument.Objects: # select obj.OutList
                if len(obj.OutList) != 0:
                    Gui.Selection.addSelection(obj)
                    items = tree.selectedItems()
            for item in items:
                toggleAll(tree, item, False)
    except Exception:
        None

    for item in items:
            if item.isExpanded() == True:
                toggleAll(tree, item, True)
        #            print ("collapsing")
            else:
                toggleAll(tree, item, False)
        #            print ("expanding")

}}

<span id="Link"></span>
==Verweis==

[https://forum.freecad.org/viewtopic.php?f=13&t=29406 Objektbaum mit einem Klick komplett aufklappen?]