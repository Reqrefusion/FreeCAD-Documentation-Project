<languages/>

{{Macro/de
|Name=Macro FC Baumansicht
|Icon=Macro_FCTreeView.png
|Description=Makro zum Auflisten aller Objekte im Projekt in einer Liste ohne Hierarchie, Optionen zum Sortieren nach Name, Bezeichnung, Sichtbarkeit, Gruppe, nach Länge, Option zum Suchen nach Name, Bezeichnung ... ohne Groß-/Kleinschreibung oder mit Groß-/Kleinschreibung und Auswahl aller im Makrofenster angezeigten Objekte. <br/> <br/>[https://forum.freecad.org/download/file.php?id=70498 Macro FCTreeView Icon package] unzip the .zip file and copy the icon in your macro directory.
|Author=Mario52
|Download=[https://wiki.freecad.org/images/6/64/Macro_FCTreeView.png Werkzeugleisten-Symbol]
|Version=00.10b
|Date=2025-07-04
|FCVersion=0.18 und tiefer
}}

<span id="Description"></span>
==Beschreibung==

Makro zum Auflisten aller Objekte im Projekt in einer Liste ohne Hierarchie, Optionen zum Sortieren nach Name, Bezeichnung, Sichtbarkeit, Gruppe, nach Länge, Option zum Suchen nach Name, Bezeichnung ... ohne Groß-/Kleinschreibung oder mit Groß-/Kleinschreibung und Auswahl aller im Makrofenster angezeigten Objekte.

{{Codeextralink|https://gist.githubusercontent.com/mario52a/67517ef758ff20005d0a6adcfd8c9190/raw/c3706833f2534272107292de6a183bc6e07447cb/Macro_FCTreeView.FCMacro}}

<span id="Usage"></span>
==Anwendung== 

[[File:FCTreeView.gif|Makro FC Baumansicht]]
{{clear}}

<span id="Section_Window"></span>
===Abschnitt '''Fenster'''===

Der Titel zeigt die Option, die Anzahl und den Typ der angezeigten Objekte an.

*'''O''' = Objekte
*'''N''' = Name
*'''L''' = Bezeichnung
*'''T''' = Gesamtzahl
*'''G''' = Gruppe
*'''S''' = Einzeln
*'''V''' = Sichtbar
*'''H''' = Versteckt
Wenn ein Objekt ausgewählt ist: Die Positionierungsbasis, Drehung und der Schwerpunkt werden angezeigt (sofern verfügbar!).

[[File:Macro FCTreeView 00.png|Symbol für den Namen des Objekts]] Symbol für den Namen des Objekts (die Bildlaufleiste ist blau gefärbt)

[[File:Macro FCTreeView 05.png|Symbol für die Beschriftung des Objekts]] Symbol für die Beschriftung des Objekts (die Bildlaufleiste ist blau gefärbt)

[[File:Macro FCTreeView 01.png|Symbol zur Visualisierung, ob das Objekt sichtbar ist (Mausklick für Versteckt)]] Symbol zur Visualisierung, ob das Objekt sichtbar ist (Mausklick für Versteckt) (die Bildlaufleiste ist grün gefärbt)

[[File:Macro FCTreeView 02.png|Symbol zur Visualisierung, ob das Objekt sichtbar ist (Mausklick für Sichtbar)]] Symbol zur Visualisierung, ob das Objekt versteckt ist (Mausklick für Sichtbar) (die Bildlaufleiste ist rot gefärbt)

[[File:Macro FCTreeView 17.png|Symbol für den Namen, der Objekte (oder eine Ordnergruppe) enthält]] Symbol für den Namen, der Objekte (oder eine Ordnergruppe) enthält

[[File:Macro FCTreeView 03.png|Symbol, das verwendet wird, um das Objekt in einer Gruppe zu kennzeichnen, in der die Anzahl der Objekte in der obersten Gruppe angezeigt wird]] Symbol, das verwendet wird, um das Objekt in einer Gruppe zu kennzeichnen, in der die Anzahl der Objekte in der obersten Gruppe angezeigt wird  (die Bildlaufleiste ist deutlich rot gefärbt)

[[File:Macro FCTreeView 04.png|Symbol zur Anzeige eines einzelnen Objekts (keine Gruppe)]] Symbol zur Anzeige eines einzelnen Objekts (keine Gruppe)

<span id="Section_Sort_by_:"></span>
===Abschnitt '''Sortieren nach:'''===

{{KEY|[[File:Macro FCTreeView 10.png|18px]] Name}} Symbol zum Umschalten/Umkehren der Sortierung der Datenliste nach Name

{{KEY|[[File:Macro FCTreeView 11.png|18px]] Beschriftung}} Symbol zum Umschalten/Umkehren der Sortierung der Datenliste nach Beschriftung

{{KEY|[[File:Macro FCTreeView 12.png|18px]] Visible}} Symbol zum Umschalten/Umkehren der Sortierung der Datenliste nach Sichtbar/Versteckt

{{KEY|[[File:Macro FCTreeView 13.png|18px]] Gruppe}} Symbol zum Umschalten/Umkehren der Sortierung der Datenliste nach Gruppe/Einzelobjekt

{{KEY|[[File:Macro FCTreeView 19.png|18px]] Länge}} Wenn dieses Kontrollkästchen aktiviert ist, wird die Sortierung nach Länge mit der angeklickten Schaltfläche (Name, Bezeichnung ...) erstellt.

<span id="Section_Global"></span>
===Abschnitt '''Global'''===

{{KEY|[[File:Macro FCTreeView 21.png|18px]] Teilen}} flip/flop Name-Liste teilen

{{KEY|[[File:Macro FCTreeView 22.png|18px]] Teilen}} flip/flop Name und Beschriftungs-Liste aufteilen

{{KEY|[[File:Macro FCTreeView 14.png|18px]] Ausklappen}} Datenliste umdrehen/umschalten Zusammenklappen/Ausklappen

{{KEY|[[File:Macro FCTreeView 15.png|18px]] Ausklappen}} Datenliste umdrehen/umklappen Ausklappen/Falten

{{KEY|[[File:Macro FCTreeView 06.png|18px]] Sichtbarkeit}} Flip/Flop Normal/Sichtbarkeit

{{KEY|[[File:Macro FCTreeView 07.png|18px]] Group}} Flip/Flop Normal/Gruppe

{{KEY|[[File:Macro FCTreeView 16.png|18px]] Reload}} Die Daten im Projekt neu laden

{{KEY|[[File:Macro FCTreeView 18.png|18px]] Original}} Nach der Operation in die ursprüngliche Organisation zurückkehren Sichtbarkeit/Ausgeblendet

{{KEY|[[File:Macro FCTreeView 01.png|18px]] All Visible}} Visualisieren Sie, ob das Objekt den Status Sichtbar hat

{{KEY|[[File:Macro FCTreeView 02.png|18px]] All Hidden}} Visualisieren Sie, ob das Objekt den Status Versteckt hat

<span id="Section_Search"></span>
===Abschnitt '''Suche'''===

{{KEY|[[File:Macro FCTreeView 20.png|18px]] Clear}} Suchzeile löschen

<span id="The_radioButton_options_Search:"></span>
====Die RadioButton-Optionen '''Suchen''':====

*'''("NLwc")''' : Sucht nach Name und Beschriftung ohne ('''W'''ithout) die Groß-/Kleinschreibung ('''C'''ase) zu berücksichtigen

*'''("Nsc")''' : Sucht nach Name und berücksichtigt die Groß-/Kleinschreibung ('''S'''ensitive '''C'''ase)

*'''("Lwc")''' : Sucht nach Beschriftung ohne ('''W'''ithout) die Groß-/Kleinschreibung ('''C'''ase) zu berücksichtigen

*'''("NLsc")''' : Sucht nach Name und Beschriftung und berücksichtig die Groß-/Kleinschreibung ('''S'''ensitive '''C'''ase)

*'''("NLwsc")''' : Sucht nach Name und Beschriftung im Wort und berücksichtig die Groß-/Kleinschreibung ('''S'''ensitive '''C'''ase) (gleiche Panelauswahl von FreeCAD)

*'''(Nu)'''  : Suche nach numerischem Wert (Radius, Länge, Winkel ...) siehe Abschnitt „Versionen“

{{KEY|[[File:Macro FCTreeView 23.png|18px]] Select}} Flip/Flop für alle im Fenster angezeigten Objekte

{{KEY|[[File:Macro FCTreeView 24.png|18px]] Unselected}} Flip/Flop Alle Objekte abgewählt

<div lang="en" dir="ltr" class="mw-content-ltr">
{{KEY|[[File:Macro FCTreeView 25.png|18px]] S Sheet}} access in Spreadsheet options
</div>

<span id="The_SpreadSheet_options:"></span>
===Die Tabellen-Optionen:===

[[File:TreeView_SpeadSheet.gif|Macro FCTreeView]]

[[File:Macro FCTreeView 001.png]] 

<div lang="en" dir="ltr" class="mw-content-ltr">
[[File:Macro FCTreeView 002.png]] 
* CheckBox options for select the data to save in spreadsheet
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
{{KEY|[[File:Macro FCTreeView 28.png|18px]] Select}} : Select all checkBox option to save
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
{{KEY|[[File:Macro FCTreeView 29.png|18px]] Select}} : unSelect all checkBox option to save
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
[[File:Macro FCTreeView 003.png]] 
* '''Value''' : alone the value is saved in the cell 
** Ex : 10.00 [[File:Macro FCTreeView 30.png]] 
* '''Val Gr''' : the value and the unit are saved in unique cell
** Ex : 10.00 mm [[File:Macro FCTreeView 31.png]] 
* '''Val Gr Ph''' : the value, the unit and the physic data is saved in unique cell
** Ex : 10.00 mm Length [[File:Macro FCTreeView 32.png]] 
* '''Split''' : if the Split checkBox is checked, the data is cut saved in separate cell 
** Ex : 10.00 | mm | length [[File:Macro FCTreeView 33.png]]
</div> 

<div lang="en" dir="ltr" class="mw-content-ltr">
[[File:Macro FCTreeView 004.png]] 
* Combobox '''mm''' : select the unit length desired. The value is convert in the selected unit. The units length available are:
** km,  hm,  dam,  m,   dm,  cm,  '''mm''',  um,  nm,  pm,  fm,  in,  lk,  ft,  yd,  rd,  ch,  fur,  mi,  lea,  nmi
* Combobox '''gram''' : select the unit weight desired. The value is convert in the selected unit. The units weight available are:
** t,  q,    kg,   hg,   dag,  '''g''',    dg,   cg,   mg,   µg,   ng,   pg,  fg,   gr,   dr,   oz,   oz t,  lb, t lb,   st,   qtr,  cwt,   tonneau fr,    ct   
* Spinbox '''Densite''' : give the density by dm3 of the material used (Default : 1.0000)
* Spinbox '''Round''' : give the round value desired (Default : 3)
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
[[File:Macro FCTreeView 005.png]] 
* Combobox '''Name spreadSheet''' : List the spreadsheet in the document
* Line edit '''Name spreadSheet''' : Display the actual spreadsheet or give the name for the new spreadsheet
</div>

[[File:Macro FCTreeView 006.png]] 

<div lang="en" dir="ltr" class="mw-content-ltr">
{{KEY|[[File:Macro FCTreeView 28.png|18px]] Select}} select all checkbox options
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
{{KEY|[[File:Macro FCTreeView 29.png|18px]] Unselect}} unselected all checkbox options
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
{{KEY|[[File:Macro FCTreeView 27.png|18px]] Save}} save the data in Spreadsheet displayed. if no spreadsheet is active the spreadsheet named '''FCSpreadSheet''' is created
</div>

{{KEY|[[File:Macro FCTreeView 26.png|18px]] Beenden}} Die Spreadsheet-Optionen beenden

<span id="Icons"></span>
===Symbole===

Das Symbol muss in dasselbe Verzeichnis wie das Makro kopiert werden

[https://forum.freecad.org/download/file.php?id=70498 Macro_FCTreeView_Icon]

[[File:Macro FCTreeView 00.png|Icon used for the Name of object]] [[File:Macro FCTreeView 01.png|Icon used for visualise if the object is status Visible (mouse click for Hidden)]] 
[[File:Macro FCTreeView 02.png|Icon used for visualise if the object is status Hidden (mouse click for Visible)]] 
[[File:Macro FCTreeView 03.png|Icon used for inform the object in a group the number objects is displayed in top group]] 
[[File:Macro FCTreeView 04.png|Icon used for displayed the single object (not group)]] 
[[File:Macro FCTreeView 05.png|Icon used for the Label of object]] 
[[File:Macro FCTreeView 06.png|Icon used for flip/flop normal/Visibility]] 
[[File:Macro FCTreeView 07.png|Icon used for flip/flop normal/Group]] 
[[File:Macro FCTreeView 08.png|Icon used for Reverse the data listing (momentarily not used)]] 
[[File:Macro FCTreeView 09.png|Icon used for quit Macro FCTreeView (momentarily not used)]] 
[[File:Macro FCTreeView 10.png|Icon used for flip/flop normal/reverse the data listing sort by Name]] 
[[File:Macro FCTreeView 11.png|Icon used for flip/flop normal/reverse the data listing sort by Label]] 
[[File:Macro FCTreeView 12.png|Icon used for flip/flop normal/reverse the data listing sort by Visibility/Hidden]] 
[[File:Macro FCTreeView 13.png|Icon used for flip/flop normal/reverse the data listing sort by Grout/Single object]] 
[[File:Macro FCTreeView 14.png|Icon used for flip/flop the data listing Fold/Expend]] 
[[File:Macro FCTreeView 15.png|Icon used for flip/flop the data listing Expend/Fold]] 
[[File:Macro FCTreeView 16.png|Icon used for reload the data in the project]] 
[[File:Macro FCTreeView 17.png|Icon used for the Name contains objects (or folder Group)]] 
[[File:Macro FCTreeView 18.png|Icon used for return in original organisation after operation visibility/Hidden]] 
[[File:Macro FCTreeView 19.png|If this check Box is checked the sort is created by length with the button clicked (Name, Label ...)]] 
[[File:Macro FCTreeView 20.png|Icon used for Clear the search line edit]] 
[[File:Macro FCTreeView 21.png|Icon used for flip/flop Split the Name list]] 
[[File:Macro FCTreeView 22.png|Icon used for flip/flop Split the Name and Label list]] 
[[File:Macro FCTreeView 23.png|Icon used for Selected all object(s) displayed in the window]] 
[[File:Macro FCTreeView 24.png|Icon used for Unselected all object(s)]]
[[File:Macro FCTreeView 25.png|Icon used for access in Spreadsheet options]] 
[[File:Macro FCTreeView 26.png|Icon used for quit the Spreadsheet options]] 
[[File:Macro FCTreeView 27.png|Icon used for save the data in Spreadsheet]] 
[[File:Macro FCTreeView 28.png|Icon used for select all checkbox options]] 
[[File:Macro FCTreeView 29.png|Icon used for unselected all checkbox options]] 
[[File:Macro FCTreeView 30.png|Icon used for save the value data in Spreadsheet]] 
[[File:Macro FCTreeView 31.png|Icon used for save the value and Unit data in Spreadsheet]]
[[File:Macro FCTreeView 32.png|Icon used for save the value, Unit and type data in Spreadsheet]]
[[File:Macro FCTreeView 33.png|Icon used for split the value, Unit and type in cell separate in Spreadsheet]]

<span id="Script"></span>
==Skript== 

Um viele Instanzen zu verhindern, hat das Klicken auf die Schaltfläche "ToolBar" einen Flip/Flop-Effekt (ausblenden/anzeigen).

Das Makro befindet sich im rechten Dock. Um es zu ändern, modifiziert man die Wertzeile Nummer 133 '''testing = 0''' (oder ändert es mit der Maus wie ein normales Widget).

Das Werkzeugleisten-Symbol [[File:Macro FCTreeView.png|Macro FCTreeView]]

'''Macro_FCTreeView.FCMacro'''

{{CodeDownload|https://gist.github.com/mario52a/67517ef758ff20005d0a6adcfd8c9190|Macro_FCTreeView.FCMacro}}

<span id="To_do"></span>
==Zu tun==

<strike>Das Makro andocken</strike>

==Version==

ver 0010b (2025-07-04) : Die Schaltfläche "Original" wiederhergestellt 

ver 00.10 (2025-06-04) : Zurück zu PySide und mehr Interaktivität mit der 3D-Ansicht, aber die Schaltfläche "Original" ist jetzt überflüssig.

ver 00.09 (2020-09-24) : Korrigiere das Makro "'''freeze'''" nach dem Aufruf der "'''assembly4 workbench'''". Ich versuche, "'''Class SelObserver'''" zu aktivieren, und es funktioniert?

{{Code|code=
class SelObserver:
    def addSelection(self, document, object, element, position):  # Selection
        global sourisPass
        global listeSorted
        global ui

        None
}}

ver 00.08 (2020-02-25) : Aktualisierung mit Layout 

ver 00.07 (06/05/2018) : Verfahren zum Suchen der zuletzt verwendeten Zelle geändert

ver 00.06 (13/12/2017) : Kleiner Fehler in Zeile 1881 korrigiert "del listeSortedBis[doublon][4:] # supprime le fond inutile" Danke renatorivo

ver 00.05 (27/11/2017) : Eine Tabelle erstellen und viele Optionen für ihn hinzufügen

ver 00.04 (29-09-2017) : Suche nach numerischem Wert hinzufügen (Länge, Radius ...)

untersuchte Werte:

{{Code|code=
global impost                 ; impost = ["Angle","Angle0","Angle1","Angle2","Angle3","ChamferSize","Circumradius","Columns","Degree",
                                          "FilletRadius","FirstAngle","Growth","Height","LastAngle","Length","Length2","MajorRadius",
                                          "MinorRadius","Pitch","Polygon","Radius","Radius1","Radius2","Radius3","Rows","Size","Width",
                                          "X","X1","X2","Xmax","Xmin","X2max","X2min",
                                          "Y","Y1","Y2","Ymax","Ymin","Y2max","Y2min",
                                          "Z","Z1","Z2","Zmax","Zmin","Z2max","Z2min"]
}}

ver 00.03 (23/09/2017) : Suche nach Objekttyp hinzufügen

ver 00.02 (11/09/2017) : Die Einstellung für „Docked“ geändert und verhindert, dass das Klicken auf die Schaltfläche einen Flip-Flop-Effekt (Makro ausblenden/anzeigen) verursacht.

ver 00.01 (08/09/2017) :