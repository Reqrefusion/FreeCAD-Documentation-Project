<languages/>

{{Macro/de
|Name=Skizzen-Beschränkungen aus Kalkulationstabellen
|Icon=Macro_Sketch_Constraint_From_Spreadsheet.svg
|Description=Makro, das mit einem einfachen Klick in die Zelle einer Kalkulationstabelle eine Längen-Beschränkung zu einer Linie, einem Kreis, oder zwischen zwei Punkten, mit einem Alias oder einer Adresse (bspw. C2) hinzufügt. Änderungen an der Kalkulationstabelle ändern die Beschränkung. Das Makro erzeugt die Alias.<br>Wähle eine Linie, zwei Punkte oder eine Beschränkung, klicke auf eine Tabellenzelle und führe das Makro aus. Es können Linien, Punkte am Ende der Line, Punkte, Kreise oder Bögen von Kreisen ausgewählt werden.
|Author=2cv001
|Download=[https://wiki.freecad.org/images/d/dc/Macro_Sketch_Constraint_From_Spreadsheet.svg ToolBar icon]
|Version=02.03
|Date=2025/10/27
|FCVersion=Alle
}}

<span id="Description"></span>
== Beschreibung ==

'''Kontaktiere mich bei Problemen im FreeCAD-Forum.'''

Makro, das mit einem einfachen Klick in die Zelle einer Kalkulationstabelle eine Längen-Beschränkung zu einer Linie, einem Kreis, oder zwischen zwei Punkten, mit einem Alias oder einer Adresse (bspw. C2) hinzufügt. Änderungen an der Kalkulationstabelle ändern die Beschränkung. Das Makro erzeugt die Alias.

Wähle eine Linie, zwei Punkte oder eine Beschränkung, klicke auf eine Tabellenzelle und führe das Makro aus. Es können Linien, Punkte am Ende der Line, Punkte, Kreise oder Bögen von Kreisen ausgewählt werden.

[[File:SketchConstraintFromSpreadsheet1.gif]]

{{Codeextralink|https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro}}

<span id="Usage"></span>
== Anwendung ==

<span id="Automatic_object_creation"></span>
=== Automatische Objekt-Erzeugung ===

Wenn das Makro ausgeführt wird bevor eine Kalkulationstabelle, ein Körper oder eine Skizze erstellt wurde, schlägt das Makro vor eine zu erstellen. Anschließend wird die Skizze im Bearbeitungsmodus und die Kalkulationstabelle geöffnet, so dass sie ausgefüllt werden kann.

[[File:SketchConstraintFromSpreadsheet7.gif]]

<span id="Automatic_alias_creation"></span>
=== Automatische Alias-Erzeugung ===

Es ist nicht verpflichtend, aber besser, Alias in der Kalkulationstabelle zu nutzen. Das Makro kann Alias aus Texten der Zellen erzeugen.<br>
Zwei Modi:
* Manueller Modus, bei dem die Zellen mit dem Alias-Text selbst ausgewählt werden müssen und der Automatikmodus.
* und der Automaktikmodus:

<span id="Automatic_mode"></span>
==== Automatik-Modus ====

Ein automatischer Modus, in dem Alias automatisch unter Verwendung eines durch eine Zelle definierten Textbereichs erstellt wird. Der Bereich umfasst die Zelle und die darunterliegenden Zellen. Diese Texte stimmen mit dem Alias-Namen überein. Der Alias rechts des Textes erzeugt. Die benannte Zelle (hier A3) kann in diesem Dialog geändert werden:

[[File:SketchConstraintFromSpreadsheet2302.png|alt=Alias automatic creation|Alias automatic creation]]

[[File:SketchConstraintFromSpreadsheet2303.png|alt=Alias automatic creation|Alias automatic creation]]
[[File:SketchConstraintFromSpreadsheet2304.gif|alt=Alias automatic creation|Alias automatic creation]]

<span id="Manual_mode"></span>
==== Manueller Modus ====

Um den manuellen Modus zu nutzen, aktiviere die Option "Automatischer Alias".

[[File:SketchConstraintFromSpreadsheet2301.png|alt=Alias creation|Alias creation]]

[[File:SketchConstraintFromSpreadsheet8.gif|alt=Alias creation|Alias creation]]

<span id="Constraints_creation"></span>
=== Beschränkungen erzeugen ===

1) Wähle:
* eine Linie,
* zwei Punkte (Ende einer Linie, Zentrum des Kreises, etc.)
* oder eine Längenbeschränkung.

[[File:SelectPoints.png]]

2) Klicke auf die Zelle einer Kalkulationstabelle, mit oder ohne Alias, die einen numerischen Wert beinhaltet:

[[File:Capture1.png]]

3) Führe das Makro aus.

4) Wähle die gewünschte Art der Beschränkung:

[[File:Choose type of constraint.png]]

Wenn die Zelle einen Alias hat, wird die Längen-Eigenschaft der Beschränkung in etwa zu 'Spreadsheet.Alias'. Andernfalls in etwa zu 'Spreadsheet.D4'.

[[File:If_the_spreadsheet_has_an_alias.png]]

5) Wenn die Beschränkungen einen Konflikt hervorruft und die Option "Konflikterkennung" aktiviert ist, schlägt das Makro vor die neue Beschränkung zu löschen:

[[File:SketchConstraintFromSpreadsheet3.gif]]

Wenn eine bestehende Beschränkung ausgewählt wird, kann der Wert durch den Wert einer Kalkulationstabelle ersetzt werden:

[[File:SketchConstraintFromSpreadsheet2.gif]]
[[File:SketchConstraintFromSpreadsheet4.gif]]

Das Makro kann auch mit externer Geometrie einer anderen Skizze umgehen:

[[File:SketchConstraintFromSpreadsheet9.gif]]

Um die Dinge noch weiter zu verfeinern, wenn z. B. eine Linie eher horizontal als vertikal ist, liegt der Fokus beim Öffnen des Dialogfelds auf der Schaltfläche für die Anwendung einer horizontalen Beschränkung. Wenn die Linie nicht horizontal, sondern vertikal ist, liegt der Fokus auf der Schaltfläche für die vertikalen Beschränkung. Drücke in beiden Fällen einfach die Eingabetaste, wenn die Wahl zufriedenstellend ist.

[[File:SketchConstraintFromSpreadsheet5.gif]]

Das Makro funktioniert auch für Objekteigenschften. Wird z.B. auf die Eigenschaft Length einer Aufpolsterung geklickt und anschließend auf eine Zelle mit dem gewünschten Wert, wird die Eigenschaft Length der Aufpolsterung automatisch angepasst.

[[File:SketchConstraintFromSpreadsheetchangePropertyPad.gif]]

<span id="You_can_use_formulas"></span>
=== Es können Formeln verwendet werden ===

Prinzip: Das Makro transformiert den Alias, bevor es ihn in den Parameter- oder Dimensionsausdruck einfügt. Es ersetzt Schlüsselwörter durch Operationen für alles, was auf die Zeichenfolge {{Incode|f}} (f für Funktion) folgt.

Beispiel für die Verwendung:

[[File:SketchConstraintFromSpreadsheetcformulaMult.gif]]

Wenn der Alias lautet: radius_f__mul_2_plu_1<br>
lautet der Ausdruck:<br>
{{Incode|<<datas>>.radius_f__mul_2_plu_1 '''* 2 + 1'''}}<br>
Wenn man also beispielsweise den Wert 5 in der Zelle hat, nimmt der Parameter oder die Dimension den Wert 5 * 2 + 1 an, was 11 ergibt.

Ein Ausschnitt aus dem Code, der mögliche Operationen und Formeln zeigt:

{{Code|code=
formulaSeparator = '_f_'
dicoFormula = {
    '_div_':'/',
    '_mul_':'*',
    '_plu_':'+',
    '_mor_':'+',
    '_les_':'-',
    '_moi_':'-',
    '_pg_':'(',
    '_lp_':'(',
    '_pd_': ')',
    '_rp_': ')',
}
}}

<span id="Radius_→_diameter"></span>
=== Radius → Durchmesser ===

Wenn {{Incode|_f_}} nicht im Ausdruck enthalten ist und der Ausdruck mit {{Incode|rayon}} oder {{Incode|radius}} beginnt, wird er mit 2 multipliziert, um ihn in einen Durchmesser umzuwandeln.

<span id="Links"></span>
== Verweise ==

* [https://forum.freecad.org/viewtopic.php?t=75972 Diskussion im Forum (Französisch)]
* [https://forum.freecad.org/viewtopic.php?style=5&t=76990 Diskussion im Forum (Englisch)]
* [[Macros_recipes/de|Macrorezepte]]
* [[How_to_install_macros/de|Wie man Makros installiert]]
* [[Customize_Toolbars/de|Anpassung der Werkzeugleisten]]

<span id="Credits"></span>
== Danksagung ==

Vielen Dank an openBrain, mario52 und onekk für ihre Hilfe mit dem Quelltext!<br/>
Danke an Syres für das Testen, die Überprüfungen und Hilfe im Quelltext.<br/>
Danke an Roy043 und David69 für die für die verschiedenen Überprüfungen und Verbesserungen des Wikis.<br/>
Danke an L'ami René für Überprüfungen und Ideen.

<span id="Script"></span>
== Skript ==

Werkzeugleisten-Symbol [[Image:Macro_Sketch_Constraint_From_Spreadsheet.svg]]

=== Code ===


ver 02.03 2025/10/27 by 2cv001 '''Macro_Sketch_Constraint_From_Spreadsheet.FCMacro'''
<span id="Download"></span>
==== Herunterladen ==== 
<br>
{{CodeDownload|https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro| Download latest version of the macro}}