<languages/>

{{Macro/de
|Name=Senkrecht zu Linienzug
|Icon=Macro_Perpendicular_To_Wire.png
|Description=Dieses Makro positioniert ein Objekt senkrecht zu einem ausgewählten Linienzug.
|Author=Mario52
|Version=00.03
|Date=2020-03-31
|FCVersion=Alle
|Download=[https://wiki.freecad.org/images/0/0c/Macro_Perpendicular_To_Wire.png Werkzeugleisten-Symbol].
}}

<span id="Description"></span>
==Beschreibung==

Dieses Makro positioniert ein Objekt senkrecht zum ausgewählten Linienzug.

<span id="Usage"></span>
==Anwendung== 

# Das Makro mit dem  [[Image:Std_AddonMgr.svg|24px|link=Std_AddonMgr]] [[Std_AddonMgr/de|Addon-Manager]] installieren
# Den Pfad auswählen (kann ein Element oder Unterelement sein)
# Das Objekt zum Ausrichten auswählen
# Das Makro ausführen

<span id="Script"></span>
==Skript==

Das Werkzeugleisten-Symbol: [[File:Macro Perpendicular To Wire.png|32px]]

'''Macro Perpendicular To Wire.FCMacro'''

{{MacroCode|code=
# -*- coding: utf-8 -*-
__title__   = "Macro Perpendicular To Wire"
__author__  = "Mario52"
__url__     = "https://wiki.freecad.org/Macro_Perpendicular_To_Wire"
__version__ = "00.03"
__date__    = "31/03/2020"

import Draft, Part

try:
    sel = FreeCADGui.Selection.getSelection()                               # Select an object
    
    lineSelected = FreeCADGui.Selection.getSelectionEx()[0].SubObjects[0]   # first object the Path object or SubObjects
    myCircle     = sel[1]                                                   # second object
    
    pointsDirection  = []
    
    pointsDirection = lineSelected.discretize(Number=500)                   # discretize the path line first selection
    
    v=pointsDirection[0].sub(pointsDirection[1])                            # avec vecteurs 1 et 2 (direction debut ligne)
    r=App.Rotation(App.Vector(0,0,1),v)
    
    pl=FreeCAD.Placement()                                                  # placement object
    pl.Rotation.Q = r.Q
    pl.Base = pointsDirection[0]
    myCircle.Placement = pl
    
    del pointsDirection[:]
    FreeCAD.ActiveDocument.recompute()
except Exception:
    print( "Select two objects. 1:The path 2:The object to align" )

}}

<span id="Options"></span>
==Optionen==

Im Wesentlichen wird die Linie mit {{incode|discretize()}} in x Punkte unterteilt (für unsere Zwecke verwenden wir standardmäßig {{incode|Number&#61;500}}, aber die Unterteilung kann zwischen  0 und 499 geändert werden)

{{Code|code=
    pointsDirection = lineSelected.Shape.discretize(Number=500)             # discretize the path line first selection
}}

1. Die Rechtwinkligkeit wird zwischen zwei Punkten berechnet:

{{Code|code=
v=pointsDirection[0].sub(pointsDirection[1])          # perpendicular of first > second point
}}

:[[File:Macro Perpendicular To Wire 01.png]]

2:

{{Code|code=
v=pointsDirection[-1].sub(pointsDirection[-2])       # perpendicular of last > before last point
pl.Base = pointsDirection[-1]                        # position base last point
}}

:[[File:Macro Perpendicular To Wire 02.png]]

3:

{{Code|code=
v=pointsDirection[100].sub(pointsDirection[101])   # perpendicular of point 100 > point 101
pl.Base = pointsDirection[100]                     # position base point 100
}}

:[[File:Macro Perpendicular To Wire 03.png]]

4:

{{Code|code=
v=pointsDirection[0].sub(pointsDirection[-1])         # perpendicular of first point > last point
pl.Base = pointsDirection[0]                          # position base first point
}}

:[[File:Macro Perpendicular To Wire 04.png]]

Weitere Parameter für {{incode|discretize()}} sind wie folgt:

{{Code|code=
# Discretizes the edge and returns a list of points.
# Forum thread: https://forum.freecad.org/viewtopic.php?f=12&t=16336#p129468
# The function accepts keywords as argument:
# discretize(Number=n) => gives a list of 'n' equidistant points
# discretize(QuasiNumber=n) => gives a list of 'n' quasi equidistant points (is faster than the method above)
# discretize(Distance=d) => gives a list of equidistant points with distance 'd'
# discretize(Deflection=d) => gives a list of points with a maximum deflection 'd' to the edge
# discretize(QuasiDeflection=d) => gives a list of points with a maximum deflection 'd' to the edge (faster)
# discretize(Angular=a,Curvature=c,[Minimum=m]) => gives a list of points with an angular deflection of 'a'
# and a curvature deflection of 'c'. Optionally a minimum number of points
# can be set which by default is set to 2.
}}

<span id="Example"></span>
==Beispiel==

[[File:Macro Perpendicular To Wire 05.gif]]

[[File:Macro Perpendicular To Wire.gif]]

<span id="Discussions"></span>
==Diskussionen==

* [[https://forum.freecad.org/viewtopic.php?f=13&t=19899&start=20 Spiralbohrer]] Diskussion im FreeCAD-Forum.
* https://forum.freecad.org/viewtopic.php?f=12&t=16336#p129468

==Version==

Ver 00.03 2020-03-21: Quelle und Kommentar Tippfehlerkorrekturen
Ver 00.02 2019-04-06: Python 3