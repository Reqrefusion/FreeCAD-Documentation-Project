<languages/>

{{TutorialInfo/de
|Topic=Tutorial Natives-IFC
|Level=Fortgeschrittene/Könner
|Time=60 Minuten
|Author=yorik
|FCVersion=1.0
|Files=
}}

<span id="FreeCAD_and_native_IFC_tutorial"></span>
== Tutorial FreeCAD und Natives-IFC ==

[[Image:Nativeifc-tutorial-01.jpg]]

[https://freecad.org FreeCAD], eine freie und quelloffene (FOSS) 3D-CAD-Modellierungsplattform, die seit vielen Jahren mit dem Arbeitsbereich Arch [https://de.wikipedia.org/wiki/Building_Information_Modeling BIM]-Werkzeuge anbietet. Ab Version 1.0, die im November 2024 veröffentlicht wurde, wurden die Arch-Werkzeuge erweitert und in den [[BIM_Workbench/de| Arbeitsbereich]] umbenannt sowie um ein neues natives IFC-System erweitert. Dieses Tutorial führt durch die verschiedenen Konzepte, die in nativem IFC verwendet werden, und zeigt anhand eines Beispielmodells, wie diese angewendet werden können.

<span id="The_IFC_format"></span>
===Das IFC-Format===

Man kann nicht über natives IFC sprechen, ohne zuvor etwas über die [https://de.wikipedia.org/wiki/Industry_Foundation_Classes Industry Foundation Classes], besser bekannt als IFC, zu sagen. IFC ist ein Dateiformat, aber auch und vor allem ein Datenformat. Es handelt sich um einen Standard (eine registrierte ISO-Norm (19650)), der festlegt, wie die verschiedenen Komponenten eines Gebäudes digital dargestellt werden sollen, welche Eigenschaften jede von ihnen haben soll, welche Beziehungen sie zu anderen Elementen haben kann oder haben soll usw. Kurz gesagt, es ist eine Anleitung zur digitalen Beschreibung eines Gebäudes.

Das IFC-Format hat viele interessante Eigenschaften. Zunächst einmal ist es offen und öffentlich (es wird wie das HTML-Format von einem Konsortium gepflegt), es leitet sich vom STEP-Format ab, einem bekannten, äußerst stabilen 3D-Geometrieformat, das in der Maschinenbauindustrie weit verbreitet ist, es ist für Menschen lesbar (es kann mit einem Texteditor geöffnet werden) und die Daten können nicht nur in einem, sondern in mehreren Dateiformaten geschrieben und sogar als Datenbank verwendet werden.

Diese Eigenschaften machen das Format dank seines STEP-(Ur-)Vaters geometrisch zuverlässig, aber auch zu einer sehr klugen Wahl, um die Daten anzuvertrauen, denn auch in 50 Jahren wird man noch in der Lage sein, IFC-Dateien zu öffnen und die Daten wiederherzustellen, selbst wenn die BIM-Anwendung nicht mehr existiert. IFC-Dateien werden auch zunehmend zum bevorzugten Dateiformat, das von Behörden bei der Erteilung von Baugenehmigungen verlangt wird.

Bislang wurde das IFC-Format jedoch hauptsächlich als ''Exportformat'' verwendet. Designer speicherten ihre Projekte weiterhin im nativen Dateiformat ihrer BIM-Anwendung und exportierten IFC-Dateien bei Bedarf. Das ist gut genug, um die Arbeit zu präsentieren, aber ziemlich schlecht, wenn andere Personen ebenfalls mit diesem Modell arbeiten müssen, da es zu erheblichen Datenverlusten kommt und die Daten bei jedem Export vollständig neu geschrieben werden, sodass die Verwendung einer neuen Version des Modells für andere Personen oft Kopfzerbrechen bereitet.

Mit nativem IFC wollen wir das ändern.

<span id="The_native_IFC_concept"></span>
===Das Konzept natives IFC===

Die Idee stammt aus einem [https://github.com/brunopostle/ifcmerge/blob/main/docs/whitepaper.rst Artikel von Bruno Postle], in dem beschrieben wird, wie das IFC-Format nicht nur als Exportformat, sondern auch als Hauptprojektdatei anstelle der (in der Regel proprietären) Formate verwendet werden könnte, die von BIM-Anwendungen verwendet werden. Um dies zu erreichen, ist es unerlässlich, dass BIM-Anwendungen das IFC-Format nativ verarbeiten, d. h. anstatt ihre eigenen Inhalte jedes Mal aus ihrem internen Format in IFC zu konvertieren, sollten sie IFC-Daten direkt bearbeiten.

[[Image:Nativeifc-tutorial-02.jpg]]

{{Caption|Bild aus Bruno Postles Artikel}}

Konkret bedeutet dies, dass man in FreeCAD IFC-Modelle öffnen oder erstellen kann, sie untersuchen, ihren Inhalt ändern können und jede Änderung klar registriert, auffindbar, identifizierbar und rückgängig zu machen ist. Änderungen, die andere während der Arbeit vorgenommen haben, können zusammengeführt werden, selbst wenn diese mit anderen (nativen IFC-)Anwendungen arbeiten.

[[Image:Nativeifc-tutorial-03.jpg]]

{{Caption|Das Bild oben zeigt eine kompakte und begrenzte Änderung an einer Datei beim Hinzufügen einer neuen Wand.}}

Die Arbeit an nativem IFC in FreeCAD ist noch nicht abgeschlossen, aber es ist bereits vollständig für 'echte Arbeit' einsetzbar. Wenn man bereits mit den BIM-Werkzeugen von FreeCAD vertraut ist, gibt es nur sehr wenig Neues zu lernen, da der Großteil des Arbeitsablaufs dieselben Werkzeuge verwendet.

<span id="Do_I_need_IFC?"></span>
=== Brauche ich IFC? ===

Die Entscheidung liegt bei Ihnen. IFC ist ein strenges Format, bei dem jedes Element (eine Wand, ein Stockwerk, ein Fenster) sehr strenge Attribute und Merkmale hat, die nicht geändert werden können. Diese Standardisierung gewährleistet seine Kompatibilität und Zuverlässigkeit. Das bedeutet auch, dass man mit IFC nicht "machen kann, was man will". Man muss sich an die Vorgaben des Formats halten. Das ist bei der Zusammenarbeit mit anderen sehr willkommen und hervorragend, denn genau das erwarten wir von einem "Standard". Es gibt Garantien dafür, was man beim Öffnen einer IFC-Datei vorfindet, aber dies kann natürlich auch die Kreativität einschränken.

Eines der Grundprinzipien des Arbeitsbereichs BIM in FreeCAD ist es, der Kreativität keine Grenzen zu setzen. Alles ist möglich, jede geometrische Form ist möglich, jede parametrische Beziehung ist möglich. Wenn man mit dem Arbeitsbereichs BIM ohne natives IFC arbeitet, steht diese Freiheit zur Verfügung. Wenn man natives IFC aktiviert, wird diese Freiheit eingeschränkt. Ist das gut oder schlecht für das Projekt? Das hängt davon ab.

Ich persönlich würde empfehlen, ohne IFC zu arbeiten, wenn man alleine arbeitet und noch Konzepte entwickelt, damit man von maximaler Freiheit profitiert. Wenn sich das Projekt stabilisiert hat und andere Personen hinzukommen, könnte dies der richtige Zeitpunkt sein, um auf natives IFC umzusteigen, um von der Standardisierung zu profitieren. Daran denken, dass man jederzeit wechseln oder sogar ein nicht-natives IFC-Projekt jederzeit nach IFC exportieren kann. Es ist selten notwendig, sofort mit nativem IFC zu beginnen.

<span id="Opening_and_creating_IFC_models"></span>
== Öffnen und Erstellen von IFC-Modellen ==

<span id="Finding_and_viewing_IFC_models"></span>
=== IFC-Modelle Finden und Anschauen ===

Wenn man noch nie mit IFC gearbeitet habt, sollte man sich zunächst einige Beispielmodelle genauer ansehen. Da es sich um ein offenes Format handelt, sind Beispielmodelle glücklicherweise sehr leicht im Internet zu finden. Eine einfache Suche nach "Beispiel-IFC-Modellen" wird weiterhelfen. Ich würde zum Beispiel dieses [https://github.com/buildingSMART/Sample-Test-Files/tree/main/PCERT-Sample-Scene/IFC%204.0.2.1%20(IFC%204) kanonische Beispielhaus] empfehlen, das vom IFC-Konsortium bereitgestellt wird, aber auch mehrere andere Websiten haben Sammlungen von Beispieldateien zusammengestellt, wie zum Beispiel [https://bimplot.com/ free-ifc-project-samples-for-architects-and-bim-enthusists/ dieses auf BIMPlot].

[[Image:Nativeifc-tutorial-04.jpg]]

Es gibt viele Anwendungen zum Anzeigen von IFC-Dateien. Einige sind kostenlos, andere sogar frei und quelloffen (FOSS). Unter den proprietären, aber kostenlosen IFC-Betrachtern sind [https://bimvision.eu/ BIMVision] oder der [https://openifcviewer.com/ ODA IFC Viewer] (läuft unter Win/Mac/Linux) empfehlenswert. Unter den FOSS-Betrachtern verwende ich häufig den einfachen [http://www.ifcquery.com/ IFC++], der in den Debian/Ubuntu-Repositorys enthalten ist. Sowohl [https://freecad.org FreeCAD] als auch [https://bonsaibim.org Bonsai] sind ebenfalls gute und schnelle IFC-Betrachter.

Die Möglichkeit, IFC-Dateien in einer anderen Anwendung zu öffnen und anzuzeigen, ist bei der Arbeit mit IFC-Dateien von grundlegender Bedeutung, da man so überprüfen kann, ob die Dateien, die an den Kollegen oder Kunden gesendet werden, alle erforderlichen Informationen enthalten.

<span id="What_makes_a_good_IFC_model"></span>
=== Was ein gutes IFC-Modell ausmacht ===

Das IFC-Format ist komplex, und BIM-Anwendungen, selbst die teuersten kommerziellen, sind bekanntermaßen schlecht oder sehr schlecht im Umgang mit IFC-Dateien. Daher können Erfahrungen variieren: Die IFC-Dateien, auf die ma stößt, können von sehr schlechter Qualität und voller Datenmüll sein, manchmal sogar so sehr, dass sie kaum noch zu verwenden sind. Dies wurde oft von Befürwortern proprietärer BIM-Anwendungen genutzt, um das IFC-Format zu diskreditieren und seine Ineffizienz zu demonstrieren.

Es ist jedoch nicht schwer, hochwertige IFC-Modelle zu erstellen. Man benötigt jedoch eine Anwendung, die das Format ernst nimmt und dem Benutzer die Kontrolle darüber lässt, was und wie exportiert wird.

Es gibt nur wenige Dinge, die man wissen sollte:

<div lang="en" dir="ltr" class="mw-content-ltr">
<ul>
<li><p>As inherited from the STEP format, an IFC file is '''a text file''', where each line represents an element, and starts with an ID number. For example:</p>
<pre>#66=IFCWALL('3JmWkr',$,'MyWall',$,$,(#71),$,$,$,.SOLIDWALL.);</pre>
<p>The above line defines an element of class '''IfcWall''', with ID 66. the things inside the parentheses are its attributes. More about attributes below.</p>
<p>The important piece is the '''class''' (as in 'Industry Foundation Classes'). Each element has a class, that defines the type of element: A wall, a window, but also a floor, a space, or even a line, a circle, a point in the 3D space or even concepts like a moment in time, or a task to do. Most useful IFC classes for building elements are derived from the [https://standards.buildingsmart.org/IFC/RELEASE/IFC4_1/FINAL/HTML/schema/ifcproductextension/lexical/ifcbuildingelement.htm IfcBuildingElement] class.</p></li>
<li><p>IFC models usually follow a '''strict structure''': In each file there should be one and only one '''IfcProject'''. The [https://ifc43-docs.standards.buildingsmart.org/IFC/RELEASE/IFC4x3/HTML/lexical/IfcProject.htm IfcProject] is the root of all objects inside an IFC model. Under the IfcProject, there is usually at least one '''IfcSite''', that can contain one or more '''IfcBuildings''', which in turn are divided in '''IfcBuildingStoreys'''. These can be further divided into '''IfcZones''' and '''IfcSpaces'''.</p></li>
<li><p>Building elements, such as '''IfcWalls''' or '''IfcWindows''' are then '''related''' to one of the structures above, usually an IfcBuildingStorey, but they can also be related to another building element, so one element can be composed of several others. These relations are always explicitly stated in the IFC files, they are never automatic or implicit.</p></li>
<li><p>IFC elements, be they building elements such as walls or windows, or structure elements such as sites and storeys, or any of the many other [https://ifc43-docs.standards.buildingsmart.org/IFC/RELEASE/IFC4x3/HTML/annex-b1.html element classes] offered by the IFC format, all have a predefined set of '''attributes'''. Attributes are things like name, position in space, or unique ID number, that are defined in the format. All entities of the same class must have the same attributes. Elements can also have '''properties'''. Contrary to attributes, properties are not defined by the IFC format, and can be defined freely by the user (or the BIM application). Think of them as custom attributes. The IFC format also proposes default sets of properties for many element classes. For example, for beams, there is a set called [https://ifc43-docs.standards.buildingsmart.org/IFC/RELEASE/IFC4x3/HTML/lexical/Pset_BeamCommon.htm BimCommon] that holds a series of properties that are typical for beams.</p></li>
<li><p>The '''geometry''' of IFC elements is defined in separate elements, that are attached to each wall, window, door, etc. It can also be shared by several elements. There are many, many ways to define geometry, and that's where many problems begin. Building elements can have both a 3D geometry and a 2D geometry (for example a plan view or footprint), and also for example a linear geometry (that is useful for stability studies). Good geometry is usually well-defined and sensibly constructed. For example, the geometry of a simple wall would be defined by a rectangle on the ground, with width and length, that is then extruded vertically by a given height to produce the wall shape. This is 3 lines in the IFC file: The rectangle, the extrusion, and the position of the final object. It is recognizable by other BIM applications, and the parameters can be changed, for example the width of the base rectangle.</p></li>
<li><p>In some IFC files you might receive, this logical information might be completely lost, and the wall geometry defined as a bunch of triangular facets. This is often the cases with files that have been converted to IFC from another format. There might be further problems such as incomplete relationships, etc. Suffices to say, the IFC format allows for a huge range of ways to define geometry, from the 'dumbest' ones (triangular facets) to the 'smartest' ones (NURBS-based objects), with a big focus on well-defined solids (such as our extruded rectangle). Fortunately for us, that is FreeCAD's specialty.</p></li></ul>
</div>

<span id="Opening,_creating_and_converting_IFC_models"></span>
=== Öffnen, Erzeugen und Konvertieren von IFC-Modellen ===

In FreeCAD werden IFC-Dateien wie alle anderen Dateien über das Menü '''Datei → Öffnen''' geöffnet. Standardmäßig werden IFC-Dateien so geladen, dass nur ein Element in der '''Baumansicht''' angezeigt wird. Dies ist die schnellste Importmethode, mit der ein 100-MB-Modell in der Regel innerhalb von Sekunden importiert werden kann.

[[Image:Nativeifc-tutorial-05.jpg]]

Die Einstellungen für den nativen IFC-Import können unter '''Bearbeiten → Einstellungen → BIM → Natives IFC''' geändert werden.  Beispielsweise kann festgelegt werden, dass beim Import die gesamte Gebäudestruktur angezeigt wird oder dass man jedes Mal gefragt wird.

Um ein neues IFC-Modell zu erstellen, erstellt man zunächst ein neues IFC-Projekt im Menü '''3D/BIM'''.

Die Konvertierung eines Nicht-IFC-FreeCAD-Modells in natives IFC kann einfach durch Exportieren nach IFC erfolgen, entweder über das Menü '''Datei → Exportieren''' oder über die Schaltfläche mit dem Schloss (mehr dazu weiter unten).


<span id="Exploring_the_model"></span>
== Das Modell erkunden ==

<span id="Expanding_model_contents"></span>
=== Erweiterung der Modellinhalte ===

Standardmäßig wird beim Öffnen von IFC-Dateien nur das erste, äußere Element der Datei angezeigt. In der Regel ist dies IfcSite. Um den Inhalt dieses Elements und der nachfolgenden Elemente anzuzeigen, muss es '''erweitert''' werden. Das Erweitern erfolgt durch einen Doppelklick auf das Element in der Baumansicht oder alternativ über die Menüoption „Werkzeuge → IFC-erweitern”. Dieser Befehl kann angepasst und mit einer Tastenkombination belegt werden, sodass mit den Pfeiltasten in der Baumansicht navigiert werden und das Modell bei Bedarf vollständig über die Tastatur erweitert werden kann.

[[Image:Nativeifc-tutorial-06.jpg]]

Durch Doppelklicken auf ein Element in der Baumansicht werden beim ersten Mal dessen untergeordnete Elemente angezeigt, beim zweiten Mal oder wenn keine weiteren untergeordneten Elemente mehr vorhanden sind, '''werden dessen vollständige Eigenschaften, Material und Form geladen'''.

Dadurch kann ein Modell so schnell wie möglich geladen und Elemente nach Bedarf erweitert/definiert werden. Dieses Verhalten kann unter '''Bearbeiten → Einstellungen → BIM → Natives IFC''' geändert werden.

<span id="Locking_and_unlocking"></span>
=== Sperren und Entsperren ===

Wenn ein IFC-Modell in FreeCAD geladen wird, kann es gesperrt oder entsperrt werden. Standardmäßig werden IFC-Dateien beim Öffnen gesperrt, während sie beim Importieren (über '''Datei → Importieren''') entsperrt bleiben.

Das Sperren oder Entsperren erfolgt ganz einfach über die Sperrtaste in der FreeCAD-Statusleiste:

[[Image:Nativeifc-tutorial-07.jpg]]

<div lang="en" dir="ltr" class="mw-content-ltr">
* '''Locked mode''' means that the FreeCAD document IS the IFC file. You don't see the IfcProject (it is the FreeCAD document itself in the Tree view), and anything you do in that document is automatically, transparently and immediately done in the IFC data itself. Adding a wall will modify the IFC file, as well as adding a line or a dimension, everything is done in IFC. you cannot have any FreeCAD element in the document that is not part of the IFC file. You can convert any FreeCAD model (BIM or not) to IFC by clicking the lock button.
* '''Unlocked mode''', also called hybrid mode, means the IFC project resides inside a '''project''' object. You can still have normal, non-IFC FreeCAD objects besides the IFC elements. To add an element to the IFC project, you must add it yourself to it by dragging it onto the project or one of the sub-elements of the project. You can create a new, blank IFC project using menu '''3D/BIM → Project'''.
* '''Working with no IFC project at all''': Remember you don't need to create an IFC project to start a BIM project (that can be done anytime later if needed). You can simply start building walls, adding floors and roofs, without defining an IFC structure or even caring about IFC.
</div>

Der gesperrte Modus bedeutet vorsichtiger Modus: Wenn man eine Datei von jemand anderem öffnet, möchte man nichts beschädigen, sondern die Datei erkunden und vielleicht etwas korrigieren oder ein paar lokale Änderungen vornehmen. Man möchte sicherstellen, dass die von einem vorgenommenen Änderungen genau lokalisiert und nachvollziehbar sind.

In allen anderen Fällen gibt es keinen wirklichen Grund oder Vorteil, das Modell zu sperren. Man kann sogar das Standardverhalten so ändern, dass IFC-Modelle ungesperrt geöffnet werden, wenn man dies bevorzugt. Dazu auf '''Bearbeiten → Einstellungen → BIM → Natives IFC''' gehen.

Wenn man zu einem IFC-Modell wechselt, möchte man häufig überprüfen, was sich seit dem letzten Speichern in den IFC-Daten geändert hat. Dies geschieht über '''Werkzeuge → IFC Diff'''. Die Änderungen werden im [https://de.wikipedia.org/wiki/Diff Diff-Format] dargestellt, wobei die Abschnitte rot und grün hervorgehoben sind. Dieses Format ist auch für Computersysteme wie Git verständlich, die große Änderungssätze verfolgen können und somit die IFC-Dateien unter solchen Systemen zu vollwertigen Bestandteilen machen.

[[Image:Nativeifc-tutorial-08.jpg]]

<span id="Model_structure"></span>
=== Modellstruktur ===

Wie oben zu sehen ist, verwenden die meisten IFC-Dateien eine Standardstruktur '''Standort → Gebäude → Stockwerk'''. Diese Struktur ist so verbreitet, dass sie oft als obligatorisch angesehen wird, obwohl sie im IFC-Standard nicht ausdrücklich festgelegt ist. Man könnte durchaus alle Elemente direkt mit dem IfcProject verknüpfen. Da Standardisierung jedoch nur funktioniert, wenn sich alle für dasselbe System entscheiden, ist es ratsam, mindestens einen Standort, ein Gebäude und ein Stockwerk (in FreeCAD als '''Level''' bezeichnet) im Modell zu haben.

[[Image:Nativeifc-tutorial-09.jpg]]

In FreeCAD kann man mit Hilfe von '''Gruppen''' die Objekte auf einer Ebene weiter organisieren. Beispielsweise könnte man im Erdgeschoss eine Gruppe 'Wände' erstellen, um alle Wände hinzuzufügen, eine Gruppe 'Zimmermannsarbeiten', um Holzbalken hinzuzufügen usw. Gruppen werden von IFC unterstützt, jedoch ist es nicht üblich, Gruppen innerhalb eines Gebäudestrukturelements wie einem Stockwerk zu platzieren. Aus diesem Grund werden Gruppen standardmäßig als '''IfcBuildingElementAssemblies''' statt als IfcGroups geschrieben. Bei FreeCAD sind wir jedoch der Meinung, dass ein solches Verhalten nützlich ist und erlaubt sein sollte. Daher gibt es eine Einstellungsoption, um dies zu ermöglichen. Die meisten BIM-Anwendungen öffnen problemlos Dateien mit Gruppen innerhalb anderer Elemente. Diese Einstellungsoption soll dazu beitragen, unsere Vision zu verbreiten und möglicherweise andere davon zu überzeugen.

Also, legen wir los und beginnen wir damit, unser Modell zu zerlegen...

<span id="Adding_and_modifying_elements"></span>
== Elemente hinzufügen und ändern ==

<span id="Modifying_attributes_and_properties"></span>
=== Attribute und Eigenschaften modifizieren ===

Sobald wir ein Modell geöffnet haben, können wir mit der Bearbeitung seines Inhalts beginnen. Es ist zu beachten, dass es zum Zeitpunkt der Erstellung dieses Tutorials noch keinen grafischen Geometrie-Editor für IFC-Elemente gibt (dies ist jedoch in Planung und sollte bald verfügbar sein). Die Geometrie von Elementen kann durch Bearbeiten ihrer geometrischen Eigenschaften geändert werden.

Wenn IFC-Elemente aus der Datei geladen werden, werden ihre Attribute in der [[Property_editor/de|Eigenschaften-Ansicht]] unter der Gruppe '''IFC''' angezeigt. Dort können Dinge wie Name, Beschreibung oder sogar die Klasse der Elemente geändert werden.

Wenn man auf ein Element in der Baumansicht doppelklickt, werden zunächst die untergeordneten Elemente dieses Elements angezeigt. Wenn man ein zweites Mal darauf doppelklickt, werden zusätzliche Daten wie '''Eigenschaftssätze''', '''benutzerdefinierte Eigenschaften''', '''Materialien''' und '''Formdaten''' geladen. Außerdem wird ein Satz von '''Geometrieeigenschaften''' erstellt, mit denen man die Geometrie dieses Elements ändern kann. Diese Geometrieeigenschaften bilden auch die Grundlage für den zukünftigen grafischen Editor.

[[Image:Nativeifc-tutorial-10.jpg]]

Alle diese zusätzlichen Eigenschaften können direkt geändert werden, und neue benutzerdefinierte Eigenschaften können über die beiden Schaltflächen unter dem Eigenschafteneditor hinzugefügt werden.

<span id="Modifying_geometry"></span>
=== Geometrie ändern ===

Die Position jedes Elements kann geändert werden, indem dessen '''Placement'''-Eigenschaft geändert wird (oder die Werkzeuge  [[Draft_Move/de|Bewegen]] oder [[Draft_Rotate/de| Drehen]] genutzt werden).

Um die Geometrie, beispielsweise die Breite einer Wand, zu ändern, muss zunächst zweimal doppelgeklickt werden, um die '''Geometrieeigenschaften''' anzuzeigen. Wenn diese Wand auf die übliche Weise als extrudiertes Rechteck konstruiert wurde, werden unter diesen Eigenschaften die Breite und Länge des Rechtecks sowie die Extrusionshöhe angezeigt.

Natürlich hängt alles davon ab, wie die Wand in der IFC-Datei definiert wurde. Möglicherweise handelt es sich nicht um ein extrudiertes Rechteck. In diesem Fall sind möglicherweise weniger oder andere Geometrieeigenschaften verfügbar.

<span id="Adding_new_BIM_objects"></span>
=== Hinzufügen neuer BIM-Objekte ===

Wie man neue Objekte hinzufügt, hängt vom aktuellen Modus ab: gesperrt oder entsperrt. Im gesperrten Modus wird alles, was man zeichnet, z. B. eine Wand oder eine Säule, automatisch in der IFC-Datei selbst erstellt. Möglicherweise muss man es nach der Erstellung unter die richtige Ebene oder das richtige Gebäude verschieben. Dazu zieht man die neue Wand einfach in der Baumansicht unter die richtige Ebene.

Im entsperrten Modus ist die neue Wand noch kein IFC-Element. Man muss die Wand nach der Erstellung immer selbst an die richtige Stelle ziehen.

<span id="Types"></span>
=== Typen ===

In IFC kann jedes Element durch einen [https://standards.buildingsmart.org/IFC/RELEASE/IFC4_1/FINAL/HTML/schema/ifckernel/lexical/ifctypeproduct.htm-Typ] definiert werden. Ein Typ (z. B. IfcWallType, IfcWindowType) ist ein IFC-Element, das gemeinsame Merkmale, Eigenschaften oder sogar Geometrien enthalten kann, die automatisch von allen Objekten dieses Typs verwendet werden. In einigen BIM-Anwendungen wird dies manchmal als Familien bezeichnet.

In FreeCAD haben wir dies in Nicht-IFC-BIM-Projekten bisher mithilfe von Klonen durchgeführt. In nativem IFC werden Typen vollständig unterstützt. Um einen Typ zu definieren, erstellt man am einfachsten ein Objekt der gewünschten Klasse, beispielsweise eine Wand, klickt dann mit der rechten Maustaste in der Baumansicht darauf und wählt '''IFC → In Typ konvertieren'''.

Wenn ein Objekt in einen Typ konvertiert wird, wird es in eine spezielle Gruppe '''Typen''' unter dem Projekt verschoben. Es kann dann von jeder anderen Wand im Projekt referenziert werden.

[[Image:Nativeifc-tutorial-11.jpg]]

{{Caption|Das obige Bild zeigt unsere Wand, die jetzt den Typ 'My Wall Type' verwendet.}}

<span id="Adding_downloadable_contents"></span>
=== Hinzufügen von herunterladbaren Inhalten ===

In einem BIM-Projekt müssen häufig herunterladbare Inhalte hinzugefügt werden, wie beispielsweise Möbelstücke, Geräte oder Elemente wie vorgefertigte Fensterrahmen. Diese Elemente werden in der Regel von den Websites der Hersteller oder von BIM-Bibliotheks-Websites heruntergeladen.

In all diesen Fällen sind die Qualität und das Format der Elemente, die man herunterlädt, von Bedeutung. Man sollte (in dieser Reihenfolge) darauf achten, ein von FreeCAD gut unterstütztes Dateiformat zu verwenden, um Modelle mit guter geometrischer Qualität und ausreichenden Metadaten (Farbe, Materialien, Herstellerinformationen usw.) zu erhalten. Einige gute Ideen sind:

* STEP-Dateien von [https://grabcad.com/library?page=1&time=this_month&sort=popular&softwares=step-slash-iges GrabCAD]: STEP-Dateien werden von FreeCAD sehr gut unterstützt und enthalten in der Regel immer hochwertige Geometrien, da es sich um ein beliebtes Format im Ingenieurwesen handelt. Sie lassen sich in der Regel auch sehr gut in IFC konvertieren.
* IFC-Dateien aus Modellbibliotheken wie [https://bimobject.com BIMObject]: Die Verwendung des IFC-Formats mag zwar interessant klingen, jedoch werden die auf diesen Webseiten zur Verfügung gestellten IFC-Dateien oft automatisch aus anderen (proprietären) Formaten konvertiert, wodurch die Qualität sehr gering sein kann.
* Modelle aus BIM-eigenen Anwendungen wie Revit oder ArchiCAD in das SAT-Format exportieren und diese in FreeCAD mit dem Addon [https://github.com/jmplonka/InventorLoader Inventor Loader] (installierbar über den [[Std_AddonMgr/de|Addon-Manager]]) öffnen. Diese Anwendungen ermöglichen zwar den Export von Teilen und Elementen nach IFC, jedoch kommt es dabei häufig zu einer Verschlechterung der Geometrie. Der Export von Typen und Familien in das SAT-Format liefert oft eine ähnliche Qualität wie STEP-Dateien. Der Inventor Loader befindet sich jedoch noch in der Entwicklung und funktioniert möglicherweise nicht mit jeder Datei.

<span id="Saving_and_handling_files"></span>
=== Speichern und Bearbeiten von Dateien ===

Eine FreeCAD-Datei, die ein natives IFC-Projekt enthält, egal ob gesperrt oder entsperrt, verfügt immer über eine angehängte IFC-Datei, in der die IFC-Daten gespeichert sind. Wenn man ein neues Projekt erstellt und die Datei noch nicht gespeichert hat, befinden sich die IFC-Inhalte im Speicher. Sobald man die Datei speichert, wird eine zugehörige IFC-Datei erstellt, die fortan an die FreeCAD-Datei angehängt ist.

Im '''gesperrten Modus''' enthält das FreeCAD-Dokument in seiner Eigenschaft '''IFC-Dateipfad''' den Pfad zur zugehörigen IFC-Datei. Da alles, was in FreeCAD geschieht, direkt in der IFC-Datei geschieht, wird die FreeCAD-Datei nicht mehr benötigt. Die Einträge 'Speichern' und 'Speichern unter' im FreeCAD-Dateimenü werden durch 'IFC-Datei speichern' und 'IFC-Datei speichern unter' ersetzt. Wenn man die Datei speichert, wird die IFC-Datei gespeichert, und es wird keine FreeCAD-Datei geschrieben. Man arbeitet also buchstäblich nur mit der IFC-Datei.

Im '''entsperrten Modus''' existiert im FreeCAD-Dokument ein ''Projekt''-Objekt, das auch über eine ''IFC-Dateipfad''-Eigenschaft verfügt, die auf die zugehörige IFC-Datei verweist. Wenn man die Datei an andere Personen weitergibt, muss man ihnen auch die IFC-Datei zur Verfügung stellen. Wenn man die IFC-Datei verschiebt, muss die ''IFC-Dateipfad''-Eigenschaft des Projekt-Objekts entsprechend angepasst werden.

Es ist jedoch möglich, die FreeCAD-Datei ohne die IFC-Datei zu verteilen: Man setzt die Eigenschaft ''Shape Mode'' aller Objekte auf 'Shape'. Dadurch behält die FreeCAD-Datei die Form aller Objekte bei und lässt sich auch dann korrekt öffnen, wenn die IFC-Datei nicht vorhanden ist. Die Objekte sind in diesem Fall jedoch nicht editierbar.


<span id="Creating_output"></span>
== Erstellen von Ausgaben ==

<span id="Creating_views_and_2D_content"></span>
=== Erstellen von Ansichten und 2D-Inhalten ===

2D-Ansichten, die auf [[TechDraw_Workbench/de|TechDraw-Blättern]] platziert werden sollen, können weiterhin auf die [[BIM_Workbench/de|gleiche Weise wie zuvor]] erstellt werden: Hinzufügen von [[Arch_SectionPlane/de|Schnittebenen]], Erstellen von [[BIM_Shape2DView/de|2D-Ansichten]], Füllen dieser mit Anmerkungen und anschließendes [[BIM_TDView/de|Platzieren]] auf [[BIM_TDPage/de|Blättern]]. Der Vorgang ist bei Nicht-IFC-BIM-Modellen genau derselbe wie bei nativen IFC-Modellen.

Standardmäßig werden native IFC-Objekte jedoch ohne ihre Form geladen (ihre Eigenschaft ''Shape Mode'' ist auf ''Coin'' gesetzt). Dies spart beim Laden viel Zeit. Die zum Erzeugen von 2D-Ansichten verwendeten Schnittalgorithmen benötigen jedoch die vollständige Form. Wenn man also native IFC-Objekte in eine Schnittebene einfügt, wird der Shape Mode automatisch auf 'Shape' gesetzt.

Das endgültige Blatt selbst kann derzeit zwar nicht in der IFC-Datei gespeichert werden, die 2D-Ansichten, Schnittebenen und deren Anmerkungen jedoch schon. Wenn man eine Schnittebene zu einem Projekt hinzufügt (durch Ziehen und Ablegen im entsperrten Modus oder automatisch im gesperrten Modus), wird automatisch eine Gruppe unter dem Projekt erstellt. Diese Gruppe stellt eine 2D-Ansicht dar (ihre Eigenschaft ''Objekttyp'' ist auf 'ZEICHNUNG' gesetzt), und alles, was man zu dieser Gruppe hinzufügt, wird Teil dieser 2D-Ansicht.

<div class="figure">

[[Image:Nativeifc-tutorial-12.jpg|Bildschirmaufnahme einer aus einem IFC-Projekt erstellten 2D-Ansicht]]

</div>

<span id="Creating_sheets"></span>
=== Erstellen von Blättern ===

Derzeit werden Blätter nicht in der IFC-Datei gespeichert. Bei gesperrten Dateien müssen die Blätter daher neu erstellt werden.

<span id="Creating_schedules"></span>
=== Erstellen von Listen ===

Listen und alle Arten von Abfragen können für native IFC-Projekte genauso wie für Nicht-IFC-Projekte mit dem [[Arch_Schedule/de|Listen-Werkzeug]] erstellt werden. Listen können auch zu einem nativen IFC-Projekt hinzugefügt werden. In diesem Fall wird die zugehörige Tabelle nicht in der IFC-Datei gespeichert und muss beim Öffnen der Datei neu erstellt werden.


<span id="Python_scripting"></span>
==Skripterstellung mit Python==

=== IfcOpenShell ===

[https://ifcopenshell.org/ IfcOpenShell] ist die Softwarekomponente, die in allen IFC-bezogenen Vorgängen in FreeCAD verwendet wird. Der Arbeitsbereich BIM kann auch ohne sie funktionieren, aber in diesem Fall sind alle IFC-Vorgänge deaktiviert. IfcOpenShell ist für die Erstellung und Änderung von IFC-Dateien und IFC-Objekten sowie für die Erzeugung von BREP-Geometrien für die FreeCAD-Objekte verantwortlich, die IFC-Elemente darstellen. FreeCAD verwendet IfcOpenShell derzeit nur über seine Python-Schnittstelle.

IfcOpenShell bietet eine [https://docs.ifcopenshell.org/ umfassende Dokumentation], in der die Verwendung ausführlich erklärt wird.

Man kann auch sowohl IfcOpenShell als auch ifc_tools verwenden, um IFC-Daten direkt zu bearbeiten. Nachfolgend findet man ein kurzes Beispiel dafür, wie man mit IfcOpenShell eine IFC-Datei öffnet und deren Inhalt analysieren kann:

{{Code|code=
import ifcopenshell
my_ifc_file = ifcopenshell.open("/path/to/some/file.ifc")
walls = my_ifc_file.by_type("IfcWall") # get a list of all IfcWalls
some_specific_object = my_ifc_file[66] # get an object by its ID
some_specific_object = my_ifc_file.by_id(66) # alternative way
print(some_specific_object.Name) # you can access attributes that way
}}

IfcOpenShell selbst verfügt (noch) über keine spezifischen FreeCAD-Funktionen, sodass man es im Grunde genommen für Nicht-FreeCAD-Operationen an Objekten verwenden würde, z. B. zum Abrufen oder Ändern von Objekten und Attributen, zum Ändern von Attributen oder sogar zum direkten Hinzufügen von Objekten. Weitere Informationen findet man in der [https://docs.ifcopenshell.org/ifcopenshell-python.html IfcOpenShell Python-Dokumentation].

In FreeCAD wird beim Laden einer IFC-Datei ein IfcOpenShell-Dateiobjekt erstellt und an das Projekt angehängt (das Projektobjekt für entsperrte Dateien oder das FreeCAD-Dokument selbst für gesperrte Projekte). Alles, was man in FreeCAD tut, manipuliert tatsächlich dieses Objekt. Man kann ganz einfach auf das IfcOpenShell-Dateiobjekt eines nativen FreeCAD-IFC-Projekts zugreifen und es manipulieren. Im gesperrten Modus geht man beispielsweise wie folgt vor:

{{Code|code=
import FreeCAD
my_doc = FreeCAD.loadFile("/path/to/some/file.ifc")
my_ifc_file = my_doc.Proxy.ifcfile
}}

Im entsperrten Modus verfügt jedes Projekt-Objekt auch über ein {{Incode|Proxy.ifcfile}}-Mitglied.

<span id="The_ifc_tools_module"></span>
=== Das Modul ifc_tools ===

Das Modul [https://github.com/FreeCAD/FreeCAD/blob/main/src/Mod/BIM/nativeifc/ifc_tools.py ifc_tools] ist das wichtigste Werkzeug für die Verwendung von IfcOpenShell im BIM-Modul von FreeCAD. Es enthält viele Werkzeuge und Funktionen, um alles zu tun, was FreeCAD mit IFC-Dateien und -Objekten tun muss, wie z. B. neue Dateien erstellen, Dateien öffnen, Elemente erstellen, Attribute ändern usw.

Bei der Arbeit mit FreeCAD-Objekten ist die Verwendung von ifc_tools wesentlich komfortabler, da es alle Beziehungen zwischen dem FreeCAD-Objekt und dem IFC-Objekt, das es darstellt, für den Benutzer verwaltet. Beispiel:

{{Code|code=
from nativeifc import ifc_tools
selection = FreeCADGui.Selection.getSelection()
my_obj = selection[0] # just get the first selected object
project = ifc_tools.get_project(my_obj)
ifcfile = ifc_tools.get_ifcfile(project)
ifc_elem = ifc_tools.get_ifc_element(my_obj)
my_obj.LongName = "Changed long name" # this updates the IFC data too
print(ifc_elem.LongName) 
}}

ifc_tools bietet noch viel mehr, beispielsweise Dienstprogramme zum Erstellen und Ändern von FreeCAD-Objekten (und den zugrunde liegenden IFC-Elementen). Nachfolgend findet man einige einfache Beispiele für den Einstieg:

<span id="Load_the_shape_of_selected_objects"></span>
==== Die Form der ausgewählten Objekte laden ====

Standardmäßig wird beim Öffnen einer IFC-Datei nur eine vereinfachte 3D-Darstellung jedes Elements geladen. Um ernsthaft damit arbeiten zu können, müssen man möglicherweise die vollständige Form laden:

{{Code|code=
for obj in FreeCADGui.Selection.getSelection():
    obj.ShapeMode = "Shape"
FreeCAD.ActiveDocument.recompute()
}}

<span id="Load_the_property_sets_of_selected_objects"></span>
==== Die Eigenschafts-Sätze der ausgewählten Objekte laden ====

Eigenschaftssätze und die darin enthaltenen Eigenschaften werden in FreeCAD als Objekteigenschaften dargestellt. Sobald sie geladen sind, kann man die Werte einfach über den Eigenschaften-Ansicht in FreeCAD (oder über Python) bearbeiten:

{{Code|code=
from nativeifc import ifc_psets
for obj in FreeCADGui.Selection.getSelection():
    ifc_psets.show_psets(obj)
my_object.FireResistanceClass = "1B" # manipulate properties once loaded
}}

<span id="Saving_an_IFC_file"></span>
==== Speichern einer IFC-Datei ====

{{Code|code=
ifc_tools.save(project)
}}

<span id="Add_a_new_IFC_document"></span>
==== Neues IFC-Dokument hinzufügen ====

Das Werkzeug '''Projekt''' aus dem Arbeitsbereich BIM verwenden, um ein natives IFC-Projekt-Objekt zu erstellen. Es ist nicht zwingend erforderlich, das neue IFC-Projekt sofort zu speichern, aber es ist dennoch empfehlenswert. Wenn man dies vergisst, wird man benachrichtigt und kann es beim Speichern des FreeCAD-Dokuments nachholen.

{{Code|code=
doc = FreeCAD.ActiveDocument
new_project = ifc_tools.create_document(doc)
ifc_tools.save(new_project, "/path/for/our/new/file.ifc")
}}

<span id="Modifying_the_IFC_class_of_an_object"></span>
==== Ändern der IFC-Klasse eines Objekts ====

Das Ändern der Klasse ist sehr einfach, man kann einfach eine andere in der Eigenschaft '''Klasse''' des Objekts auswählen. Es ist zu beachten, dass sich dadurch auch die vordefinierten Attribute dieses Objekts ändern können, sodass einige Attribute möglicherweise verschwinden.

{{Code|code=
my_object.Class = "IfcWall"
}}

<span id="Aggregate_(and_convert)_any_FreeCAD_object_to_an_IFC_project"></span>
==== Zusammenführen (und konvertieren) beliebiger FreeCAD-Objekte in ein IFC-Projekt ====

Angenommen, wir haben eine neue Wand gebaut und müssen sie zu einem IFC-Projekt hinzufügen. Das können wir grafisch tun, indem wir sie per Drag & Drop in die Baumansicht des Projekts ziehen, aber mit Python ist es genauso einfach:

{{Code|code=
import Arch
my_new_wall = Arch.makeWall(None, 200, 20, 300)
ifc_tools.aggregate(my_new_wall, project)
}}

<span id="Add_a_new_model_structure"></span>
==== Hinzufügen einer neuen Modellstruktur ====

Wenn man ein neues Projekt erstellt, kann man sich auch eine Grundstruktur automatisch erstellen lassen, indem man im angezeigten Dialogfeld mit 'Ja' antwortet. Das kann man aber auch ganz einfach in Python tun:

{{Code|code=
import Arch
doc = FreeCAD.ActiveDocument
project = ifc_tools.create_document(doc)
site = Arch.makeSite()
site = ifc_tools.aggregate(site, project)
building = Arch.makeBuilding()
building = ifc_tools.aggregate(building, site)
level = Arch.makeFloor()
level = ifc_tools.aggregate(floor, building)
}}

<span id="Change_the_schema_of_an_IFC_document"></span>
==== Das Schema eines IFC-Dokuments ändern ====

Einfach die Eigenschaft 'Schema' des Projekts ändern. Es ist zu beachten, dass dies weitreichende Folgen haben kann (einige Objekttypen könnten sich in der neuen Schemaversion geändert haben). Daher geht man vorsichtig vor und überprüft die Daten anschließend selbst.

{{Code|code=
project.Schema = "IFC4"
}}

Es gibt noch viel mehr zu entdecken, da durch die verschiedenen [https://github.com/FreeCAD/FreeCAD/tree/main/src/Mod/BIM/nativeifc nativen IFC-Untermodule] weitere Funktionen verfügbar sind, die jeweils Werkzeuge für bestimmte Aspekte von IFC (Eigenschaftssätze, Geometrie, Ebenen…) bieten. Man muss sich diese bei Bedarf unbedingt anschauen!

Ich hoffe, man hat nun eine gute Vorstellung davon, wo man anfangen kann und was mit nativem IFC in FreeCAD möglich ist. Wenn man Hilfe benötigt, besucht man unbedingt den [https://forum.freecad.org/viewforum.php?f=23 BIM-Bereich im FreeCAD-Forum]!