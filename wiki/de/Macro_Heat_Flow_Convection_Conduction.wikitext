<languages/>

{{Macro/de
|Name=Macro Heat Flow Convection Conduction
|Name/de=Makro Wärmeströmung Konvektion Wärmeleitung
|Description=Dieses Makro berechnet die Wärmeflussrate in einer Richtung aufgrund von Konvektion und (oder) Wärmeleitung, wenn sich das Phänomen im stationären Zustand befindet. Es berechnet auch die Temperaturen zwischen den Schichten der Materialien.
|Author=Garlic
|Download=[https://www.freecadweb.org/wiki/images/2/2c/Text-x-python.png Text-x-python.png]
|Links=[https://git.disroot.org/CrowdDiscussesAlternatives/ScriptsForFreeCAD/src/branch/master/Thermal/HeatFlowConvectionConduction_documentation.pdf Wärmeströmung Konvektion Wärmeleitung Dokumentation]
|Date=2025-09-14
|Version=0.0.2
|FCVersion= Alle
}}

<span id="Description"></span>
==Beschreibung==

Dies ist ein Algorithmus, der den Wärmefluss aufgrund von Wärmeleitung und/oder Konvektion in einer Richtung berechnet (z. B. bei einer Wand, die aus verschiedenen Materialien wie Putz, Ziegeln und Dämmstoff besteht, oder bei einem Fenster mit Doppelverglasung und einem mit Luft gefüllten Hohlraum usw.). Das Phänomen muss sich im stationären Zustand befinden (d. h. es darf nicht zeitabhängig sein).

Die Eingabe der Daten muss in einer Tabelle in [https://freecad.org FreeCAD] erfolgen, und die Ergebnisse werden in derselben Tabelle einige Zeilen unterhalb der zuletzt geschriebenen Zeile ausgegeben. Diese Eingabedaten müssen (in einer bestimmten Reihenfolge) die thermischen Eigenschaften der Materialien der Schichten, in denen der Wärmefluss stattfindet, die Dicke jeder Schicht, die Fläche, die Temperatur des ersten und letzten Punktes in Richtung des Wärmeflusses, die Art des Phänomens in jeder Schicht (z. B. [https://de.wikipedia.org/wiki/W%C3%A4rmeleitung Wärmeleitung], oder erzwungene [https://de.wikipedia.org/wiki/Konvektion Konvektion], oder freie Konvektion an einer horizontalen, vertikalen, geneigten Oberfläche oder einem geschlossenen Hohlraum). Die Ergebnisse sind die Wärmeleistungsrate (in Watt), die relative Genauigkeit der Berechnungen (der Algorithmus verwendet thermische Strömungsgleichungen und löst das Problem in Iterationen, wobei er versucht, zu konvergieren) und die berechneten Temperaturen der beiden Oberflächen auf jeder Schicht.

==Installation==

<div lang="en" dir="ltr" class="mw-content-ltr">
Please note that you need to do the following steps only once:
# From the menu of FreeCAD, go to {{MenuCommand|Macro → Macros...}}
# Find which is the path written in the field '''"User macros location:"'''
# Open this folder with the file explorer (or any other file management application).
# Download the files '''HeatFlowConvectionConduction.py''', '''Thermal.py''' and '''SpreadsheetDataReadWrite.py''' from https://git.disroot.org/CrowdDiscussesAlternatives/ScriptsForFreeCAD/src/branch/master/Thermal and paste them in this folder.
# {{Button|Close}} the [[Std_DlgMacroExecute|Execute macro dialog box]].
</div>

Weitere Informationen zur manuellen Installation von Makros findet man [[How_to_install_macros/de|hier]].

<span id="Usage"></span>
==Anwendung==

Die folgenden Beispiele demonstrieren, wie das Skript genutzt wird.

<span id="Example_1"></span>
===Beispiel 1===

In diesem Beispiel wird die Wärmeleistung berechnet, die durch ein doppelt verglastes Fenster fließt. Es ist gegeben, dass die Umgebungstemperatur im Raum 25 °C beträgt und die Umgebungstemperatur außerhalb des Fensters 10 °C. Die Größe des Fensters beträgt 0,57 m Höhe × 0,43 m Breite (d. h. eine Fläche von 0,2451 m<sup>2</sup>). Die Dicke jedes Glases beträgt 4 mm (d. h. 0,004 m) und der Luftspalt dazwischen beträgt 16 mm.

Um den Algorithmus zu verwenden, öffnet man zunächst die FreeCAD-Anwendung. Wählt dann den [[Spreadsheet_Workbench/de|Arbeitsbereich Spreadsheet]], erzeugt ein neues  [[Image:Std_New.svg|16px]] [[Std_New/de|Dokument]] und erstellt danach ein neues [[File:Spreadsheet_CreateSheet.svg|16px]] [[Spreadsheet_CreateSheet/de|Tabellenblatt]].

<span id="Input_data"></span>
====Eingabedaten====

Der Algorithmus durchsucht die erste Spalte der Tabelle, um die erste Zahl zu finden. Wenn er sie findet, nimmt er an, dass dies die ID der ersten Ebene ist. Anschließend sucht er nach der ID der zweiten Ebene. Wenn fünf aufeinanderfolgende Zeilen keine Zahl in der ersten Spalte enthalten, geht er davon aus, dass es keine weiteren Ebenen gibt. Die Zeilen zwischen den Daten der Ebenen können verwendet werden, um Einheiten, Kommentare usw. einzutragen. Die Eigenschaften jeder Ebene müssen in einer bestimmten Reihenfolge eingetragen werden.

Für dieses Beispiel können die Daten in der Tabelle wie in der Abbildung unten dargestellt geschrieben werden.

[[File:HeatFlowConvectionConduction Macro Example1 InputData.png]]

Zeile 4 enthält die Daten der Schicht mit der ID 1. Dies ist die Schicht, in der die Konvektion zwischen der Umgebungsluft außerhalb des Fensters und der Außenfläche der Außenverglasung des Fensters stattfindet. '''Die Einheiten der Daten sind in  [https://de.wikipedia.org/wiki/Internationales_Einheitensystem SI]''' (metrisches System).

Temp. 1 ist die Außenumgebungstemperatur in Kelvin (die bekannt ist: 10 °C + 273,15 = 283,15 K).

<div lang="en" dir="ltr" class="mw-content-ltr">
Temp. 2 is the temperature of the outer surface of the outer glass and is roughly estimated to be 286.15K. This is an initial value for the solver to start the first iteration. This temperature will be calculated and presented in the results. In order to estimate an initial value, we used the following equation: (25 - 10) / 5 = 3, where 25°C is the indoor temperature, 10°C is the outdoor temperature and 5 are the number of the layers, so we added 3 to 283.15K.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.2451m<sup>2</sup> is the area of the window.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
2 is the number that specifies the category of ''“free convection on an inclined or a vertical surface”'' (as a mechanism of heat transfer in this layer).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
101325Pa is the atmospheric pressure at sea level.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.7 (70% / 100) is the relative humidity of the outdoor ambient air.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.57m is the characteristic length (for a free convection on a vertical plane, the characteristic length is the height of the plane).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0 degrees is the angle between the plane and the Vertical.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''Please note that in order for the algorithm to understand the data, these must be written in the above order''' (without empty cells in between), when the heat transfer mechanism is free convection on a vertical plane.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Row 7 has the data of the layer that conduction occurs on the outer glass of the window. 2 is the id of this layer.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Temp. 1 is the temperature of the outer surface of the outer glass and is roughly estimated to be 286.15K (it must have the same value of temp. 2 of the previous layer, since it refers to the same surface).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Temp. 2 is the temperature of the inner surface of the outer glass (i.e. the surface that is in contact with the air that is enclosed between the two glasses) and is roughly estimated to be 289.15K (the previous temperature plus 3K). This temperature will be calculated by the solver.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.2451m<sup>2</sup> is the area of the window.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
1 is the number that specifies the category of ''“conduction”'' (as a mechanism of heat transfer in this layer).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.96 W / (m &times; K) is the thermal conductivity of the glass [https://www.engineeringtoolbox.com/thermal-conductivity-d_429.html]. There are various tables on the internet that have the thermal properties of the most common materials. You can also use the [[Material Workbench]] to view the properties of a [[Std SetMaterial|material]].
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.004m is the thickness of the glass.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The above order is the one that the data must be written on the spreadsheet, when concerning conduction.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Row 10 has the data of the layer of the air that is trapped between the two glasses. 3 is the id of this layer.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
289.15K is the roughly estimated temperature of the inner surface of the outer glass.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
292.15K is the roughly estimated temperature of the opposite surface that encloses the air (i.e. the surface of the other glass that is in contact with the trapped air). This temperature will also be calculated by the solver.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.2451m<sup>2</sup> is the area of the window.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
4 is the number that specifies the category of ''“free convection in an enclosure”'' (as a mechanism of heat transfer in this layer). Please note that the set of equations in the algorithm (for this case) is only suitable for small gaps, similar to the gap in a double glazed window (i.e. less than 0.05m) [https://iopscience.iop.org/article/10.1088/1757-899X/939/1/012049/pdf].
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
101325Pa is the atmospheric pressure at sea level.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.2 (20% / 100) is the relative humidity of the enclosed air.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.016m is the characteristic length (for a free convection in an enclosure, the characteristic length is the thickness of the air gap, i.e. the distance between the two glasses).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Row 13 has the data of the layer with id 4, which concerns the conduction (category 1) that occurs at the second glass of the window.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Row 16 has the data of the layer with id 5, which concerns the free convection (category 2) that occurs at the surface of the second glass of the window that is in contact with the ambient air of the room. Note that the Temp. 2 of this layer is 298.15K which is 25°C (a given value in this example).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Please note that the used equations are valid for a range of values concerning the input data (the comments in the script [https://git.disroot.org/CrowdDiscussesAlternatives/ScriptsForFreeCAD/src/branch/master/Thermal/Thermal.py Thermal.py] specify these ranges). '''If these ranges are exceeded, then warnings (or errors) are printed in the [[Python Console]] of the FreeCAD.'''
</div>

<span id="Executing_the_script"></span>
====Das Skript ausführen====

Damit der Algorithmus ausgeführt werden kann, muss die [[Python_Console|Python-Konsole]] in FreeCAD geöffnet werden und der folgenden Code ausgeführt werden (d. h. jede Zeile des folgenden Codes separat kopieren und einfügen und jedes Mal {{Button|Enter}} drücken).

<div lang="en" dir="ltr" class="mw-content-ltr">
{{Code|lang=python|code=
import HeatFlowConvectionConduction
heatFlowObj = HeatFlowConvectionConduction.HeatFlowConvectionConduction()
heatFlowObj.calcHeatFlowConvectionConduction()
}}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Please note that once you open FreeCAD, you need to copy-paste the first two lines of this code only once (the first line imports the script and the second line creates an object). Then, every time you want to execute the algorithm of the script (in order to read the data of the spreadsheet, run the solver, and present the results), just copy-paste the third line of the code above and then press {{Button|Enter}}.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The results are written in the same spreadsheet, three rows below the last written row (please have in mind that the algorithm checks only if the first ten columns in seven subsequent rows are empty, and if true, it considers that it has found “the last written row”).
</div>

<span id="Results"></span>
====Ergebnisse====

[[File:HeatFlowConvectionConduction Macro Example1 Results.png]]

<div lang="en" dir="ltr" class="mw-content-ltr">
The heat flow rate is 2.62W. We firstly wrote the lower temperature, thus the minus symbol in the picture above indicates that the flow is in the opposite direction (i.e. from the higher temperature to the lower).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The relative accuracy is 0.76% (the solver of the algorithm terminates if the relative accuracy is less than 5%, or the number of iterations are more than ten - you can change these limits by altering their values in the {{incode|simulate_thermal_flow}} function inside the script).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The temperatures of each layer are calculated. The rest of the input data are also printed again for each layer, for clarity.
</div>

<span id="Example_2"></span>
===Beispiel 2===

<div lang="en" dir="ltr" class="mw-content-ltr">
A wind with speed 10m/sec, humidity 40%, and temperature 10°C flows in parallel with the width of a wall, which has 5m width &times; 3m height, and which its surface has a temperature of 11°C.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
In order to calculate the heat flow rate, we need to write the data on the spreadsheet, in the correct order.
</div>

1 ist die Bezeichnung der Ebene.

<div lang="en" dir="ltr" class="mw-content-ltr">
283.15K is the temperature of the air (the temperature of the wall could also have been written firstly).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
284.15K is the temperature of the surface of the wall.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
15m<sup>2</sup> is the area of the surface.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
5 specifies the category ''“forced convection parallel to a flat surface”''.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
101325Pa is the atmospheric pressure at sea level.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.4 is the relative humidity divided by 100.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
5m is the characteristic length (for forced convection, it is the dimension of the surface that is parallel to the flow).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
10m/sec is the speed of flow.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The results show that the heat flow rate is 367.18W.
</div>

<span id="Example_3"></span>
===Beispiel 3===

<div lang="en" dir="ltr" class="mw-content-ltr">
The surface of a terrace has an area of 50m<sup>2</sup> (10m length &times; 5m width) and a temperature of 11°C. The outdoor ambient temperature is 10°C and the humidity is 50%.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
In order to calculate the heat flow rate, we need to enter these data in a correct order.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
1 is the id of the layer.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
283.15K is the temperature of the ambient air (i.e. the temperature of the fluid outside the [https://en.wikipedia.org/wiki/Thermal_boundary_layer_thickness_and_shape thermal boundary layer], in Kelvins).
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
284.15K is the temperature of the surface of the terrace.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
50m<sup>2</sup> is the area of the surface.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
3 specifies the category ''“free convection on a horizontal surface”''.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
101325Pa is the atmospheric pressure at sea level.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
0.5 is the relative humidity divided by 100.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
1.67m is the characteristic length (for free convection on a horizontal surface it is the area of the surface divided by the perimeter: 50 / (10 + 5 + 10 + 5)). '''Please note that in order for the data to be read correctly, you should write in the cell of the spreadsheet 1.67 (and not = 50 / (10 + 5 + 10 + 5)).'''
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
1 is the direction of the surface. Since the air is on the top of the surface, this entry must be 1. If the air was at the bottom of the surface (e.g. in the case of a ceiling) then you should write -1.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
2 is the last written data in the row, and it specifies that temp. 1 is the temperature of the air and temp. 2 is the temperature of the surface. If you had written firstly the temperature of the surface and secondly the temperature of the air, then this last entry should be 1.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The results show that the heat flow rate is 92.55W
</div>

<span id="Simulated_cases_of_heat_transfer"></span>
===Simulierte Fälle von Wärmeübertragung===

<div lang="en" dir="ltr" class="mw-content-ltr">
The above examples cover the five cases (categories) that the algorithm in the script can calculate heat flow:
* Category 1: Conduction.
* Category 2: Free convection on an inclined or a vertical surface.
* Category 3: Free convection on a horizontal surface.
* Category 4: Free convection in an enclosure (for small gaps, similar to the gap in a double glazed window).
* Category 5: Forced convection parallel to a flat surface.
</div>

<span id="Scripts"></span>
==Skript==

Die Dateien HeatFlowConvectionConduction.py, Thermal.py und
SpreadsheetDataReadWrite.py können heruntergeladen werden unter:

https://git.disroot.org/CrowdDiscussesAlternatives/ScriptsForFreeCAD/src/branch/master/Thermal

<span id="Links"></span>
==Verweise==

Die Forumsdiskussion: [https://forum.freecad.org/viewtopic.php?t=99795 Presenting HeatFlowConvectionConduction macro]

Die Dokumentation dieses Skripts im PDF-Format: [https://git.disroot.org/CrowdDiscussesAlternatives/ScriptsForFreeCAD/src/branch/master/Thermal/HeatFlowConvectionConduction_documentation.pdf Wärmeströmung Konvektion Wärmeleitung Dokumentation]

<span id="References"></span>
==Referenzen==

<div lang="en" dir="ltr" class="mw-content-ltr">
# [https://www.engineeringtoolbox.com/thermal-conductivity-d_429.html Thermal Conductivity of Common Materials - Solids, Liquids and Gases]
# Heat transfer through a double-glazed window by convection, V А Маiоrоv. Citation V A Maiorov 2020 IOP Conf. Ser.: Mater. Sci. Eng. 939 012049, DOI 10.1088/1757-899X/939/1/012049. https://iopscience.iop.org/article/10.1088/1757-899X/939/1/012049/pdf
# Heat Transfer Handbook, by Adrian Bejan and Allan D. Kraus
</div>