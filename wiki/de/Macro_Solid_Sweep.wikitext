<languages/>
{{Macro/de
|Name=Solid Sweep
|Translate=Solid Sweep
|Icon=Macro_Solid_Sweep.png
|Description=Erzeugt einen Festkörper, indem ein Profil entlang einer (Spine-) Kurve ausgetragen wird.
|Author=Normandc
|Version=1.0
|Date=2011-12-03
|FCVersion=Alle
|Download=[https://wiki.freecad.org/images/6/6d/Macro_Solid_Sweep.png ToolBar Icon]
}}

==Beschreibung==
Dieses Makro erstellt einen Festkörper, indem ein 2D-Profil entlang einer zuvor in der 3D-Ansicht ausgewählten Spine-Kurve (Rückgratkurve) ausgetragen wird. Die 2D-Elemente können mit den normalen Werkzeugen in FreeCADs GUI erstellt werden.

Es sollte erwähnt werden, dass der sich ergebende Festkörper '''nicht''' parametrisch ist. Entscheidet man sich später, das Profil oder die Spine-Kurve zu ändern, muss das Makro erneut ausgeführt werden.

[[File:Solid_sweep.png‎|500px|Einige Beispiele für das Austragen mit dem gleichen länglichen Querschnitt und drei Arten von Spine-Kurven.]]

== Anwendung ==
# Zwei 2D-Elemente der weiter unten gelisteten Arten erstellen, eins für den Querschnitt und eins für die Spine-Kurve.
# Diese werden entweder in der [[Tree_View/de|Baumansicht]] oder in der [[3D_View/de|3D-Ansicht]] ausgewählt ('''Die Reihenfolge ist wichtig!'''):
## Die Spline-Kurve
## Dann das Profil (Querschnitt)
# Den [[Macros/de|Makro-Manager]] öffnen.
# Das Makro '''Solid Sweep''' auswählen.
# {{Button|Ausführen}} anklicken.
'''Ergebnis:''' Ein '''Sweep'''-Objekt wird im Projektbaum erstellt.

==Unterstützte 2D-Elemente==
* Kantenzüge
* [[Image: Sketcher_NewSketch.svg|24px]] [[Sketcher Workbench/de|Skizzen]]
* [[Image: Draft_BSpline.svg|24px]] [[Draft BSpline/de|Draft B-Splines]]
* 2D-Grundelemente aus dem Menü ''Part → [[Image:Part_Primitives.svg|24px]] [[Part_Primitives/de|Grundelemente erstellen]] ...'' (Kreis, Wendel)

==Tipps==
* Der Querschnitt muss ein geschlossenes Profil sein, oder das Ergebnis ist kein Festkörper.
* Der Querschnitt muss nicht auf der Spine-Kurve liegen, es ist jedoch vorzuziehen, dass er normal (senkrecht) zur Spine-Kurve ist.
* Die Spine-Kurve kann entweder ein offenes oder ein geschlossenes Profil sein (Kreis-, Linien- und Bogensegmente), aber alle Elemente müssen tangential sein, da sonst eine unerwartete Form entsteht. Beispielsweise erzeugt eine Spine-Kurve mit geraden Ecken wie ein Rechteck keinen Festkörper.
* Wenn der Festkörper verdreht wird, wird das Makro so bearbeitet, dass der Wert '' isFrenet '' auf 0 (Null) gesetzt wird und erneut ausgeführt.
* Wird die Variable '' makeSolid '' im Makro auf 0 (Null) gesetzt, werden mehrere Flächen mit offenen Enden erzeugt.

<span id="Script"></span>
==Skript==

ToolBar Icon [[Image:Macro_Solid_Sweep.png]]

'''Macro_Solid_Sweep.FCMacro'''

{{MacroCode|code=
import Part, FreeCAD, math, PartGui, FreeCADGui
from FreeCAD import Base

# get the selected objects, with first selection for the trajectory and second for the section
s = FreeCADGui.Selection.getSelection()
try:
     shape1=s[0].Shape
     shape2=s[1].Shape
except:
     print "Wrong selection"

traj = Part.Wire([shape1])
section = Part.Wire([shape2])

# create Part objec in the current document
myObject=App.ActiveDocument.addObject("Part::Feature","Sweep")

# variable makeSolid = 1 to create solid, 0 to create surfaces
makeSolid = True #1
isFrenet = True #1

# create a 3D shape and assigh it to the current document
Sweep = Part.Wire(traj).makePipeShell([section],makeSolid,isFrenet)
myObject.Shape = Sweep

}}


==Credits==
Vielen Dank an [[User: Wmayer|Wmayer]] für seine Hilfe beim Schreiben dieses Skripts.

Zwei Anwendungsbeispiele befinden sich in diesem [https://forum.freecad.org/viewtopic.php?f=8&t=1222&start=50#p11120 Thema im Forum], zusammen mit Download-Links zu den FCStd-Dateien. Bei Verwendung einer Helix als Spine-Kurve kann ein Festkörper-Sweep-Objekt zum Erstellen eines Schraubengewindes verwendet werden.