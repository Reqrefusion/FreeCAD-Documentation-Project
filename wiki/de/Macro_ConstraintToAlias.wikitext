<languages/>

{{Macro/de
|Name=Randbedingung zu Alias
|Icon=ConstraintToAlias.svg
|Description=Erstellt im Skizzen-Editor einen Alias aus einer ausgewählten benannten Randbedingung.
|Author=TheMarkster
|Version=0.2023.12.10
|Date=2023-12.10
|FCVersion=0.21
|Download=[https://wiki.freecad.org/images/3/31/ConstraintToAlias.svg Werkzeugleisten-Symbol]
}}

<span id="Description"></span>
==Beschreibung==

Häufig benötigen wir beim Bearbeiten einer Skizze einen Alias und einen Wert aus der Tabelle, um eine Beschränkung zu verknüpfen, haben diesen Alias jedoch noch nicht erstellt. In diesem Fall müssen wir die Skizze schließen, zur Tabellenansicht wechseln, den Alias erstellen, zum Skizzeneditor zurückkehren und die Beschränkung mit dem Alias verknüpfen.

Mit diesem Makro kann man einfach die Randbedingung erstellen, ihr einen Namen und einen Wert geben und dann das Makro ausführen. Es wird ein Dialogfeld angezeigt, in dem man die Bezeichnung für Spalte A, den Wert und den Alias für Spalte B bearbeiten kann. Auf OK klicken, um den Alias erstellen zu lassen und die Einschränkung über Ausdrücke damit zu verknüpfen.

[[File:ConstraintToAlias_scr1.png|400px]]

<span id="Usage"></span>
==Anwendung==

Eine Randbedingung erstellen, einen Namen eingeben, diese Randbedingung auswählen und das Makro ausführen. Der Name der Randbedingung wird als Standard für den Namen des in der Tabelle zu erstellenden Alias und für die Bezeichnung in Spalte A verwendet. Das Dialogfeld zeigt eine Vorschau der Tabelle, wie sie nach der Erstellung des Alias aussehen wird. 

Das Makro verwendet für die generierten Aliase nur die Spalten A und B, beginnend mit Zeile 2, und sucht nach unten, bis es zwei leere Zellen in diesen Spalten findet. Es ist nicht möglich, im Dialogfeld eine andere Tabellenzeile auszuwählen, aber es können hier die Felder Bezeichnung, Alias und Wert bearbeitet werden, bevor auf OK geklickt wird, um den Alias zu erstellen. Wenn keine Einschränkungen ausgewählt sind, enthält das Dialogfeld einige Standardwerte für Bezeichnung, Alias und Wert. Diese Funktion wurde in Version 0.2023.11.07 für Fälle hinzugefügt, in denen es außerhalb des Sketchers nützlich sein könnte, das Makro zum Hinzufügen eines neuen Alias zur Tabelle zu verwenden, z. B. bei der Eingabe der Länge einer Aufpolsterung.

Wenn im aktiven Dokument noch keine Tabelle vorhanden ist, wird vom Makro eine Tabelle mit dem Namen "ss" erstellt. Wenn nur eine Tabelle vorhanden ist, wird diese Tabelle verwendet. Wenn mehrere Tabellen vorhanden sind, werden diese zur Kombinationsfeld Tabellen oben im Dialogfeld hinzugefügt. Aus diesem Kombinationsfeld die Tabelle auswählen, zu der der Alias hinzugefügt werden soll.

Im Dialogfeld wird der Alias für die Zelle in Spalte B in geschweiften Klammern angezeigt, z. B. {{Value|{alias_for_this_cell} 32}}. Wenn der Alias erstellt ist, wird dieser Text nicht in der Tabelle angezeigt, sondern nur {{Value|32}}, während der Alias für diese Zelle {{Value|alias_for_this_cell}} lautet.

In der obigen Bildschirmaufnahme beachten, dass das Feld Alias rot markiert ist. Dies weist auf den Fehler hin, dass dieser Alias bereits in der Tabelle vorhanden ist. Daher sollte ein anderen Namen gewählt werden, oder der Vorgang abgebrochen werden, wenn nicht bemerkt wurde, dass dieser Alias bereits vorhanden ist. Auch zu beachten ist, dass bestimmte Zeichen, wie z. B. Leerzeichen, für Aliasnamen nicht zulässig sind. Leerzeichen werden automatisch in Unterstriche umgewandelt. Andere Sonderzeichen werden ebenfalls auf diese Weise behandelt. Der endgültige Aliasname wird in der Tabellenvorschau angezeigt.

App::Links werden unterstützt, einschließlich Links zu Tabellen in anderen Dokumenten.

Wenn die ausgewählte Skizzenbeschränkung bereits durch einen Ausdruck gebunden ist, wird dieser Ausdruck gelöscht und so zurückgesetzt, dass er nun auf den neu erstellten Tabellenkalkulationsalias verweist. Der Aliaswert wird durch den Wert erstellt, daher muss die Zelle Wert im Dialogfeld bearbeitet werden, um den Ausdruck neu zu erstellen, z. B. {{Value|<nowiki>=</nowiki>width * height}}, wobei width und height Aliase in der Tabellenkalkulation sind. Es kann keine Verknüpfung zu Beschränkungen in der Skizze hergestellt werden, da dies zu einer zyklischen Redundanz führen würde.

<span id="Limitations"></span>
==Einschränkungen==

* Es werden nur die Spalten A und B unterstützt.
* Die Suche nach einer neuen leeren Zeile beginnt in Zeile 2, wobei vorhandene Inhalte in Zeile 1 ignoriert werden.
* Die Zellen in der Vorschau im Dialogfeld sind schreibgeschützt und können innerhalb des Dialogfelds nicht bearbeitet werden, mit Ausnahme der zu erstellenden Aliaszeile, die über die Felder Bezeichnung, Alias und Wert bearbeitet wird.

<span id="Addon_Manager_code"></span>
==Addon-Manager-Code==

{{Codeextralink|https://gist.github.com/mwganson/005765b49123d80cbb54569e081779a1/raw/556bf483802da8d756f869a4f894ba150d322305/ConstraintToAlias.FCMacro|ConstraintToAlias.FCMacro}}

<span id="Icon"></span>
==Symbol==

Werkzeugleisten-Symbol [[Image:ConstraintToAlias.svg]]

<span id="Script"></span>
==Skript==

'''Macro ConstraintToAlias.FCMacro'''

{{CodeDownload|https://gist.github.com/mwganson/005765b49123d80cbb54569e081779a1|ConstraintToAlias.FCMacro}}