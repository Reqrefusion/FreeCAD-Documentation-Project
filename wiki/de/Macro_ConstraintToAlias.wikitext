<languages/>

{{Macro/de
|Name=Randbedingung zu Alias
|Icon=ConstraintToAlias.svg
|Description=Erstellt im Skizzen-Editor einen Alias aus einer ausgewählten benannten Randbedingung.
|Author=TheMarkster
|Version=0.2023.12.10
|Date=2023-12.10
|FCVersion=0.21
|Download=[https://wiki.freecad.org/images/3/31/ConstraintToAlias.svg Werkzeugleisten-Symbol]
}}

<span id="Description"></span>
==Beschreibung==

Häufig benötigen wir beim Bearbeiten einer Skizze einen Alias und einen Wert aus der Tabelle, um eine Beschränkung zu verknüpfen, haben diesen Alias jedoch noch nicht erstellt. In diesem Fall müssen wir die Skizze schließen, zur Tabellenansicht wechseln, den Alias erstellen, zum Skizzeneditor zurückkehren und die Beschränkung mit dem Alias verknüpfen.

Mit diesem Makro kann man einfach die Randbedingung erstellen, ihr einen Namen und einen Wert geben und dann das Makro ausführen. Es wird ein Dialogfeld angezeigt, in dem man die Bezeichnung für Spalte A, den Wert und den Alias für Spalte B bearbeiten kann. Auf OK klicken, um den Alias erstellen zu lassen und die Einschränkung über Ausdrücke damit zu verknüpfen.

[[File:ConstraintToAlias_scr1.png|400px]]

<span id="Usage"></span>
==Anwendung==

Eine Randbedingung erstellen, einen Namen eingeben, diese Randbedingung auswählen und das Makro ausführen. Der Name der Randbedingung wird als Standard für den Namen des in der Tabelle zu erstellenden Alias und für die Bezeichnung in Spalte A verwendet. Das Dialogfeld zeigt eine Vorschau der Tabelle, wie sie nach der Erstellung des Alias aussehen wird. 

Das Makro verwendet für die generierten Aliase nur die Spalten A und B, beginnend mit Zeile 2, und sucht nach unten, bis es zwei leere Zellen in diesen Spalten findet. Es ist nicht möglich, im Dialogfeld eine andere Tabellenzeile auszuwählen, aber es können hier die Felder Bezeichnung, Alias und Wert bearbeitet werden, bevor auf OK geklickt wird, um den Alias zu erstellen. Wenn keine Einschränkungen ausgewählt sind, enthält das Dialogfeld einige Standardwerte für Bezeichnung, Alias und Wert. Diese Funktion wurde in Version 0.2023.11.07 für Fälle hinzugefügt, in denen es außerhalb des Sketchers nützlich sein könnte, das Makro zum Hinzufügen eines neuen Alias zur Tabelle zu verwenden, z. B. bei der Eingabe der Länge einer Aufpolsterung.

<div lang="en" dir="ltr" class="mw-content-ltr">
If there is no spreadsheet yet in the active document, then one named "ss" will be created by the macro for you. If there is only 1 spreadsheet, then that spreadsheet will be used. If there are multiple spreadsheets, then they will be added to the Spreadsheets combobox at the top of the dialog. Select from that combobox the spreadsheet to which you wish to add the alias.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
In the dialog the alias for the cell in Column B are shown in braces, e.g. {{Value|{alias_for_this_cell} 32}}. When the alias is created you will not see this text in the spreadsheet, but rather only {{Value|32}}, while the alias for that cell will be {{Value|alias_for_this_cell}}.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
In the screenshot above notice that the Alias field is in red text. This indicates the error that this alias already exists in the spreadsheet, so you should choose another name for it or cancel if you didn't realize it already existed. Note also that certain characters, like spaces, are not allowed for alias names. Spaces are automatically converted to underscores. Other special characters are also handled in this manner. You will see the alias name in its final form in the spreadsheet preview.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
App::Links are supported, including links to spreadsheets in other documents.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
If the selected sketch constraint is already bound by an expression, then that expression is cleared and reset to now point to the newly created spreadsheet alias. The alias value is created by value, so you will need to edit the Value cell in the dialog to recreate the expression, for example {{Value|<nowiki>=</nowiki>width * height}} where width and height are aliases in the spreadsheet. You cannot link back to constraints in the sketch as that would create a cyclical redundancy.
</div>

<span id="Limitations"></span>
==Einschränkungen==

<div lang="en" dir="ltr" class="mw-content-ltr">
* Only Columns A and B are supported
* Search for a new empty row begins at row 2, ignoring any existing contents in row 1
* Preview cells in the dialog are read-only and may not be edited within the dialog, except for the alias row to be created, which is edited via the Label, Alias, and Value fields.
</div>

<span id="Addon_Manager_code"></span>
==Addon-Manager-Code==

{{Codeextralink|https://gist.github.com/mwganson/005765b49123d80cbb54569e081779a1/raw/556bf483802da8d756f869a4f894ba150d322305/ConstraintToAlias.FCMacro|ConstraintToAlias.FCMacro}}

<span id="Icon"></span>
==Symbol==

Werkzeugleisten-Symbol [[Image:ConstraintToAlias.svg]]

<span id="Script"></span>
==Skript==

'''Macro ConstraintToAlias.FCMacro'''

{{CodeDownload|https://gist.github.com/mwganson/005765b49123d80cbb54569e081779a1|ConstraintToAlias.FCMacro}}