{{Macro|Name=server|Description=Allows external control over FreeCAD for automation purposes.|Author=Jjustra|Download=Possible files to download, example the icon toolBar ...|Date=2026-01-23|Version=1.0|FCVersion=1.0}}

== Description ==
Useful tool for FreeCAD automatization. The aim is for a small, versatile, 'top level'-only program.

Remote FreeCAD management, no actual model editing (for such goal, see Extensions).

You need client to send commands to this server. Included is simple python command line utility as reference implementation.

Don't forget to set ROOT path to server's stdin/stdout files - both in client AND in server before running it (variable ROOT at start of both files).

== Usage ==
This allows you to globally (but still in server's space not FreeCAD itself) select :

* document
* object
* spreadsheet
* path (mainly for export)



Subsequent operations may require document/object/spreadsheet/path

(most of those arguments are optional)

* given value is used first
* then global one
* and lastly active/default selection in FreeCAD itself

e.g.:

*   you can get list of objects in active document with command 'O'
*   you can also get list of objects in concrete document with command 'Oconcrete_document'

  (list of all documents is returned by command 'D')

It also allows you to get list of :

* opened documents
* objects with their Name and Label
* cells in spreadsheet with their values

And you can even :

* get cell value
* set cell value
* recompute (needed after setting cells)
* export

Command format :<syntaxhighlight lang="text">
<one-letter-mod><name> <data string>
</syntaxhighlight>e.g.:<syntaxhighlight lang="text">
!B1 123
</syntaxhighlight>where :

* '''!''' is mod
* '''B1''' is name
* '''123''' is string value

this sets cell B1 (in global or active document and spreadsheet) to value 123

== Commands ==
'''D''' - get list of open documents

'''O[<document>]''' - get list of objects

'''C[<document>] [<spreadsheet>]''' - get list of cells



'''d<document>''' - select document

'''s[<document>] <spreadsheet>''' - select spreadsheet

'''o[<document>] <object-name>''' - select object

'''p <file-path>''' - select/set path



'''@<cell-id> [<spreadsheet>]''' - get cell value

'''!<cell-id> <value>''' - set cell value



'''r[<document>]''' - recompute document

'''e[<nowiki><object>] [<file-path>]</nowiki>''' - export selected object

== Extensions ==
In case more functionality is required, beyond scope of this server, additions can be easily made.

== Examples ==
Select document My_document_0<syntaxhighlight lang="text">
dMy_document_0
</syntaxhighlight>Get list of objects from 'My_document_1'<syntaxhighlight lang="text">
OMy_document_1
</syntaxhighlight>Get list of objects from 'My_document_0'<syntaxhighlight lang="text">
O
</syntaxhighlight>Unselect document<syntaxhighlight lang="text">
d
</syntaxhighlight>Get list of objects from FreeCAD's active document<syntaxhighlight lang="text">
O
</syntaxhighlight>


Get list of cells from 'My_document_0' (default spreadsheet)<syntaxhighlight lang="text">
CMy_document_0
</syntaxhighlight>Get list of cells from 'My_document_0' ('My_spreadsheet')<syntaxhighlight lang="text">
CMy_document_0 My_spreadsheet
</syntaxhighlight>

== Code ==

=== server macro ===

=== client script ===