{{Macro|Name=server|Description=Allows external control over FreeCAD for automation purposes.|Author=Jjustra|Download=Possible files to download, example the icon toolBar ...|Date=2026-01-23|Version=1.0|FCVersion=1.0}}

== Description ==
Useful tool for FreeCAD automatization. The aim is for a small, versatile, 'top level'-only program.

Remote FreeCAD management, no actual model editing (for such goal, see Extensions).

You need client to send commands to this server. Included is simple python command line utility as reference implementation.

This allows you to globally (but still in server's space not FreeCAD itself) select :

* document
* object
* spreadsheet
* path (mainly for export)


Subsequent operations may require document/object/spreadsheet/path

(most of those arguments are optional)

* given value is used first
* then global one
* and lastly active/default selection in FreeCAD itself

e.g.:

*   you can get list of objects in active document with command 'O'
*   you can also get list of objects in concrete document with command 'Oconcrete_document'

  (list of all documents is returned by command 'D')

It also allows you to get list of :

* opened documents
* objects with their Name and Label
* cells in spreadsheet with their values

And you can even :

* get cell value
* set cell value
* recompute (needed after setting cells)
* export

== Usage ==

=== Server ===
You start server by running macro. You can stop it the same way. Macro, therefore, acts as mere switch button and real magic happens elsewhere.

=== Client ===
Included client script accepts command in form of command line arguments. Each argument is one command.

e.g.: ./freecad-ctl.py 'dMy_document_1' C '!B1 123' C

=== Note ===
Don't forget to set ROOT path to server's stdin/stdout files - both in client AND in server before running it (variable ROOT at start of both files).

=== Communication protocol ===
Informations are exchanged thru two files. From server's POV one is input, the other output. From client's POV server's input is its output and vice versa.

Every command returns some response.

==== Command format ====
<syntaxhighlight lang="text">
<one-letter-mod><name> <data string>
</syntaxhighlight>e.g.:<syntaxhighlight lang="text">
!B1 123
</syntaxhighlight>where :

* '''!''' is mod/command
* '''B1''' is name
* '''123''' is string value (can be another name or just value; depends on situation)

this sets cell B1 (in global or active document and spreadsheet) to value 123

==== Commands ====
''D'' - get list of open documents

''O[<document>]'' - get list of objects

''C[<document>] [<spreadsheet>]'' - get list of cells

''d<document>'' - select document

''s[<document>] <spreadsheet>'' - select spreadsheet

''o[<document>] <object-name>'' - select object

''p <file-path>'' - select/set path

''@<cell-id> [<spreadsheet>]'' - get cell value

''!<cell-id> <value>'' - set cell value

''r[<document>]'' - recompute document

''e[<nowiki><object>] [<file-path>]</nowiki>'' - export selected object

==== Examples ====
Select document '''My_document_0'''<syntaxhighlight lang="text">
dMy_document_0
</syntaxhighlight>


Get list of objects from '''My_document_1'''<syntaxhighlight lang="text">
OMy_document_1
</syntaxhighlight>


Get list of objects from '''My_document_0'''<syntaxhighlight lang="text">
O
</syntaxhighlight>


Unselect document<syntaxhighlight lang="text">
d
</syntaxhighlight>


Get list of objects from FreeCAD's active document<syntaxhighlight lang="text">
O
</syntaxhighlight>

Get list of cells from '''My_document_0''' (default spreadsheet)<syntaxhighlight lang="text">
CMy_document_0
</syntaxhighlight>


Get list of cells from '''My_spreadsheet''' in '''My_document_0'''<syntaxhighlight lang="text">
CMy_document_0 My_spreadsheet
</syntaxhighlight>

== Extensions ==
In case more functionality is required, beyond scope of this server, additions can be easily made.

Every command must return some response.

== Code ==
=== server macro ===
server.FCMacro<syntaxhighlight lang="python3" line="1">
#
</syntaxhighlight>

=== client script ===
freecad-ctl.py<syntaxhighlight lang="python3" line="1">
#
</syntaxhighlight>