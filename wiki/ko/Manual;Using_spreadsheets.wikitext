<languages/>

{{Docnav
|[[Manual:BIM_modeling/ko|설명서:BIM 모델링]]
|[[Manual:Creating_FEM_analyses|설명서:FEM 해석하기
]]
|[[Manual:Introduction/ko|설명서 시작]]
|IconC=Crystal_Clear_manual.png
}}

{{Manual:TOC}}

FreeCAD의 [[Image:Workbench_Spreadsheet.svg|16px]] [[Spreadsheet_Workbench|Spreadsheet 작업대(workbench)]]는 사용자가 [https://en.wikipedia.org/wiki/Spreadsheet 스프레드시트]를 설계 프로젝트 안에서 직접 생성하고 관리할 수 있도록 해 줍니다. 이는 [https://en.wikipedia.org/wiki/Microsoft_Excel Excel]이나 [https://en.wikipedia.org/wiki/LibreOffice_Calc LibreOffice의 Calc]로 만든 스프레드시트와 유사한 방식입니다. 이 Spreadsheet 작업대(workbench)를 사용하면 표 형식으로 데이터를 입력하고, 정리하며, 조작할 수 있고, 이렇게 관리된 데이터는 프로젝트 내의 다양한 매개변수나 모델과 연결하여 활용할 수 있습니다. 이를 통해 설계를 보다 체계적으로 제어하고, 수치 변경에 따른 모델의 반응을 효율적으로 관리할 수 있습니다.

이 작업대의 주요 장점 중 하나는 파라메트릭 모델링에서의 활용입니다. 스프레드시트는 3D 모델의 치수와 속성에 연결될 수 있어, 동적인 설계 변경을 가능하게 하는 핵심 도구가 됩니다. 예를 들어 스프레드시트에서 값을 하나 조정하면, 그에 대응하는 모델의 치수가 자동으로 업데이트됩니다.

값을 관리하는 기능 외에도, 이 작업대(workbench)는 데이터 관리에 매우 유용하여 재료 속성, 치수, 프로젝트 전반에 적용되는 매개변수와 같은 중요한 정보들을 저장하는 데 적합합니다. 이러한 기능은 여러 값을 참조하거나 조정해야 하는 복잡한 프로젝트에서 특히 큰 장점을 제공합니다.

스프레드시트는 계산과 데이터 관리를 위해 수식(formula)을 입력할 수 있도록 해 줍니다. 이러한 수식은 다른 스프레드시트 셀이나 3D 모델 내부의 매개변수를 참조할 수 있어, 설계 전체 과정이 변경 사항에 유연하고 즉각적으로 반응하도록 만들어 줍니다.

이 작업대(workbench)는 다른 FreeCAD 작업대(workbench)들과 매끄럽게 통합되어, 데이터와 모델 구성 요소 간의 상호작용을 가능하게 합니다. 이러한 통합은 프로젝트의 여러 측면에 대한 제어를 한곳으로 집중시켜, 관리 작업을 더욱 수월하게 만듭니다. 또한 인터페이스는 Excel이나 LibreOffice Calc와 같은 기존 스프레드시트 소프트웨어와 유사한 직관적인 구조를 가지고 있어, 해당 프로그램에 익숙한 사용자라면 쉽게 사용할 수 있습니다.

실무적으로 Spreadsheet 작업대(workbench)는 프로젝트 전반에 적용되는 매개변수를 정의하고, 자재 명세서(BOM)를 관리하며, 설계 결정에 영향을 주는 사용자 정의 계산을 수행하는 등 다양한 활용 사례에 적합합니다. 이러한 기능은 모든 매개변수의 제어를 한 곳에 집중시켜, 복잡한 프로젝트를 보다 단순하게 관리할 수 있도록 해 줍니다.

다음 예제에서는 몇 가지 객체를 생성한 뒤, 그중 일부 속성을 스프레드시트로 가져오고, 이후 해당 스프레드시트를 사용해 다른 객체들의 속성을 직접 제어해 보겠습니다.

=== Reading properties ===

* 먼저 [[Image:Workbench_Part.svg|16px]] [[Part_Workbench|Part 작업대(workbench)]]로 전환한 다음, 몇 가지 객체를 생성합니다. [[Image:Part_Box.svg|16px]] [[Part_Box|상자(Box)]], [[Image:Part_Cylinder.svg|16px]] [[Part_Cylinder|원통(Cylinder)]], 그리고 [[Image:Part_Sphere.svg|16px]] [[Part_Sphere|구(Sphere)]]를 각각 하나씩 만듭니다.
* 그 다음 각 객체의 '''배치(Placement)''' 속성을 수정하거나, [[Image:Draft_Move.svg|16px]] [[Draft_Move|Draft 이동(Draft Move)]] 도구를 사용하여 객체들을 서로 약간 떨어지게 배치합니다. 이렇게 하면 이후에 수행할 작업의 효과를 더 명확하게 확인할 수 있습니다.

[[Image:Exercise_spreadsheet_01.jpg]]

* 이제 이 객체들에 대한 몇 가지 정보를 추출해 보겠습니다. [[Image:Workbench_Spreadsheet.svg|16px]] [[Spreadsheet_Workbench|Spreadsheet 작업대(workbench)]]로 전환합니다.
* 그 다음 [[Image:Spreadsheet_Create.svg|16px]] 새 스프레드시트(New Spreadsheet) 버튼을 누릅니다.
* 트리 보기에서 새로 생성된 스프레드시트 객체를 더블 클릭하면 스프레드시트 편집기가 열립니다.

[[File:FreeCAD Spreedsheet.png]]

Although FreeCAD's spreadsheet editor is not as feature-rich as dedicated applications like Excel or LibreOffice Calc, it provides essential tools for most design tasks. Users can adjust cell properties such as size, color, and alignment, and merge or split cells for better organization. Basic formulas or references to other cells are supported, allowing for simple data manipulation. What sets it apart is its deep integration with FreeCAD's modeling environment, where changes in the spreadsheet can automatically update model dimensions in real time. While it may lack advanced features like pivot tables or charts, its focus on parametric-driven design makes it a powerful tool for managing design data directly within FreeCAD.

In FreeCAD, beyond the standard spreadsheet features, there is a particularly useful function: the ability to reference not just other cells, but also objects within the document and extract values from their properties. For instance, you can retrieve properties from 3D objects that are visible in the '''Data''' tab of the '''Properties Editor''' when an object is selected. This allows for seamless integration between the spreadsheet and the 3D model, making it easy to link and automate changes based on the parameters of objects within the design, offering a more dynamic and interconnected workflow.

* Let's start by entering a couple of texts in the cells A1, A2 and A3, so we remember what is what later on, for example '''Cube Length''', '''Cylinder Radius''' and '''Sphere Radius'''. To enter text, just write in the "Contents" field above the spreadsheet, or double-click a cell.
* Now let's retrieve the actual length of our cube. In cell B1, type '''=Cube.Length'''. You will notice that the spreadsheet has an auto-completion mechanism, which is actually the same as the expression editor we used in the previous chapter.
* Do the same for cell B2 ('''=Cylinder.Radius''') and B3 ('''=Sphere.Radius''').

[[File:FreeCAD Spreedsheet Autocomplete.png]]

* Although these results are expressed with their units, the values can be manipulated as any number, try for example entering in cell C1: '''=B1*2'''.
* We can now change one of these values in the properties editor, and the change will be immediately reflected in the spreadsheet. For example, let's change the length of our cube to '''20mm''':

[[File:FreeCAD Spreedsheet Multipl.png]]

The [[Image:Workbench_Spreadsheet.svg|16px]] [[Spreadsheet_Workbench|Spreadsheet Workbench]] page will describe in more detail all the possible operations and functions available in spreadsheets.

=== Writing properties ===

Another powerful feature of the Spreadsheet Workbench in FreeCAD is the ability to not only read values from the properties of 3D objects but also assign values to them. This allows for controlling the dimensions and attributes of objects directly from the spreadsheet. However, one of FreeCAD’s fundamental rules is that circular dependencies are forbidden—meaning a spreadsheet cannot both read from and write to the same object. Doing so would create a situation where the object depends on the spreadsheet while the spreadsheet also depends on the object, leading to an invalid configuration. To avoid this, a second spreadsheet is typically created to handle writing values, ensuring a clear separation between the reading and writing processes.

* We can now close the spreadsheet tab (under the 3D view). This is not mandatory, there is no problem in keeping several spreadsheet windows open.
* Press the [[Image:Spreadsheet_Create.svg|16px]] '''New Spreadsheet''' button again
* Change the name of the new spreadsheet to something more meaningful, such as '''Input''' (do this by right-clicking the new spreadsheet object, and choosing '''Rename''').
* Double-click the Input spreadsheet to open the spreadsheet editor.
* In cell A1, let's put a descriptive text, for example: "Cube dimensions"
* In cell B1, write '''=5mm''' (using the = sign makes sure the value is interpreted as a unit value, not a text).
* Now to be able to use this value outside the spreadsheet, we need to give a name, or alias, to the B1 cell.  Right-click the cell, click '''Properties''' and select the '''Alias''' tab. Give it a name, such as '''cubedims''':

[[File:FreeCAD Spreedsheet Alias.png]]

* Press '''OK''', then close the spreadsheet tab
* Select the cube object
* In the properties editor, click the little [[Image:Bound-expression-unset.svg|16px]] '''expression''' icon at the right side of the '''Length''' field. This will open the [[Expressions|expressions editor]], where you can write '''Spreadsheet001.cubedims'''. Repeat this for '''Height''' and '''Width''':

[[File:FreeCAD SpreedSheet Dim.png]]

The reason we use "Spreadsheet001" instead of "Input" in the expression is that every object in a FreeCAD document has a unique internal name and a more user-friendly label. While the label is what appears in the tree view, the internal name is used to uniquely identify objects within the document. FreeCAD allows you to assign the same label to multiple objects if you adjust your preferences, but the internal name remains unique. For any operation that requires identifying an object without ambiguity, FreeCAD uses the internal name rather than the label, as the label could refer to more than one object. To find the internal name of an object, it's useful to keep the Selection Panel (accessible via View → Panels) open. This panel will always display the internal name of the selected object, ensuring you use the correct reference in your expressions.

[[File:FreeCAD SpreedSheet SelectionView.png]]

By using cell aliases in FreeCAD's Spreadsheet Workbench, it's possible to store "master values" within the document, making it easy to manage and modify key parameters. For instance, a spreadsheet can hold the dimensions of a model, allowing these values to be referenced throughout the design. This approach simplifies the process of updating the model; if new dimensions are required, you can simply open the spreadsheet, adjust the values, and the model will automatically update to reflect these changes. This method streamlines versioning and improves efficiency, especially in parametric modeling, where dimensions frequently change based on project requirements.

Finally, note that the constraints inside a sketch can also receive the value of a spreadsheet cell:

You can also give aliases to dimensional constraints (horizontal, vertical or distance)  in a sketch (you can then use that value from outside the sketch as well):

[[File:FreeCAD SpreedSheet Rectangle.png]]

'''Download'''

* The file produced in this exercise: https://github.com/yorikvanhavre/FreeCAD-manual/blob/master/files/spreadsheet.FCStd

'''Read more'''

* [[Spreadsheet_Workbench|The Spreadsheet Workbench]]
* [[Expressions|The Expressions engine]]


{{Docnav
|[[Manual:BIM_modeling|BIM modeling]]
|[[Manual:Creating_FEM_analyses|Creating FEM analyses]]
|[[Manual:Introduction|Manual start]]
|IconC=Crystal_Clear_manual.png
}}

[[Category:Tutorials{{#translation:}}]]