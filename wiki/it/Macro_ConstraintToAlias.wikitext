<languages/>

{{Macro/it
|Name=Macro ConstraintToAlias
|Icon=ConstraintToAlias.svg
|Description=Crea un alias nell'editor di Sketcher da un vincolo con nome selezionato.
|Author=TheMarkster
|Version=0.2023.12.10
|Date=2023-12.10
|FCVersion=0.21
|Download=[https://wiki.freecad.org/images/3/31/ConstraintToAlias.svg ToolBar Icon]
}}

<span id="Description"></span>
==Descrizione==

Spesso, durante la modifica di uno sketch, c'è la necessità di dover creare un alias e un valore per il foglio di calcolo a cui collegare un vincolo, ma non abbiamo ancora creato questo alias. In questo caso, si deve chiudere lo sketch, passare alla visualizzazione del foglio di calcolo, creare l'alias, tornare all'editor di sketch e collegare il vincolo all'alias.

Con questa macro si può semplicemente creare il vincolo, assegnargli un nome e un valore, quindi eseguirla. Viene visualizzata una finestra di dialogo in cui si può modificare l'etichetta per la Colonna A, il valore e l'alias per la Colonna B, quindi fare clic su OK per creare l'alias e collegare il vincolo tramite espressioni.

[[File:ConstraintToAlias_scr1.png|400px]]

<span id="Usage"></span>
==Utilizzo==

Crea un vincolo, assegnargli un nome, quindi selezionarlo ed eseguire la macro. Il nome del vincolo sarà quello predefinito per il nome dell'alias da creare nel foglio di calcolo e per l'etichetta nella Colonna A. La finestra di dialogo offre un'anteprima dell'aspetto del foglio di calcolo una volta creato l'alias. 

La macro utilizza solo le colonne A e B per gli alias che genera, iniziando dalla riga 2 e cercando fino a trovare 2 celle vuote in quelle colonne. Non è possibile selezionare una riga diversa del foglio di calcolo da utilizzare nella finestra di dialogo, ma è possibile modificare i campi etichetta, alias e valore prima di fare clic su OK per creare l'alias. Se non si seleziona alcun vincolo, la finestra di dialogo presenterà alcuni valori predefiniti per Etichetta, Alias ​​e Valore. Questa funzionalità è stata aggiunta nella versione 0.2023.11.07 per i casi in cui, al di fuori dello sketcher, potrebbe essere utile utilizzare la macro per aggiungere un nuovo alias al foglio di calcolo, ad esempio quando si inserisce la lunghezza di un blocco note.

Se nel documento attivo non è ancora presente alcun foglio di calcolo, la macro ne creerà uno denominato "ss". Se è presente un solo foglio di calcolo, verrà utilizzato quel foglio. Se sono presenti più fogli di calcolo, questi verranno aggiunti alla casella combinata Spreadsheets nella parte superiore della finestra di dialogo. Selezionare da questa casella combinata il foglio di calcolo a cui si desidera aggiungere l'alias.

Nella finestra di dialogo, l'alias per la cella nella colonna B è visualizzato tra parentesi graffe, ad esempio {{Value|{alias_for_this_cell} 32}}. Quando l'alias viene creato, non verrà visualizzato questo testo nel foglio di calcolo, ma solo {{Value|32}}, mentre l'alias per quella cella sarà {{Value|alias_for_this_cell}}.

Nello screenshot qui sopra, si noti che il campo Alias ​​è in rosso. Questo indica un errore: questo alias esiste già nel foglio di calcolo, quindi è necessario sceglierne un altro o annullare l'operazione se non ci si è accorti che esisteva già. Si noti inoltre che alcuni caratteri, come gli spazi, non sono consentiti per i nomi degli alias. Gli spazi vengono automaticamente convertiti in caratteri di sottolineatura. Anche altri caratteri speciali vengono gestiti in questo modo. Nell'anteprima del foglio di calcolo verrà visualizzato il nome dell'alias nella sua forma finale.

<div lang="en" dir="ltr" class="mw-content-ltr">
App::Links are supported, including links to spreadsheets in other documents.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
If the selected sketch constraint is already bound by an expression, then that expression is cleared and reset to now point to the newly created spreadsheet alias. The alias value is created by value, so you will need to edit the Value cell in the dialog to recreate the expression, for example {{Value|<nowiki>=</nowiki>width * height}} where width and height are aliases in the spreadsheet. You cannot link back to constraints in the sketch as that would create a cyclical redundancy.
</div>

<span id="Limitations"></span>
==Limitazioni==

<div lang="en" dir="ltr" class="mw-content-ltr">
* Only Columns A and B are supported
* Search for a new empty row begins at row 2, ignoring any existing contents in row 1
* Preview cells in the dialog are read-only and may not be edited within the dialog, except for the alias row to be created, which is edited via the Label, Alias, and Value fields.
</div>

<span id="Addon_Manager_code"></span>
==Codice Addon Manager==

{{Codeextralink|https://gist.github.com/mwganson/005765b49123d80cbb54569e081779a1/raw/556bf483802da8d756f869a4f894ba150d322305/ConstraintToAlias.FCMacro|ConstraintToAlias.FCMacro}}

<span id="Icon"></span>
==Icona==

<div lang="en" dir="ltr" class="mw-content-ltr">
ToolBar Icon [[Image:ConstraintToAlias.svg]]
</div>

==Script==

'''Macro ConstraintToAlias.FCMacro'''

{{CodeDownload|https://gist.github.com/mwganson/005765b49123d80cbb54569e081779a1|ConstraintToAlias.FCMacro}}