<languages/>

{{Macro/it
|Name=Macro Cut Object for Magnets
|Icon=Macro_Cut_Object_For_Magnets.png
|Description=Taglia un oggetto lungo un piano e aggiunge fori allineati per magneti con rilevamento delle collisioni superficiali. Crea due parti con fori perfettamente allineati per l'inserimento di magneti che consentono alle parti di agganciarsi.
|Author=Spkane
|Version=0.6.2
|Date=2026-01-18
|FCVersion=0.21+
|Download=[https://wiki.freecad.org/images/thumb/e/e3/Macro_Cut_Object_For_Magnets.png/48px-Macro_Cut_Object_For_Magnets.png ToolBar Icon]
|SeeAlso=[[Part_Slice/it|Affetta di Part]], [[PartDesign_Hole/it|Foro di PartDesign]]
}}

<span id="Description"></span>
==Descrizione==

Questa macro taglia un oggetto 3D lungo un piano specificato e aggiunge automaticamente dei fori magnetici allineati a entrambi i pezzi risultanti. I fori vengono posizionati con un sistema di rilevamento collisioni intelligente per garantire che non attraversino le pareti esterne dell'oggetto.

Questo è particolarmente utile per:
* Creare stampe multi-parte che si agganciano tra loro tramite magneti incorporati.
* Dividere oggetti di grandi dimensioni per piani di stampa 3D più piccoli mantenendo l'allineamento.
* Aggiungere meccanismi di chiusura magnetica a custodie e contenitori.

'''Caratteristiche principali:'''
* Taglio lungo dei piani preimpostati (XY, XZ, YZ) o per dei piani di riferimento del modello.
* Posizionamento automatico dei fori con distribuzione uniforme lungo il bordo di taglio.
* Il rilevamento delle collisioni superficiali impedisce ai fori di attraversare le pareti.
* Diametro, profondità e numero di fori configurabili.
* Impostazioni di gioco minimo e preferito per il bordo.
* Riposizionamento intelligente dei fori quando il posizionamento iniziale non supera i controlli di sicurezza.
* Crea oggetti PartDesign::Body con Fori parametrici.
* Supporta il ritaglio di oggetti già tagliati (mantenendo i fori esistenti).
* Separa automaticamente le due parti per una facile visualizzazione.

<span id="Usage"></span>
==Utilizzo==

# Aprire un documento con l'oggetto che si vuole tagliare.
# Selezionare facoltativamente l'oggetto e/o un piano di riferimento prima di eseguire la macro.
# Eseguire la macro da '''Macro → Macro → CutObjectForMagnets → Esegui'''.
# Nella finestra di dialogo:
#* Selezionare il corpo da tagliare dal menu a discesa.
#* Scegliere il tipo di piano di taglio (Predefinito o Piano Modello).
#* Per i piani preimpostati, impostare l'offset dall'origine.
#* Configurare i parametri del foro del magnete:
#** '''Diameter''': Diametro del foro (deve corrispondere alle dimensioni del magnete).
#** '''Depth''': Profondità del foro dalla superficie di taglio.
#** '''Number of Holes''': Numero totale di fori da creare.
#** '''Edge Clearance (Preferred)''': Distanza ideale tra il bordo del foro e la superficie dell'oggetto.
#** '''Edge Clearance (Minimum)''': Spazio minimo accettabile.
# Cliccare su "Execute Cut".

[[File:MacroCutObjectForMagnetsDialog.png|400px|center]]

<span id="Example"></span>
==Esempio==

Questa immagine mostra un vaso nella sua forma originale, dopo essere stato tagliato più volte con la tecnica macro. È quindi possibile inserire dei magneti nell'oggetto e riassemblarlo. Questo esempio serve a creare un vaso "fragile" per uno spettacolo teatrale, ma ci sono molti altri potenziali utilizzi.

[[File:CutObjectForMagnetsExample.png|400px|center]]

<span id="How_It_Works"></span>
==Come funziona==

'''Processo di taglio:'''
# Creare un grande riquadro semi-intermedio allineato al piano di taglio.
# Utilizzare operazioni booleane per dividere l'oggetto in due parti.
# Creare contenitori PartDesign::Body per ciascuna metà.

'''Algoritmo di posizionamento dei fori:'''
# Calcola le posizioni dei fori distribuite uniformemente lungo il perimetro della superficie di taglio.
# Per ogni posizione, convalida su ENTRAMBE le parti (non solo su una).
# Utilizza prima la distanza preferita, per poi tornare al valore minimo se necessario.
# Controlla la spaziatura tra i fori (minimo 2 volte il diametro).
# Riposiziona i fori che non superano i controlli di sicurezza utilizzando più strategie:
#* Riduzione della distanza nella stessa posizione.
#* Incremento dal bordo aumentato.
#* Posizioni alternative lungo il perimetro.

<div lang="en" dir="ltr" class="mw-content-ltr">
'''Safety Features:'''
* Creates test cylinders to check if holes would break through walls.
* Validates each hole against both the top and bottom parts.
* Skips holes that cannot be safely placed.
* Reports repositioned and skipped holes in the console.
</div>

<span id="Parameters"></span>
==Parametri==

<div lang="en" dir="ltr" class="mw-content-ltr">
{| class="wikitable"
! Parameter !! Description !! Default
|-
| Plane Type || "Preset Plane" (XY/XZ/YZ) or "Model Plane" (datum plane) || Preset Plane
|-
| Offset || Distance from origin for preset planes || 0 mm
|-
| Diameter || Magnet hole diameter || 3 mm
|-
| Depth || Hole depth from cut surface || 3 mm
|-
| Number of Holes || Total holes to create || 6
|-
| Edge Clearance (Preferred) || Ideal distance from hole edge to object surface || 2 mm
|-
| Edge Clearance (Minimum) || Minimum acceptable clearance (used during repositioning) || 0.5 mm
|}
</div>

<span id="Requirements"></span>
==Requisiti==

<div lang="en" dir="ltr" class="mw-content-ltr">
* FreeCAD 0.19 or later.
* An object with a solid shape (Part or PartDesign body).
* For model plane mode: a datum plane or object with planar faces.
</div>

<span id="Installation"></span>
==Installazione==

<div lang="en" dir="ltr" class="mw-content-ltr">
* Install via the '''FreeCAD Addon manager''' or manually from the [https://github.com/spkane/freecad-macro-cut-for-magnets/ freecad-macro-cut-for-magnets repo on GitHub].
</div>

<span id="Tips"></span>
==Suggerimenti==

<div lang="en" dir="ltr" class="mw-content-ltr">
* '''Magnet sizing''': Measure your magnets carefully. Common sizes are 3mm, 5mm, and 6mm diameter.
* '''Add tolerance''': Consider adding 0.1-0.2mm to the diameter for easier magnet insertion.
* '''Depth planning''': Set hole depth slightly deeper than magnet height to ensure flush or recessed fit.
* '''Edge clearance''': For thin-walled objects, reduce the preferred clearance but keep minimum clearance high enough to prevent wall breakthrough.
* '''Re-cutting''': The macro detects existing magnet holes and preserves them when cutting already-cut parts.
</div>

<span id="Source_Code"></span>
==Codice sorgente==

<div lang="en" dir="ltr" class="mw-content-ltr">
The full source code is hosted on GitHub:
* [https://github.com/spkane/freecad-macro-cut-for-magnets/ freecad-macro-cut-for-magnets on GitHub]
</div>

<span id="Links"></span>
==Link==

<div lang="en" dir="ltr" class="mw-content-ltr">
* [https://spkane.github.io/freecad-macro-cut-for-magnets/ Full Documentation] - Complete guides and tutorials.
* [https://github.com/spkane/freecad-macro-cut-for-magnets GitHub Repository] - Source code and issue tracker.
* [[Part_Slice|Part Slice]] - FreeCAD's built-in slice tool.
* [[PartDesign_Hole|PartDesign Hole]] - Parametric hole feature documentation.
* [[PartDesign_Body|PartDesign Body]] - Body container documentation.
</div>


[[Category:Addons{{#translation:}}]]