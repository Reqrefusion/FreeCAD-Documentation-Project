<languages/>

{{Docnav/pl
|[[BIM_Material/pl|Materiał]]
|[[Arch_Schedule/pl|Obmiar]]
|[[BIM_Workbench/pl|środowisko pracy BIM]]
|IconL=BIM_Material.svg
|IconR=Arch_Schedule.png
|IconC=Workbench_BIM.svg
}}

{{GuiCommand/pl
|Name=BIM: Raport
|MenuLocation=Zarządzaj → Narzędzia raportów → Raport BIM
|Workbenches=[[BIM_Workbench/pl|BIM]]
|Version=1.2
|SeeAlso=
}}

<span id="Description"></span>
==Opis==

'''Raport BIM''' to narzędzie do generowania zestawień i raportów danych z modelu FreeCAD. Wykorzystuje język zapytań podobny do SQL do wybierania, filtrowania i agregowania danych, oferując deklaratywną alternatywę dla innych narzędzi do tworzenia zestawień. Ostatecznie umożliwia użytkownikom tworzenie i automatyczne wypełnianie arkusza kalkulacyjnego w [[Spreadsheet_Workbench/pl|środowisku pracy Arkusz kalkulacyjny]] danymi zebranymi z modelu.

Możesz wybrać narzędzie Raport BIM, gdy potrzebujesz wykonać:
* '''Złożone filtrowanie:''' Wybieranie obiektów na podstawie kombinacji właściwości, w tym danych zagnieżdżonych (np. współrzędnych umiejscowienia obiektu).
* '''Agregacja danych:''' Obliczanie sum, liczności, wartości minimalnych lub maksymalnych dla wielu obiektów (np. znalezienie całkowitej powierzchni wszystkich obiektów typu „Space”).
* '''Zapytania hierarchiczne:''' Wybieranie obiektów na podstawie ich relacji z innymi obiektami (np. znalezienie wszystkich okien osadzonych w ścianach na określonej kondygnacji).

<span id="Usage"></span>
==Użycie==

# Otwórz lub utwórz dokument FreeCAD zawierający obiekty.
# Istnieje kilka sposobów uruchomienia narzędzia:
#* Naciśnij przycisk {{Button|[[Image:BIM_Report.svg|16px]] [[BIM_Report/pl|Raport BIM]]}}.
#* Wybierz z menu opcję {{MenuCommand|Zarządzaj → Narzędzia raportów → [[Image:BIM_Report.svg|16px]] Raport BIM}}.
# Nowy raport automatycznie otworzy swój panel zadań. Utwórz jedną lub więcej instrukcji dla raportu. Opcjonalnie możesz użyć dostępnego edytora instrukcji, aby zobaczyć podgląd wykonania tych instrukcji.
# Naciśnij {{Button|OK}}, aby zapisać raport i odświeżyć powiązany arkusz kalkulacyjny wynikami zapytania.

<span id="User_interface"></span>
===Interfejs użytkownika===

System '''Raport BIM''' składa się z trzech głównych elementów: obiektu '''Raport''' w widoku drzewa, docelowego '''Arkusza kalkulacyjnego''' na wyniki oraz '''Panelu zadań''', w którym konfiguruje się raport.

Po utworzeniu nowego raportu w '''Widoku drzewa''' pojawią się dwa nowe obiekty: obiekt Report, który przechowuje wszystkie ustawienia, oraz powiązany z nim arkusz kalkulacyjny ReportResult.

Dwukrotne kliknięcie obiektu {{PropertyData|Report}} otwiera '''Panel zadań''', który jest głównym obszarem roboczym do edycji raportu. Panel jest podzielony na dwa główne obszary: ''Instrukcje raportu'' oraz ''Edytor instrukcji''.

[[File:BIM_Report_Task_Panel_Overview.png|thumb|Panel zadań Raportu BIM pokazujący sekcję Przegląd instrukcji na górze.]]

<span id="Report_Statements"></span>
==== Instrukcje raportu ====

Ta sekcja jest zawsze widoczna w górnej części panelu zadań i zawiera podsumowanie wszystkich zapytań (lub "instrukcji") składających się na raport.

Główną funkcją jest '''tabela''' zawierająca listę wszystkich instrukcji. Z tego miejsca możesz przeglądać i bezpośrednio edytować '''Opis''' oraz przełączać kluczowe opcje dla każdego zapytania:
* '''Pipe:''' Włącza tryb potokowy dla danej instrukcji, wykorzystując wynik poprzedniej jako dane wejściowe.
* '''Header:''' Używa opisu instrukcji jako scalonego nagłówka sekcji w arkuszu kalkulacyjnym.
* '''Cols:''' Dołącza nazwy kolumn (np. {{Incode|Label}}, {{Incode|Area}}) jako wiersz nagłówkowy dla wyników tej instrukcji.

Dwukrotne kliknięcie wiersza instrukcji otwiera ją do edycji. Naciśnięcie {{KEY|F2}} na wierszu instrukcji umożliwia edycję opisu bezpośrednio w tabeli, bez otwierania pełnego edytora.

Pod tabelą znajdują się przyciski do {{Button|[[Image:List-add.svg|16px]] Dodania}}, {{Button|[[Image:List-remove.svg|16px]] Usunięcia}}, {{Button|[[Image:Edit-copy.svg|16px]] Zduplikowania}} lub {{Button|[[Image:Edit-edit.svg|16px]] Edycji}} wybranej instrukcji.

Na końcu rozwijane menu '''Szablony raportu''' umożliwia wczytanie kompletnych, wstępnie skonfigurowanych raportów, takich jak "Obmiar pomieszczenia i obszaru".

<span id="Statement_Editor"></span>
==== Edytor instrukcji ====

Ta sekcja pojawia się w dolnej części Panelu zadań po wybraniu instrukcji i kliknięciu {{Button|[[Image:Edit-edit.svg|16px]] Edytuj wybrane}}. W tym miejscu piszesz i konfigurujesz pojedyncze zapytanie SQL.

[[File:BIM_Report_Statement_Editor.png|thumb|Edytor instrukcji pokazujący edytor SQL, panel podglądu oraz opcje wyświetlania.]]

* '''Edytor zapytań SQL''' to pole tekstowe z podświetlaniem składni. Autouzupełnianie dla słów kluczowych SQL i nazw właściwości z modelu jest włączone automatycznie. Używaj klawiszy {{KEY|↑}} i {{KEY|↓}} w razie potrzeby, a {{KEY|Tab}} naciśnij, aby zastosować wybraną sugestię.
* Poniżej edytora znajduje się etykieta statusu '''Walidacja na żywo''', która zapewnia natychmiastową informację zwrotną, wskazując, czy składnia jest poprawna, oraz pokazując aktualną liczbę pasujących obiektów.
* Przyciskiem {{Button|[[Image:Std_ToggleVisibility.svg|16px]] Pokaż podgląd}} można uruchomić bieżące zapytanie na żądanie i wyświetlić pełne wyniki w tymczasowej tabeli, co pozwala testować zapytanie bez zamykania edytora.
* Przyciskiem {{Button|[[Image:Help-browser.svg|16px]] Help}} otwiera się okno ze "ściągawką" wszystkich obsługiwanych klauzul i funkcji SQL.
* Grupa '''Opcje wyświetlania''' zawiera pola wyboru do kontrolowania końcowego formatowania w arkuszu kalkulacyjnym:
** {{CheckBox|Użyj jako krok potoku}}: Po zaznaczeniu, ta instrukcja będzie używać wyników poprzedniej instrukcji jako źródła danych zamiast przeszukiwać cały dokument. Jest to kluczowa opcja dla włączenia przepływów potokowych.
** {{CheckBox|Użyj opisu jako nagłówka sekcji}}: Po zaznaczeniu opis instrukcji (np. "Lista pokoju") zostanie zapisany jako scalony, wyśrodkowany wiersz nagłówkowy w arkuszu kalkulacyjnym przed wynikami danych.
** {{CheckBox|PRAWDA|Uwzględniaj nazwy kolumn}}: Opcja włączona domyślnie, dołącza nagłówki kolumn (np. {{Incode|Label}}, {{Incode|Area}}) do wyników arkusza dla tej instrukcji.
** {{CheckBox|Dodaj pusty rząd po}}: Po zaznaczeniu, po wynikach tej instrukcji zostanie wstawiony pusty wiersz, zapewniając wizualne oddzielenie w raporcie wielosekcyjnym.
** {{CheckBox|Wydrukuj wyniki w pogrubieniu}}: Renderuje komórki danych dla wyników tej instrukcji pogrubioną czcionką w celu wyróżnienia.
* Rozwijane menu '''Gotowe zapytania''' umożliwia wczytywanie i zapisywanie pojedynczych, często używanych zapytań SQL.

Przycisk {{Button|[[Image:Document-save.svg|16px]] Zapisz}} zapisuje zmiany w wybranej instrukcji. Gdy zaznaczone jest pole {{CheckBox|Zapisz i następne}} i naciśnięty zostanie przycisk {{Button|[[Image:Document-save.svg|16px]] Zapisz}}, oprócz zapisania zmian zostanie utworzona nowa instrukcja, co ułatwia kontynuację edycji. Przycisk {{Button|❌ Odrzuć}} zamyka edytor instrukcji bez zapisywania wprowadzonych zmian.

<span id="Workflow"></span>
==Przepływ pracy==

Ten krótki samouczek poprowadzi Cię przez proces tworzenia kompletnego obmiaru pokoju, od prostej listy po wieloczęściowy raport z obliczonymi sumami.

<span id="Step_1:_New_report"></span>
=== Krok 1: Nowy raport ===

# Kliknij przycisk {{Button|[[Image:BIM_Report.svg|16px]] [[BIM_Report/pl|Raport BIM]]}} na pasku narzędzi środowiska roboczego BIM.
# FreeCAD utworzy '''obiekt Report''' i '''arkusz kalkulacyjny ReportResult''' w Widoku drzewa i automatycznie otworzy Panel zadań.

<span id="Step_2:_Simple_statement"></span>
=== Krok 2: Prosta instrukcja ===

Najpierw utwórzmy prostą listę wszystkich przestrzeni i ich powierzchni.
# W '''Instrukcjach raportu''' kliknij przycisk {{Button|[[Image:List-add.svg|16px]] Dodaj instrukcję}}. W liście pojawi się nowa, pusta instrukcja.
# Z nową instrukcją wybraną, kliknij przycisk {{Button|[[Image:Edit-edit.svg|16px]] Edytuj wybrane}}. '''Edytor instrukcji''' pojawi się w dolnej części Panelu zadań.
# W polu '''Opis''' wpisz {{Incode|Room List}}.
# W edytorze '''Zapytanie SQL''' wpisz następujące zapytanie. Wybiera ono nazwę i powierzchnię wszystkich obiektów typu {{Incode|Space}} i sortuje je alfabetycznie.{{Code|lang=sql|code=
SELECT Label, Area FROM document WHERE IfcType = 'Space' ORDER BY Label ASC
}}
# Kliknij przycisk {{Button|[[Image:Document-save.svg|16px]] Zapisz}} w edytorze, aby zatwierdzić zmiany w instrukcji.

<span id="Step_3:_Multi-section_report"></span>
=== Krok 3: Raport o wielu sekcjach ===

Teraz dodajmy drugą instrukcję do obliczenia całkowitej powierzchni.
# W widoku ogólnym ponownie kliknij {{Button|[[Image:List-add.svg|16px]] Dodaj instrukcję}}, aby utworzyć drugą instrukcję.
# Z nową instrukcją wybraną, kliknij {{Button|[[Image:Edit-edit.svg|16px]] Edytuj wybrane}}.
# Ustaw '''Description''' na {{Incode|Total Area}}.
# W edytorze '''Zapytanie SQL''' wpisz następujące zapytanie agregujące:{{Code|lang=sql|code=
SELECT 'Total Usable Area', SUM(Area) FROM document WHERE IfcType = 'Space'
}}
# W sekcji '''Opcje wyświetlania''' odznacz '''Uwzględniaj nazwy kolumn''' (ponieważ nasza pierwsza kolumna to własna etykieta) i zaznacz '''Drukuj wyniki w pogrubieniu'' dla wyróżnienia.
# Kliknij {{Button|[[Image:Document-save.svg|16px]] Zapisz}}. Teraz masz raport składający się z dwóch instrukcji. Kliknij główny przycisk {{Button|OK}} na dole Panelu zadań, aby go wykonać. Powiązany arkusz kalkulacyjny otworzy się automatycznie z sformatowanymi wynikami.

<span id="Step_4:_Pipelining_for_advanced_queries"></span>
=== Krok 4: Potoki dla zaawansowanych zapytań ===

Potokowanie pozwala łączyć zapytania w łańcuch, gdzie wynik jednego staje się danymi wejściowymi dla następnego. Jest to niezbędne przy złożonych selekcjach hierarchicznych, np. podczas użycia funkcji {{Incode|CHILDREN()}}. Ponieważ funkcja nie działa rekurencyjnie, znajduje tylko bezpośrednich potomków.

Na przykład, aby znaleźć wszystkie drzwi znajdujące się na "Parterze", trzeba wykonać zapytanie wieloetapowe, ponieważ drzwi są dziećmi ścian, które z kolei są dziećmi kondygnacji.

# Utwórz nowy raport.
# '''Instrukcja 1: Znajdź obiekt 'Parter' '''
#* Dodaj instrukcję z opisem {{Incode|Znajdź parter}}.
#* To zapytanie wybiera punkt początkowy naszego wyszukiwania.{{Code|lang=sql|code=
SELECT * FROM document WHERE Label = 'Ground Floor'
}}
# '''Instrukcja 2: Znajdź ściany na tej kondygnacji'''
#* Dodaj drugą instrukcję z opisem {{Incode|Znajdź ściany na kondygnacji}}.
#* W edytorze zaznacz pole {{CheckBox|Użyj kroku potoku}}. Informuje to instrukcję, że ma działać na wynikach poprzedniej instrukcji (obiekt kondygnacji).
#* Użyj tego zapytania, aby znaleźć wszystkich bezpośrednich potomków kondygnacji i pozostawić tylko ściany:{{Code|lang=sql|code=
SELECT * FROM CHILDREN(SELECT * FROM document) WHERE IfcType = 'Wall'
}}
# '''Instrukcja 3: Znajdź drzwi w tych ścianach'''
#* Dodaj trzecią instrukcję z opisem {{Incode|Znajdź drzwi w ścianach}}.
#* Ponownie zaznacz pole {{CheckBox|Użyj kroku potoku}}. Teraz łączy ją z wynikiem Instrukcji 2 (lista ścian).
#* Użyj tego zapytania, aby znaleźć obiekty podrzędne ścian i pozostawić tylko drzwi:{{Code|lang=sql|code=
SELECT Label, Width, Height FROM CHILDREN(SELECT * FROM document) WHERE IfcType = 'Door'
}}
# Kliknij {{Button|OK}}. Raport wykona pełny trzyetapowy potok.

'''Zrozumienie wyniku:''' Końcowy arkusz kalkulacyjny pokaże tylko wyniki ostatniej instrukcji w potoku (listę drzwi). Pierwsze dwie instrukcje pełnią rolę filtrów pośrednich – ich wyniki są przekazywane w pamięci, ale nie są drukowane w arkuszu, co daje czysty i precyzyjny końcowy raport.

<span id="Step_5:_Presets_and_templates"></span>
=== Krok 5: Gotowe ustawienia i szablony ===

* '''Szablony raportów''' wczytują kompletny, wieloinstrukcyjny raport. W '''Instrukcjach raportu''' wybierz szablon, np. "Obmiar pokoju i obszaru", z rozwijanego menu, aby natychmiast wczytać konfigurację z Kroków 2 i 3. Możesz zapisać własne raporty jako nowe szablony do ponownego użycia.
* '''Gotowe zapytania''' wczytują pojedyncze zapytanie do edytora. W '''Edytorze zapytań''' wybierz preset, np. "Wszystkie ściany", z rozwijanego menu, aby wypełnić edytor SQL. Własne często używane zapytania możesz zapisać, klikając przycisk {{Button|Zapisz…}}.

<span id="BIM_SQL_dialect_reference"></span>
== Odniesienie dla dialektu BIM SQL ==

W tej sekcji przedstawiono szczegółowe informacje dotyczące dialektu języka SQL używanego przez narzędzie Raport BIM.

'''Uwaga''': Najbardziej aktualne informacje dotyczące wszystkich klauzul i funkcji można zawsze znaleźć w interfejsie użytkownika, klikając przycisk {{Button|[[Image:Help-browser.svg|16px]] Pomoc}} w edytorze Panelu zadań raportu.

<span id="Clauses"></span>
=== Klauzule ===

* {{Incode|SELECT}}: Określa kolumny danych do zwrócenia. Można użyć {{Incode|*}}, aby wybrać domyślny identyfikator wszystkich obiektów.
* {{Incode|FROM}}: Określa źródło danych. W pojedynczym zapytaniu zawsze jest to {{Incode|document}}. W potoku {{Incode|document}} jest symbolem zastępczym dla danych z poprzedniego kroku. Można też użyć funkcji {{Incode|CHILDREN()}}.
* {{Incode|WHERE}}: Filtruje obiekty na podstawie warunków.
* {{Incode|GROUP BY}}: Grupuje wiersze o tych samych wartościach w wiersze podsumowujące, zwykle używane z funkcjami agregującymi.
* {{Incode|ORDER BY}}: Sortuje końcowe wyniki. Może być użyte wraz z {{Incode|ASC}} (rosnąco, domyślnie) lub {{Incode|DESC}} (malejąco). Obsługuje sortowanie według wielu kolumn.
* {{Incode|AS}}: Tworzy alias (własną nazwę) dla kolumny w klauzuli {{Incode|SELECT}}, np. {{Incode|SELECT Area AS "My Area"}}.

<span id="Usage_notes_for_GROUP_BY_and_ORDER_BY"></span>
==== Notatki użycia GROUP BY oraz ORDER BY ====

Dialekt posiada określone zasady dotyczące używania wyrażeń (np. funkcji lub działań arytmetycznych) w klauzulach {{Incode|GROUP BY}} i {{Incode|ORDER BY}}.

* '''Dla {{Incode|GROUP BY}}:''' Przy grupowaniu według wyrażenia należy powtórzyć całe wyrażenie w klauzuli {{Incode|GROUP BY}}. Nie jest obsługiwane użycie aliasu z listy {{Incode|SELECT}}.
** ✅ '''Poprawnie:''' {{Code|lang=sql|code=SELECT TYPE(*) … GROUP BY TYPE(*)}}
** ❌ '''Niepoprawnie:''' {{Code|lang=sql|code=SELECT TYPE(*) AS BimType … GROUP BY BimType}}

* '''Dla {{Incode|ORDER BY}}:''' Natomiast sortowanie według surowego wyrażenia nie jest obsługiwane. Aby posortować według wyniku wyrażenia, '''najpierw''' należy uwzględnić je w liście {{Incode|SELECT}} z aliasem {{Incode|AS}}, a następnie odwołać się do tego aliasu w klauzuli {{Incode|ORDER BY}}.
** ✅ '''Poprawnie:''' {{Code|lang=sql|code=SELECT Label, LOWER(Label) AS sort_key … ORDER BY sort_key}}
** ❌ '''Niepoprawnie:''' {{Code|lang=sql|code=SELECT Label … ORDER BY LOWER(Label)}}

<span id="Functions"></span>
=== Funkcje ===

Dialekt zawiera bibliotekę wbudowanych funkcji do manipulacji danymi i analizy.
{| class="wikitable"
! Kategoria
! Funkcja
! Opis
|-
| '''Agreguj'''
| {{Incode|COUNT(właściwość<nowiki>|</nowiki>*)}}
| Zlicza wystąpienia obiektu. {{Incode|COUNT(*)}} zlicza wszystkie rzędy; {{Incode|COUNT(właściwość)}} zlicza rzędy, w których określona właściwość nie jest {{Incode|NULL}}.
|-
|
| {{Incode|SUM(właściwość)}}
| Oblicza sumę właściwości numerycznej.
|-
|
| {{Incode|MIN(właściwość)}}
| Znajduje minimalną wartość właściwości numerycznej.
|-
|
| {{Incode|MAX(właściwość)}}
| FZnajduje maksymalną wartość właściwości numerycznej.
|-
| '''Hierarchiczne'''
| {{Incode|PARENT(*)}}
| Zwraca architektonicznie istotny element nadrzędny obiektu (np. ścianę, w której znajduje się okno), pomijając w sposób przejrzysty grupy ogólne.
|-
|
| {{Incode|CHILDREN(zapytanie podrzędne)}}
| Funkcja używana w klauzuli {{Incode|FROM}}. Zwraca wszystkie dzieci obiektów znalezionych przez podzapytanie, uwzględniając zarówno relacje zawierania ({{Incode|.Group}}), jak i hostingu ({{Incode|.Hosts}}). Funkcja jest '''nierekurencyjna'''. Aby znaleźć wnuki lub dalszych potomków, należy połączyć kilka kroków {{Incode|CHILDREN()}} w potoku.
|-
|
| {{Incode|CHILDREN_RECURSIVE(zapytanie podrzędne, max_depth{{:=}}15)}}
| Funkcja używana w klauzuli {{Incode|FROM}}. Zwraca wszystkie potomne obiekty wyników {{Incode|subquery}}, rekurencyjnie przeszukując hierarchię. Pomija grupy ogólne. Opcjonalnie można określić {{Incode|max_depth}} (domyślnie 15, {{Incode|0}} dla nieograniczonej głębokości). Zastępuje potrzebę tworzenia złożonych potoków do znajdowania zagnieżdżonych obiektów.
|-
| '''Utility'''
| {{Incode|TYPE(*)}}
| Zwraca typ obiektu widoczny dla użytkownika, określony przez jego proxy (np. {{Incode|Wall}}, {{Incode|Space}}, {{Incode|Part::Box}}).
|-
|
| {{Incode|CONVERT(wielkość, 'jednostka')}}
| Konwertuje obiekt Quantity FreeCAD na nową jednostkę i zwraca ją jako surową liczbę. Przykład:
 {{Incode|CONVERT(Area, 'm^2')}}.
|-
| '''String'''
| {{Incode|LOWER(właściwość)}}
| Konwertuje właściwość tekstową na małe litery.
|-
|
| {{Incode|UPPER(właściwość)}}
| Konwertuje właściwość tekstową na wielkie litery.
|-
|
| {{Incode|CONCAT(val1, val2, …)}}
| Łączy wiele wartości tekstowych i właściwości w jeden ciąg znaków.
|}

<span id="Property_access"></span>
=== Dostęp do właściwości ===

Możesz uzyskać dostęp do dowolnej właściwości obiektu, w tym do zagnieżdżonych struktur danych.

* '''Dostęp bezpośredni:''' Uzyskanie dostępu do prostej właściwości bezpośrednio po jej nazwie.
** Przykład: {{Incode|Label}}, {{Incode|IfcType}}
* '''Dostęp zagnieżdżony:''' Użycie notacji kropkowej do dostępu do podwłaściwości.
** Przykład: {{Incode|Shape.Volume}}, {{Incode|Placement.Base.z}}
* '''Dostęp łańcuchowy:''' Łączenie dostępu do właściwości z wynikiem funkcji, najczęściej {{Incode|PARENT()}}.
** Przykład: {{Incode|PARENT(*).Label}}, {{Incode|PARENT(*).PARENT(*).Height}}

<span id="Operators"></span>
=== Operatory ===

{| class="wikitable"
! Typ
! Operatory
! Opis
|-
| '''Porównanie'''
| {{Incode|{{:=}}}}, {{Incode|!{{:=}}}}, {{Incode|>}}, {{Incode|<}}, {{Incode|>{{:=}}}}, {{Incode|<{{:=}}}}
| Standardowe operatory porównania.
|-
|
| {{Incode|LIKE}}
| Dopasowywanie wzorców bez rozróżniania wielkości liter. Użyj {{Incode|%}} dla wielu znaków i {{Incode|_}} dla pojedynczego znaku.
|-
|
| {{Incode|IS NULL}}, {{Incode|IS NOT NULL}}
| Sprawdza, czy właściwość ma wartość.
|-
|
| {{Incode|IN (value1, value2, …)}}
| Sprawdza, czy wartość właściwości znajduje się na podanej liście literałów.
|-
| '''Logiczne'''
| {{Incode|AND}}, {{Incode|OR}}
| Używane w klauzuli {{Incode|WHERE}} do łączenia wielu warunków.
|-
| '''Arytmetyczne'''
| {{Incode|+}}, {{Incode|-}}, {{Incode|*}}, {{Incode|/}}
| Wykonuj obliczenia dotyczące właściwości numerycznych. Przestrzegaj standardowej kolejności operatorów; użyj {{Incode|()}}, aby ją zmienić.
|}

<span id="General_syntax"></span>
=== Ogólna składnia ===

* '''Literały i cudzysłowy''': Do oznaczania literałów tekstowych (stringów) można używać zarówno pojedynczych ({{Incode|'}}), jak i podwójnych ({{Incode|"}}) cudzysłowów. Na przykład, {{Incode|WHERE Label {{:=}} 'Wall'}} i {{Incode|WHERE Label {{:=}} "Wall"}} są równoważne.
* '''Komentarze''': Parser ignoruje zarówno komentarze jednolinijkowe, które zaczynają się od {{Incode|--}}, jak i komentarze wielolinijkowe, otoczone {{Incode|/* … */}}.
* '''Internacjonalizacja''': Parser poprawnie obsługuje znaki nie-ASCII (Unicode) w nazwach właściwości (np. Fläche).

<span id="Sample_queries"></span>
==  Przykładowe zapytania ==

W tej sekcji znajduje się zbiór praktycznych zapytań, które można wykorzystać bezpośrednio lub zmodyfikować do własnych raportów.

<span id="Basic_selections"></span>
=== Podstawowe zaznaczanie ===

'''Zaznacz wszystkie elementy konstrukcyjne (kolumny i belki):'''

{{Code|lang=sql|code=
SELECT Label, IfcType 
FROM document 
WHERE IfcType IN ('Column', 'Beam') 
ORDER BY IfcType, Label
}}

'''Wybierz wszystkie ściany z "Exterior" w nazwie:'''

{{Code|lang=sql|code=
SELECT Label, Length, Height 
FROM document 
WHERE IfcType = 'Wall' AND Label LIKE '%Exterior%'
}}

<span id="Data_aggregation_&amp;_summaries"></span>
=== Agregacja danych i podsumowania ===

'''Zlicz wszystkie obiekty BIM, pogrupowane po typie:'''

{{Code|lang=sql|code=
SELECT IfcType, COUNT(*) 
FROM document 
WHERE IfcType IS NOT NULL 
GROUP BY IfcType 
ORDER BY IfcType ASC
}}

'''Uzyskaj pełny zestawienie ilościowe dla wszystkich ścian:'''

To zapytanie oblicza całkowitą liczbę ścian, ich łączną długość oraz minimalną i maksymalną wysokość ścian.

{{Code|lang=sql|code=
SELECT 
    COUNT(*) AS "Total Count", 
    SUM(Length) AS "Total Length (mm)", 
    MIN(Height) AS "Min Height (mm)", 
    MAX(Height) AS "Max Height (mm)" 
FROM document 
WHERE IfcType = 'Wall'
}}

<span id="Hierarchical_queries"></span>
=== Zapytania hierarchiczne ===

'''Wypisz wszystkie obiekty zlokalizowane bezpośrednia na "Parterze":'''

Wykorzystuje funkcję {{Incode|CHILDREN()}} do sprawdzania zawartości określonego obiektu kontenera.

{{Code|lang=sql|code=
SELECT Label, IfcType 
FROM CHILDREN(SELECT * FROM document WHERE Label = 'Ground Floor') 
ORDER BY IfcType
}}

'''Wymień wszystkie drzwi i ściany, w których się znajdują:'''

Wykorzystuje to funkcję {{Incode|PARENT()}} do znalezienia hosta każdego portu.

{{Code|lang=sql|code=
SELECT 
    Label AS "Door_Name", 
    PARENT(*).Label AS "Host_Wall_Name" 
FROM document 
WHERE IfcType = 'Door' 
ORDER BY "Host_Wall_Name"
}}

'''Znajdź wszystkie okna na "Parterze" (sprawdzając element nadrzędny):'''

To zapytanie wyszukuje okna, sprawdza ich element nadrzędny (ścianę), a następnie sprawdza element nadrzędny tej ściany (podłogę).

{{Code|lang=sql|code=
SELECT Label 
FROM document 
WHERE IfcType = 'Window' AND PARENT(*).PARENT(*).Label = 'Ground Floor'
}}

<span id="Advanced_queries"></span>
=== Zaawansowane zapytania ===

'''Wygeneruj kompletny obmiar pomieszczeń i obszarów:'''

To zapytanie generuje sformatowaną listę wszystkich pomieszczeń, pogrupowanych według pięter, do których należą, wraz z ich powierzchnią przeliczoną na metry kwadratowe.

{{Code|lang=sql|code=
SELECT 
    PARENT(*).Label AS "Floor", 
    Label AS "Room Name", 
    CONVERT(Area, 'm^2') AS "Area (m²)" 
FROM document 
WHERE IfcType = 'Space' 
ORDER BY "Floor", "Room Name"
}}

<span id="Usage_notes"></span>
==Uwagi dotyczące użycia==

<span id="Units"></span>
=== Jednostki ===

Po wybraniu właściwości, która ma jednostki (`Ilość`), takie jak `Długość` lub `Powierzchnia`, silnik BIM Report zwraca surową wartość liczbową tej właściwości, tak jak jest ona przechowywana wewnętrznie w dokumencie FreeCAD. Wewnętrzne jednostki FreeCAD są zawsze oparte na milimetrach ({{Incode|mm}}).

Oznacza to, że domyślnym wynikiem będzie {{Incode|mm}} dla długości, {{Incode|mm²}} dla powierzchni i {{Incode|mm³}} dla objętości, niezależnie od aktualnego schematu jednostek lub preferencji użytkownika. Automatycznie wygenerowany nagłówek kolumny będzie prawidłowo odzwierciedlał tę wewnętrzną jednostkę.

'''Przykład: domyślne zachowanie'''

Jeśli uruchomisz to proste zapytanie na obszarze o wymiarach 1 metr na 1 metr:

{{Code|lang=sql|code=
SELECT Label, Area FROM document WHERE IfcType = 'Space'
}}

Wynikowy arkusz kalkulacyjny będzie zawierał:
* '''Nagłówek:''' {{Incode|Powierzchnia (mm²)}}
* '''Wartość:''' {{Incode|1000000,0}}

<span id="Using_{{Incode|CONVERT()}}"></span>
==== Użycie {{Incode|CONVERT()}} ====

Aby uzyskać wyniki w żądanych jednostkach, można użyć funkcji {{Incode|CONVERT()}}, która zapewnia wyraźną kontrolę nad wynikami. Aby uzyskać powierzchnię w metrach kwadratowych, zmodyfikuj zapytanie w następujący sposób:

{{Code|lang=sql|code=
SELECT Label, CONVERT(Area, 'm^2') AS "Area (m²)" FROM document WHERE IfcType = 'Space'
}}

To zapytanie generuje teraz wynik w żądanej jednostce:
* '''Nagłówek:''' {{Incode|Powierzchnia (m²)}}
* '''Wartość:''' {{Incode|1,0}}

Użycie funkcji {{Incode|CONVERT()}} gwarantuje, że wynik raportu będzie jednoznaczny, a wszelkie obliczenia wykonywane w zapytaniu (np. {{Incode|SUM(CONVERT(Area, 'm^2'))}}) będą poprawne matematycznie.

<span id="Properties"></span>
==Właściwości==

Obiekt Arch Report udostępnia użytkownikowi następujące właściwości.

<span id="Data"></span>
===Dane===

{{TitleProperty|Raport}}

* {{PropertyData|AutoUpdate}}: Ta właściwość, domyślnie ustawiona na True, kontroluje, czy raport automatycznie uruchamia się za każdym razem, gdy dokument jest przeliczany. Po włączeniu arkusz raportu zawsze pozostaje zsynchronizowany z modelem. Na przykład, jeśli zmieni się długość ściany, wartość {{Incode|SUM(Length)}} w raporcie zostanie automatycznie zaktualizowana po przeliczeniu. W bardzo dużych modelach może być wskazane wyłączenie tej opcji dla poprawy wydajności przy wprowadzaniu wielu zmian. Gdy właściwość AutoUpdate jest ustawiona na Fałsz, raport można zaktualizować ręcznie w dowolnym momencie, klikając prawym przyciskiem myszy obiekt Report w Widoku drzewa i wybierając Recompute lub naciskając globalny przycisk Przelicz ponownie.
* {{PropertyData|Target}}: Przechowuje odnośnik do obiektu Arkusza kalkulacyjnego, w którym zapisywane będą wyniki raportu. Podczas tworzenia nowego raportu automatycznie tworzony jest nowy arkusz kalkulacyjny i powiązany tutaj. W razie potrzeby można zmienić tę właściwość, aby kierować wyniki do innego istniejącego arkusza w bieżącym dokumencie.

<span id="Scripting"></span>
==Tworzenie skryptów==

<div lang="en" dir="ltr" class="mw-content-ltr">
The BIM Report engine is fully accessible through Python, allowing you to integrate its advanced query capabilities into your own scripts and automations.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
=== Arch.selectObjects(query_string) ===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
This is the primary function for executing a single, straightforward SQL query. It takes a query string as input and returns a list of the FreeCAD DocumentObjects that match the query. If the query is invalid or finds no objects, it returns an empty list and prints an error to the console.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''Example: Get all Wall objects with "Exterior" in their name'''
</div>

{{Code|code=
import FreeCAD
import Arch

# This query selects all Wall objects whose Label contains the substring "Exterior"
query = "SELECT * FROM document WHERE IfcType = 'Wall' AND Label LIKE '%Exterior%'"

exterior_walls = Arch.selectObjects(query)

# The result is a list of FreeCAD objects
FreeCAD.Console.PrintMessage(f"Found {len(exterior_walls)} exterior walls.\n")
for wall in exterior_walls:
    FreeCAD.Console.PrintMessage(f"- {wall.Label} (Length: {wall.Length})\n")
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
=== Arch.selectObjectsFromPipeline(statements) ===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
For more complex, multi-step selections, you can use this function to execute a pipeline. It takes a list of {{Incode|ArchSql.ReportStatement}} objects and returns the final list of FreeCAD DocumentObjects that result from the full pipeline.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
This is the programmatic equivalent of using the '''"Use as Pipeline Step"''' checkbox in the UI.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''Example: Find all doors on the "Ground Floor"'''
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
This is a classic hierarchical problem that requires multiple steps. The goal is to find the "grandchildren" (doors) of a "grandparent" (the floor). Since the {{Incode|CHILDREN()}} function is not recursive, we must chain multiple steps in a pipeline.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# First, we find the {{Incode|'Ground Floor'}} object.
# Second, we find its direct children (the walls, spaces, etc.).
# Third, we find the children of ''those'' objects (which will include the doors and windows hosted by the walls).
# Finally, we filter that last group to keep only the doors.
</div>

{{Code|code=
import FreeCAD
import Arch
import ArchSql

# Step 1: Define the pipeline statements.
# The ReportStatement class must be imported from the ArchSql module.

# Statement 1: Find the parent 'Ground Floor' object.
# Output of this step: [Ground_Floor_Object]
stmt1 = ArchSql.ReportStatement(
    query_string="SELECT * FROM document WHERE Label = 'Ground Floor'"
)

# Statement 2: Find the direct children of the floor (walls, spaces, etc.).
# is_pipelined=True tells this to run on the output of stmt1.
# Output of this step: [Wall_Object_1, Wall_Object_2, Space_Object_1, …]
stmt2 = ArchSql.ReportStatement(
    query_string="SELECT * FROM CHILDREN(SELECT * FROM document)",
    is_pipelined=True
)

# Statement 3: Find the children of the objects from the previous step.
# This finds the doors and windows hosted by the walls.
# Output of this step: [Door_Object, Window_Object_1, …]
stmt3 = ArchSql.ReportStatement(
    query_string="SELECT * FROM CHILDREN(SELECT * FROM document)",
    is_pipelined=True
)

# Statement 4: Filter the final list to keep only the doors.
# This runs on the output of stmt3.
# Final Output: [Door_Object]
stmt4 = ArchSql.ReportStatement(
    query_string="SELECT * FROM document WHERE IfcType = 'Door'",
    is_pipelined=True
)

# Step 2: Execute the full pipeline.
pipeline_statements = [stmt1, stmt2, stmt3, stmt4]
doors_on_floor = Arch.selectObjectsFromPipeline(pipeline_statements)

# The result is the final list of door objects.
FreeCAD.Console.PrintMessage(f"Found {len(doors_on_floor)} doors on the ground floor.\n")
for door in doors_on_floor:
    FreeCAD.Console.PrintMessage(f"- {door.Label}\n")
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
=== Inspecting and sharing a report via the Python Console ===
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
For debugging, scripting, or sharing your work with others, you can get a complete, human-readable summary of a Report's configuration directly from the Python Console.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
The custom logic and detailed content of a BIM Report are stored in its '''proxy object'''. Accessing the {{Incode|.Proxy}} attribute provides a full printout of all statements and their SQL queries. This is a convenient way to copy your entire report definition to the clipboard to share in a forum or a bug report.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
'''How to use it:'''
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Select your Report object in the Tree View.
# Press {{KEY|Ctrl}}+{{KEY|Shift}}+{{KEY|P}}. This will send the selected object to the Python Console as the variable {{Incode|obj}}.
# In the console, type the following and press Enter:
</div>

{{Code|code=
print(obj.Proxy)
}}

<div lang="en" dir="ltr" class="mw-content-ltr">
'''Example Output:'''
</div>

{{Code|code=
>>> print(obj.Proxy)
BIM Report: 'My Door Schedule' (2 statements)

--- Statement [1]: Find All Walls on Ground Floor ---
    SELECT * 
    FROM CHILDREN(SELECT * FROM document WHERE Label = 'Ground Floor')
    WHERE IfcType = 'Wall'

--- Statement [2]: Final Door Schedule (Pipelined, Header) ---
    SELECT
        Tag,
        COUNT(*) AS "Count"
    FROM
        document
    GROUP BY
        Tag
}}


{{Docnav/pl
|[[BIM_Material/pl|Materiał]]
|[[Arch_Schedule/pl|Obmiar]]
|[[BIM_Workbench/pl|środowisko pracy BIM]]
|IconL=BIM_Material.svg
|IconR=Arch_Schedule.png
|IconC=Workbench_BIM.svg
}}

{{BIM_Tools_navi{{#translation:}}}}
{{Userdocnavi{{#translation:}}}}